(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const N="winnieos.";function b(){try{if(typeof window>"u"||!window.localStorage)return!1;const e="__storage_test__";return window.localStorage.setItem(e,"test"),window.localStorage.removeItem(e),!0}catch{return!1}}function M(e){if(!e||typeof e!="string")throw new Error("Storage key must be a non-empty string");return e.startsWith(N)?e:N+e}const L={get:function(e,t=null){if(!b())return t;try{const n=M(e),o=window.localStorage.getItem(n);if(o===null)return t;try{return JSON.parse(o)}catch{return o}}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return t}},set:function(e,t){if(!b())return!1;try{const n=M(e),o=JSON.stringify(t);return window.localStorage.setItem(n,o),!0}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return!1}},remove:function(e){if(!b())return!1;try{const t=M(e);return window.localStorage.removeItem(t),!0}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},has:function(e){if(!b())return!1;try{const t=M(e);return window.localStorage.getItem(t)!==null}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},clear:function(){if(!b())return!1;try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(N)&&e.push(n)}return e.forEach(t=>window.localStorage.removeItem(t)),!0}catch{return!1}},keys:function(){if(!b())return[];try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(N)&&e.push(n.substring(N.length))}return e}catch{return[]}}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Storage=L);const ee="display.reference",ue={width:1280,height:800};let u=null;function ne(e){if(e==null)return null;const t=String(e).trim();if(!t)return null;const n=t.match(/^([0-9.]+)px$/i);if(!n)return null;const o=Number(n[1]);return Number.isFinite(o)?o:null}function D(e,t,n){const o=Math.round(Number(e));return Number.isFinite(o)?Math.min(n,Math.max(t,o)):null}function de(e){return!!e&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>=320&&e.height>=240&&e.width<=7680&&e.height<=4320}function pe(){const e=document.documentElement,t=window.getComputedStyle(e),n=ne(t.getPropertyValue("--ref-width")),o=ne(t.getPropertyValue("--ref-height"));return Number.isFinite(n)&&Number.isFinite(o)&&n>0&&o>0?{width:Math.round(n),height:Math.round(o)}:null}function _e(){const e=L.get(ee);if(!e||typeof e!="object")return null;const t=D(e.width,320,7680),n=D(e.height,240,4320),o={width:t,height:n};return de(o)?o:null}function be(e){L.set(ee,e)}function Oe(){L.remove(ee)}function U(e){const t=document.documentElement;t.style.setProperty("--ref-width",e.width+"px"),t.style.setProperty("--ref-height",e.height+"px"),t.style.setProperty("--ref-aspect-ratio",String(e.width/e.height)),t.dataset.refWidth=String(e.width),t.dataset.refHeight=String(e.height)}function K(e){try{const t=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:e.width,height:e.height}}});document.dispatchEvent(t)}catch{}}function B(){u||(u=_e()||pe()||ue,U(u))}const y={init:function(){B(),K(u)},getReferenceSize:function(){return B(),{width:u.width,height:u.height}},setReferenceSize:function(e){B();const t=D(e&&e.width,320,7680),n=D(e&&e.height,240,4320),o={width:t,height:n};return de(o)?(u=o,U(u),(!e||e.persist!==!1)&&be(u),K(u),!0):!1},resetReferenceSize:function(){u=pe()||ue,Oe(),U(u),K(u)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=y);let z=null,O=null,W=!1,S=null;function H(){return z||(z=document.getElementById("winnieos-canvas")),z}function G(){if(y&&typeof y.getReferenceSize=="function"){const o=y.getReferenceSize();if(o&&Number.isFinite(o.width)&&Number.isFinite(o.height)&&o.width>0&&o.height>0)return{width:o.width,height:o.height}}const e=window.getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--ref-width")),n=parseFloat(e.getPropertyValue("--ref-height"));return Number.isFinite(t)&&Number.isFinite(n)&&t>0&&n>0?{width:Math.round(t),height:Math.round(n)}:{width:1280,height:800}}function fe(){const e=window.visualViewport;return e&&typeof e.width=="number"&&typeof e.height=="number"?{width:e.width,height:e.height,offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function Ee(){const e=H();if(!e)return;const t=G(),n=t.width,o=t.height,i=fe(),r=i.width,s=i.height,l=Math.min(r/n,s/o),a=n*l,p=o*l,c=Math.round(i.offsetLeft+(r-a)/2),w=Math.round(i.offsetTop+(s-p)/2);e.style.position="fixed",e.style.width=n+"px",e.style.height=o+"px",e.style.left=c+"px",e.style.top=w+"px",e.style.margin="0",e.style.padding="0",e.style.transformOrigin="top left";const h=String(he(l));e.style.transform=`scale(${h})`,e.dataset.scale=h,e.dataset.vw=String(Math.round(r)),e.dataset.vh=String(Math.round(s)),e.dataset.left=String(c),e.dataset.top=String(w),document.documentElement.style.setProperty("--viewport-scale",h)}function m(){O||(O=window.requestAnimationFrame(function(){O=null,Ee()}))}function he(e){return Math.round(e*1e5)/1e5}const x={init:function(){W||H()&&(W=!0,m(),window.addEventListener("resize",m),document.addEventListener("winnieos:displaychange",m),window.visualViewport&&(S=window.visualViewport,S.addEventListener("resize",m),S.addEventListener("scroll",m)))},getScale:function(){const e=H();return e?parseFloat(e.dataset.scale||"1"):1},getReferenceSize:function(){return G()},getMetrics:function(){const e=G(),t=fe(),n=H(),o=n?parseFloat(n.dataset.scale||"1"):he(Math.min(t.width/e.width,t.height/e.height));return{reference:{width:e.width,height:e.height},viewport:{width:t.width,height:t.height,offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0},scale:o}},refresh:function(){m()},_resetForTests:function(){if(W&&(window.removeEventListener("resize",m),document.removeEventListener("winnieos:displaychange",m),S&&(S.removeEventListener("resize",m),S.removeEventListener("scroll",m))),O&&typeof window.cancelAnimationFrame=="function")try{window.cancelAnimationFrame(O)}catch{}W=!1,O=null,z=null,S=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=x);let k=!1,T=null;function oe(e){return e.preventDefault(),!1}function ie(e){if(e.key==="F5"||e.ctrlKey&&(e.key==="r"||e.key==="R")||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")||e.key==="Backspace"&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&!e.target.isContentEditable||e.ctrlKey&&(e.key==="w"||e.key==="W"))return e.preventDefault(),!1}function re(e){if(e.button===1)return e.preventDefault(),!1}function Te(e){return e.preventDefault(),!1}const J={init:function(){k||(k=!0,document.addEventListener("contextmenu",oe),document.addEventListener("keydown",ie),document.addEventListener("mousedown",re),T=Te,document.addEventListener("dragstart",T))},_resetForTests:function(){k&&(document.removeEventListener("contextmenu",oe),document.removeEventListener("keydown",ie),document.removeEventListener("mousedown",re),T&&document.removeEventListener("dragstart",T)),k=!1,T=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=J);let A=null,j=null;async function je(e,t){const n=typeof AbortController<"u"?new AbortController:null,o=n?setTimeout(()=>n.abort(),t):null;try{const i=await fetch(e,{cache:"no-store",signal:n?n.signal:void 0});return i.ok?await i.json():null}catch{return null}finally{o&&clearTimeout(o)}}const C={load:async function(){return A||j||(j=(async()=>(A=await je("/winnieos-config.json",750)||null,j=null,A))(),j)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Config=C);const Ne="display.reference";function Ce(){return L.has(Ne)}function Le(e){const t=e&&e.display&&e.display.reference;if(!t||!Number.isFinite(t.width)||!Number.isFinite(t.height)||t.width<=0||t.height<=0||Ce())return;if(y&&typeof y.setReferenceSize=="function"){y.setReferenceSize({width:t.width,height:t.height,persist:!1});return}const n=document.documentElement;n.style.setProperty("--ref-width",`${Math.round(t.width)}px`),n.style.setProperty("--ref-height",`${Math.round(t.height)}px`),n.style.setProperty("--ref-aspect-ratio",String(t.width/t.height))}function se(){const e=C&&typeof C.load=="function"?C.load():Promise.resolve(null);y?y.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),x?x.init():console.error("WinnieOS: Viewport module failed to load"),J?J.init():console.error("WinnieOS: Kiosk module failed to load"),e.then(Le).catch(()=>{})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",se):se();const Me={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=Me);const We={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=We);const ke={id:"animals",title:"Animals",iconEmoji:"ðŸ¦",sortOrder:25,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Animals</div>
            <div class="wos-app-placeholder-text">Animal sounds and matching will live here.</div>
        `)},unmount:function(){}},Ae=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"})),Pe={id:"blocks",title:"Blocks",iconEmoji:"ðŸ§±",sortOrder:15,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Blocks</div>
            <div class="wos-app-placeholder-text">A building blocks game will live here.</div>
        `)},unmount:function(){}},Fe=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"})),ze={id:"bubbles",title:"Bubbles",iconEmoji:"ðŸ«§",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Bubbles</div>
            <div class="wos-app-placeholder-text">Pop pop pop!</div>
        `)},unmount:function(){}},He=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"})),Ie={id:"colors",title:"Colors",iconEmoji:"ðŸŒˆ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Colors</div>
            <div class="wos-app-placeholder-text">Tap colors and paint the world.</div>
        `)},unmount:function(){}},Re=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"})),De={id:"dance",title:"Dance",iconEmoji:"ðŸ’ƒ",sortOrder:55,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Dance</div>
            <div class="wos-app-placeholder-text">A dance party will live here.</div>
        `)},unmount:function(){}},$e=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"})),Ke={id:"garden",title:"Garden",iconEmoji:"ðŸŒ»",sortOrder:60,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Garden</div>
            <div class="wos-app-placeholder-text">Plant and grow little flowers.</div>
        `)},unmount:function(){}},Be=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"})),Ve={id:"memory",title:"Memory",iconEmoji:"ðŸ§ ",sortOrder:45,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Memory</div>
            <div class="wos-app-placeholder-text">A simple matching game will live here.</div>
        `)},unmount:function(){}},qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"})),Ue={id:"music",title:"Music",iconEmoji:"ðŸŽµ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Music</div>
            <div class="wos-app-placeholder-text">This will become a simple music player with big buttons.</div>
        `)},unmount:function(){}},Ge=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"})),xe={id:"numbers",title:"Numbers",iconEmoji:"ðŸ”¢",sortOrder:35,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Numbers</div>
            <div class="wos-app-placeholder-text">Count and tap!</div>
        `)},unmount:function(){}},Je=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"})),Ye={id:"paint",title:"Paint",iconEmoji:"ðŸŽ¨",sortOrder:10,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Paint</div>
            <div class="wos-app-placeholder-text">A simple drawing app will live here.</div>
        `)},unmount:function(){}},Xe=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),Ze={id:"piano",title:"Piano",iconEmoji:"ðŸŽ¹",sortOrder:50,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Piano</div>
            <div class="wos-app-placeholder-text">Tap keys to make music.</div>
        `)},unmount:function(){}},Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ze},Symbol.toStringTag,{value:"Module"})),et={id:"shapes",title:"Shapes",iconEmoji:"ðŸ”º",sortOrder:40,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Shapes</div>
            <div class="wos-app-placeholder-text">Match the shapes.</div>
        `)},unmount:function(){}},tt=Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"})),nt={id:"story",title:"Story Time",iconEmoji:"ðŸ“–",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Story Time</div>
            <div class="wos-app-placeholder-text">Soon weâ€™ll read and play through stories here.</div>
        `)},unmount:function(){}},ot=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"}));function it(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"&&e.id.trim()?e.id.trim():null,n=typeof e.title=="string"&&e.title.trim()?e.title.trim():null,o=typeof e.mount=="function"?e.mount:null,i=typeof e.unmount=="function"?e.unmount:null;return!t||!n||!o?null:{id:t,title:n,iconSrc:typeof e.iconSrc=="string"?e.iconSrc:null,iconEmoji:typeof e.iconEmoji=="string"?e.iconEmoji:null,sortOrder:Number.isFinite(e.sortOrder)?e.sortOrder:0,mount:o,unmount:i}}const le=Object.assign({"./animals/app.js":Ae,"./blocks/app.js":Fe,"./bubbles/app.js":He,"./colors/app.js":Re,"./dance/app.js":$e,"./garden/app.js":Be,"./memory/app.js":qe,"./music/app.js":Ge,"./numbers/app.js":Je,"./paint/app.js":Xe,"./piano/app.js":Qe,"./shapes/app.js":tt,"./story/app.js":ot}),E=new Map;Object.keys(le).forEach(e=>{const t=le[e],n=t&&(t.default||t.app)||null,o=it(n);if(!o){console.warn(`WinnieOS.Apps: invalid app module at ${e}`);return}if(E.has(o.id)){console.warn(`WinnieOS.Apps: duplicate app id "${o.id}" (skipping ${e})`);return}E.set(o.id,o)});let f=null;async function Y(){if(f!==null)return f;try{const e=await C.load();e&&e.apps&&Array.isArray(e.apps.enabled)?f=new Set(e.apps.enabled.map(t=>String(t).trim()).filter(Boolean)):f=new Set(E.keys())}catch(e){console.warn("WinnieOS.Apps: failed to load config, enabling all apps",e),f=new Set(E.keys())}return f}function X(){return Array.from(E.values()).sort((e,t)=>e.sortOrder!==t.sortOrder?e.sortOrder-t.sortOrder:e.title.localeCompare(t.title))}function rt(e){return e?X().filter(t=>e.has(t.id)):X()}typeof window<"u"&&Y().catch(()=>{});const me={list:function(){return f!==null?rt(f):(Y().catch(()=>{}),X())},get:function(e){const t=E.get(String(e||""))||null;return!t||f!==null&&!f.has(t.id)?null:t},refreshConfig:async function(){f=null,await Y()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Apps=me);let V=!1,$={screen:"startup"};const I=new Set;function st(e,t){return!e||!t||e.screen!==t.screen?!1:e.screen==="app"?e.appId===t.appId:!0}function we(){I.forEach(e=>{try{e(_.getState())}catch{}})}function P(e){const t=e&&typeof e=="object"?e:{screen:"desktop"},n=t.screen==="app"?{screen:"app",appId:String(t.appId||"")}:{screen:t.screen==="startup"?"startup":"desktop"};st($,n)||($=n,we())}const _={init:function(e){V||(V=!0,e&&e.initialState&&P(e.initialState),we())},getState:function(){return{...$}},subscribe:function(e){return typeof e!="function"?function(){}:(I.add(e),function(){I.delete(e)})},start:function(){P({screen:"startup"})},goHome:function(){P({screen:"desktop"})},openApp:function(e){P({screen:"app",appId:e})},_resetForTests:function(){V=!1,$={screen:"startup"},I.clear()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Navigation=_);const lt="/assets/images/winnieOS_logo_temp.png",at=(function(){let e=null,t=!1;const n=new Map;function o(){n.forEach((s,l)=>{try{clearTimeout(l)}catch{}try{s()}catch{}}),n.clear()}function i(s){return new Promise(l=>{const a=setTimeout(()=>{n.delete(a),l()},s);n.set(a,l)})}async function r(s){const l=e?e.querySelector("[data-wos-startup-status]"):null,a=c=>{l&&(l.textContent=c)},p=[{label:"Waking up WinnieOS",run:()=>i(450)},{label:"Checking apps",run:()=>i(450)},{label:"Almost ready",run:()=>i(450)}];for(const c of p){if(t)return;a(c.label);try{await c.run()}catch{}}if(!t)try{s.goHome()}catch{}}return{mount:function(s){const l=s&&s.root,a=s&&s.nav;l&&(t=!1,e=document.createElement("div"),e.className="wos-startup",e.innerHTML=`
                <div class="wos-startup-logo-layer">
                    <img class="wos-startup-logo" src="${lt}" alt="WinnieOS" />
                </div>
                <div class="wos-startup-text-layer">
                    <div class="wos-startup-status">
                        <span data-wos-startup-status>Starting up</span>
                        <span class="wos-startup-dots" aria-hidden="true">
                            <span>.</span><span>.</span><span>.</span>
                        </span>
                    </div>
                </div>
            `,l.replaceChildren(e),a&&r(a))},unmount:function(){if(t=!0,o(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),ct=(function(){let e=null,t=null;function n(i,r){const s=document.createElement("button");if(s.className="wos-app-tile",s.type="button",s.setAttribute("aria-label",i.title),s.addEventListener("click",()=>r.openApp(i.id)),i.iconSrc){const a=document.createElement("img");a.className="wos-app-icon",a.alt="",a.src=i.iconSrc,s.appendChild(a)}else{const a=document.createElement("div");a.className="wos-app-emoji",a.textContent=i.iconEmoji||"â­",s.appendChild(a)}const l=document.createElement("div");return l.className="wos-app-title",l.textContent=i.title,s.appendChild(l),s}function o(i,r,s){if(t)try{t()}catch{}const l=s.list();e=document.createElement("div"),e.className="wos-desktop";const a=document.createElement("div");a.className="wos-desktop-inner";const p=document.createElement("div");p.className="wos-app-grid",l.forEach(h=>{p.appendChild(n(h,r))}),a.appendChild(p),e.appendChild(a),i.replaceChildren(e);const c=()=>{if(!e)return;const h=getComputedStyle(e),ye=parseFloat(h.paddingTop)||0,ve=parseFloat(h.paddingBottom)||0,Se=Math.max(0,e.clientHeight-ye-ve),te=p.getBoundingClientRect().height;te>0&&te<Se?e.classList.add("wos-desktop--centered"):e.classList.remove("wos-desktop--centered")},w=requestAnimationFrame(c);window.addEventListener("resize",c),t=()=>{try{cancelAnimationFrame(w)}catch{}window.removeEventListener("resize",c)}}return{mount:function(i){const r=i&&i.root,s=i&&i.nav,l=i&&i.apps;if(!r||!s||!l)return;o(r,s,l);const a=l.list().length;l.refreshConfig&&typeof l.refreshConfig=="function"&&l.refreshConfig().then(()=>{e&&e.parentNode===r&&l.list().length!==a&&o(r,s,l)}).catch(()=>{})},unmount:function(){if(t)try{t()}catch{}if(t=null,e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),ut=(function(){let e=null,t=null,n=null,o=null;function i(){if(typeof o=="function")try{o()}catch{}if(n&&typeof n.unmount=="function")try{n.unmount()}catch{}o=null,n=null}return{mount:function(r){const s=r&&r.root,l=r&&r.nav,a=r&&r.apps,p=r&&r.appId;if(!s||!a)return;e=document.createElement("div"),e.className="wos-app-host",t=document.createElement("div"),t.className="wos-app-root",e.appendChild(t),s.replaceChildren(e);const c=a.get(p);if(!c){t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Oops!</div>
                    <div class="wos-app-placeholder-text">That app isnâ€™t here yet.</div>
                `;return}n=c;try{const w=c.mount({root:t,nav:l});o=typeof w=="function"?w:null}catch{t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Uh oh!</div>
                    <div class="wos-app-placeholder-text">This app had a little problem starting.</div>
                `,n=null,o=null}},unmount:function(){if(i(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null,t=null}}})(),Z={startup:at,desktop:ct,app:ut};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Screens=Z);let q=!1,F=null,d=null,v=null,g=null,Q=null;function dt(){return document.getElementById("winnieos-canvas")}function pt(){const e=dt();if(!e)return!1;const t=e.querySelector(".wos-html-fallback");if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch{}d=e.querySelector("#wos-shell"),d||(d=document.createElement("div"),d.id="wos-shell",e.appendChild(d));let n=d.querySelector("#wos-topbar");n||(n=document.createElement("div"),n.id="wos-topbar",d.appendChild(n));let o=d.querySelector("#wos-home-btn");return o||(o=document.createElement("button"),o.id="wos-home-btn",o.type="button",o.setAttribute("aria-label","Home"),o.innerHTML=`
            <svg class="wos-home-icon" aria-hidden="true" viewBox="0 0 24 24" focusable="false">
                <path fill="currentColor" d="M12 3.2 3 10.4v10.4h6.2v-6.2h5.6v6.2H21V10.4L12 3.2Zm7 15.6h-2.6v-6.2H7.6v6.2H5V11.4l7-5.6 7 5.6v7.4Z"/>
            </svg>
        `,o.addEventListener("click",()=>_.goHome()),n.appendChild(o)),v=d.querySelector("#wos-content"),v||(v=document.createElement("div"),v.id="wos-content",d.appendChild(v)),!0}function ge(){if(g&&typeof g.unmount=="function")try{g.unmount()}catch{}g=null}function ae(e){if(!v||!d)return;const t=e&&e.screen?e.screen:"desktop";d.dataset.screen=t;const n=Z[t]||Z.desktop,o=t==="app"?`app:${String(e&&e.appId||"")}`:t;g===n&&Q===o||(ge(),g=n,Q=o,g&&typeof g.mount=="function"&&g.mount({root:v,nav:_,apps:me,appId:e&&e.appId}))}const R={init:function(){q||pt()&&(q=!0,_.init({initialState:{screen:"startup"}}),F=_.subscribe(ae),ae(_.getState()))},_resetForTests:function(){if(F)try{F()}catch{}F=null,ge(),q=!1,d=null,v=null,Q=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Shell=R);function ce(){!R||typeof R.init!="function"||R.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ce):ce();
