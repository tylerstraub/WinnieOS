(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}})();const v="winnieos.display.reference",b={width:1280,height:800};let s=null;function E(e){if(e==null)return null;const t=String(e).trim();if(!t)return null;const o=t.match(/^([0-9.]+)px$/i);if(!o)return null;const n=Number(o[1]);return Number.isFinite(n)?n:null}function f(e,t,o){const n=Math.round(Number(e));return Number.isFinite(n)?Math.min(o,Math.max(t,n)):null}function W(e){return!!e&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>=320&&e.height>=240&&e.width<=7680&&e.height<=4320}function L(){const e=document.documentElement,t=window.getComputedStyle(e),o=E(t.getPropertyValue("--ref-width")),n=E(t.getPropertyValue("--ref-height"));return Number.isFinite(o)&&Number.isFinite(n)&&o>0&&n>0?{width:Math.round(o),height:Math.round(n)}:null}function C(){try{const e=window.localStorage.getItem(v);if(!e)return null;const t=JSON.parse(e);if(!t||typeof t!="object")return null;const o=f(t.width,320,7680),n=f(t.height,240,4320),i={width:o,height:n};return W(i)?i:null}catch{return null}}function I(e){try{window.localStorage.setItem(v,JSON.stringify(e))}catch{}}function V(){try{window.localStorage.removeItem(v)}catch{}}function g(e){const t=document.documentElement;t.style.setProperty("--ref-width",e.width+"px"),t.style.setProperty("--ref-height",e.height+"px"),t.style.setProperty("--ref-aspect-ratio",String(e.width/e.height)),t.dataset.refWidth=String(e.width),t.dataset.refHeight=String(e.height)}function a(e){try{const t=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:e.width,height:e.height}}});document.dispatchEvent(t)}catch{}}function h(){s||(s=C()||L()||b,g(s))}const u={init:function(){h(),a(s)},getReferenceSize:function(){return h(),{width:s.width,height:s.height}},setReferenceSize:function(e){h();const t=f(e&&e.width,320,7680),o=f(e&&e.height,240,4320),n={width:t,height:o};return W(n)?(s=n,g(s),(!e||e.persist!==!1)&&I(s),a(s),!0):!1},resetReferenceSize:function(){s=L()||b,V(),g(s),a(s)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=u);let w=null,p=null;function m(){return w||(w=document.getElementById("winnieos-canvas")),w}function N(){if(u&&typeof u.getReferenceSize=="function"){const n=u.getReferenceSize();if(n&&Number.isFinite(n.width)&&Number.isFinite(n.height)&&n.width>0&&n.height>0)return{width:n.width,height:n.height}}const e=window.getComputedStyle(document.documentElement),t=parseInt(e.getPropertyValue("--ref-width"),10),o=parseInt(e.getPropertyValue("--ref-height"),10);return Number.isFinite(t)&&Number.isFinite(o)&&t>0&&o>0?{width:t,height:o}:{width:1280,height:800}}function k(){const e=window.visualViewport;return e&&typeof e.width=="number"&&typeof e.height=="number"?{width:e.width,height:e.height,offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function z(){const e=m();if(!e)return;const t=N(),o=t.width,n=t.height,i=k(),r=i.width,d=i.height,l=Math.min(r/o,d/n),F=o*l,P=n*l,R=i.offsetLeft+(r-F)/2,D=i.offsetTop+(d-P)/2;e.style.position="fixed",e.style.width=o+"px",e.style.height=n+"px",e.style.left=R+"px",e.style.top=D+"px",e.style.margin="0",e.style.padding="0",e.style.transformOrigin="top left",e.style.transform=`scale(${l})`,e.dataset.scale=String(l),document.documentElement.style.setProperty("--viewport-scale",String(l))}function c(){p||(p=window.requestAnimationFrame(function(){p=null,z()}))}const y={init:function(){m()&&(c(),window.addEventListener("resize",c),document.addEventListener("winnieos:displaychange",c),window.visualViewport&&(window.visualViewport.addEventListener("resize",c),window.visualViewport.addEventListener("scroll",c)))},getScale:function(){const e=m();return e?parseFloat(e.dataset.scale||"1"):1},getReferenceSize:function(){return N()},refresh:function(){c()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=y);function T(e){return e.preventDefault(),!1}function A(e){if(e.key==="F5"||e.ctrlKey&&(e.key==="r"||e.key==="R")||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")||e.key==="Backspace"&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&!e.target.isContentEditable||e.ctrlKey&&(e.key==="w"||e.key==="W"))return e.preventDefault(),!1}function K(e){if(e.button===1)return e.preventDefault(),!1}const S={init:function(){document.addEventListener("contextmenu",T),document.addEventListener("keydown",A),document.addEventListener("mousedown",K),document.addEventListener("dragstart",function(e){return e.preventDefault(),!1})}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=S);function O(){u?u.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),y?y.init():console.error("WinnieOS: Viewport module failed to load"),S?S.init():console.error("WinnieOS: Kiosk module failed to load")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",O):O();const M={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=M);const x={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=x);
