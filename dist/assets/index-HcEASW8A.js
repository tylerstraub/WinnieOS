(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const J="winnieos.";function K(){try{if(typeof window>"u"||!window.localStorage)return!1;const e="__storage_test__";return window.localStorage.setItem(e,"test"),window.localStorage.removeItem(e),!0}catch{return!1}}function te(e){if(!e||typeof e!="string")throw new Error("Storage key must be a non-empty string");return e.startsWith(J)?e:J+e}const x={get:function(e,t=null){if(!K())return t;try{const n=te(e),o=window.localStorage.getItem(n);if(o===null)return t;try{return JSON.parse(o)}catch{return o}}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return t}},set:function(e,t){if(!K())return!1;try{const n=te(e),o=JSON.stringify(t);return window.localStorage.setItem(n,o),!0}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return!1}},remove:function(e){if(!K())return!1;try{const t=te(e);return window.localStorage.removeItem(t),!0}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},has:function(e){if(!K())return!1;try{const t=te(e);return window.localStorage.getItem(t)!==null}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},clear:function(){if(!K())return!1;try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(J)&&e.push(n)}return e.forEach(t=>window.localStorage.removeItem(t)),!0}catch{return!1}},keys:function(){if(!K())return[];try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(J)&&e.push(n.substring(J.length))}return e}catch{return[]}}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Storage=x);const Ce="display.reference",xe={width:1280,height:800};let O=null;function Pe(e){if(e==null)return null;const t=String(e).trim();if(!t)return null;const n=t.match(/^([0-9.]+)px$/i);if(!n)return null;const o=Number(n[1]);return Number.isFinite(o)?o:null}function de(e,t,n){const o=Math.round(Number(e));return Number.isFinite(o)?Math.min(n,Math.max(t,o)):null}function Be(e){return!!e&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>=320&&e.height>=240&&e.width<=7680&&e.height<=4320}function Ke(){const e=document.documentElement,t=window.getComputedStyle(e),n=Pe(t.getPropertyValue("--ref-width")),o=Pe(t.getPropertyValue("--ref-height"));return Number.isFinite(n)&&Number.isFinite(o)&&n>0&&o>0?{width:Math.round(n),height:Math.round(o)}:null}function it(){const e=x.get(Ce);if(!e||typeof e!="object")return null;const t=de(e.width,320,7680),n=de(e.height,240,4320),o={width:t,height:n};return Be(o)?o:null}function rt(e){x.set(Ce,e)}function st(){x.remove(Ce)}function ye(e){const t=document.documentElement;t.style.setProperty("--ref-width",e.width+"px"),t.style.setProperty("--ref-height",e.height+"px"),t.style.setProperty("--ref-aspect-ratio",String(e.width/e.height)),t.dataset.refWidth=String(e.width),t.dataset.refHeight=String(e.height)}function he(e){try{const t=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:e.width,height:e.height}}});document.dispatchEvent(t)}catch{}}function me(){O||(O=it()||Ke()||xe,ye(O))}const F={init:function(){me(),he(O)},getReferenceSize:function(){return me(),{width:O.width,height:O.height}},setReferenceSize:function(e){me();const t=de(e&&e.width,320,7680),n=de(e&&e.height,240,4320),o={width:t,height:n};return Be(o)?(O=o,ye(O),(!e||e.persist!==!1)&&rt(O),he(O),!0):!1},resetReferenceSize:function(){O=Ke()||xe,st(),ye(O),he(O)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=F);let ae=null,U=null,ne=!1,H=null;function le(){return ae||(ae=document.getElementById("winnieos-canvas")),ae}function ve(){if(F&&typeof F.getReferenceSize=="function"){const o=F.getReferenceSize();if(o&&Number.isFinite(o.width)&&Number.isFinite(o.height)&&o.width>0&&o.height>0)return{width:o.width,height:o.height}}const e=window.getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--ref-width")),n=parseFloat(e.getPropertyValue("--ref-height"));return Number.isFinite(t)&&Number.isFinite(n)&&t>0&&n>0?{width:Math.round(t),height:Math.round(n)}:{width:1280,height:800}}function Ue(){const e=window.visualViewport;return e&&typeof e.width=="number"&&typeof e.height=="number"?{width:e.width,height:e.height,offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function at(){const e=le();if(!e)return;const t=ve(),n=t.width,o=t.height,i=Ue(),s=i.width,l=i.height,c=Math.min(s/n,l/o),a=n*c,_=o*c,g=Math.round(i.offsetLeft+(s-a)/2),y=Math.round(i.offsetTop+(l-_)/2);e.style.position="fixed",e.style.width=n+"px",e.style.height=o+"px",e.style.left=g+"px",e.style.top=y+"px",e.style.margin="0",e.style.padding="0",e.style.transformOrigin="top left";const b=String(Ve(c));e.style.transform=`scale(${b})`,e.dataset.scale=b,e.dataset.vw=String(Math.round(s)),e.dataset.vh=String(Math.round(l)),e.dataset.left=String(g),e.dataset.top=String(y),document.documentElement.style.setProperty("--viewport-scale",b)}function W(){U||(U=window.requestAnimationFrame(function(){U=null,at()}))}function Ve(e){return Math.round(e*1e5)/1e5}const Se={init:function(){ne||le()&&(ne=!0,W(),window.addEventListener("resize",W),document.addEventListener("winnieos:displaychange",W),window.visualViewport&&(H=window.visualViewport,H.addEventListener("resize",W),H.addEventListener("scroll",W)))},getScale:function(){const e=le();return e?parseFloat(e.dataset.scale||"1"):1},getReferenceSize:function(){return ve()},getMetrics:function(){const e=ve(),t=Ue(),n=le(),o=n?parseFloat(n.dataset.scale||"1"):Ve(Math.min(t.width/e.width,t.height/e.height));return{reference:{width:e.width,height:e.height},viewport:{width:t.width,height:t.height,offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0},scale:o}},refresh:function(){W()},_resetForTests:function(){if(ne&&(window.removeEventListener("resize",W),document.removeEventListener("winnieos:displaychange",W),H&&(H.removeEventListener("resize",W),H.removeEventListener("scroll",W))),U&&typeof window.cancelAnimationFrame=="function")try{window.cancelAnimationFrame(U)}catch{}ne=!1,U=null,ae=null,H=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=Se);let oe=!1,Y=null;function Fe(e){return e.preventDefault(),!1}function Ie(e){if(e.key==="F5"||e.ctrlKey&&(e.key==="r"||e.key==="R")||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")||e.key==="Backspace"&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&!e.target.isContentEditable||e.ctrlKey&&(e.key==="w"||e.key==="W"))return e.preventDefault(),!1}function Re(e){if(e.button===1)return e.preventDefault(),!1}function lt(e){return e.preventDefault(),!1}const be={init:function(){oe||(oe=!0,document.addEventListener("contextmenu",Fe),document.addEventListener("keydown",Ie),document.addEventListener("mousedown",Re),Y=lt,document.addEventListener("dragstart",Y))},_resetForTests:function(){oe&&(document.removeEventListener("contextmenu",Fe),document.removeEventListener("keydown",Ie),document.removeEventListener("mousedown",Re),Y&&document.removeEventListener("dragstart",Y)),oe=!1,Y=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=be);let ie=null,X=null;async function ct(e,t){const n=typeof AbortController<"u"?new AbortController:null,o=n?setTimeout(()=>n.abort(),t):null;try{const i=await fetch(e,{cache:"no-store",signal:n?n.signal:void 0});return i.ok?await i.json():null}catch{return null}finally{o&&clearTimeout(o)}}const Z={load:async function(){return ie||X||(X=(async()=>(ie=await ct("/winnieos-config.json",750)||null,X=null,ie))(),X)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Config=Z);const qe="preferences.backgroundColor",ut="#667eea",dt="#764ba2";function Ge(e,t,n){const o=i=>{const s=Math.round(Math.max(0,Math.min(255,i))).toString(16);return s.length===1?"0"+s:s};return`#${o(e)}${o(t)}${o(n)}`}function Ye(e){if(!e||typeof e!="string")return{r:0,g:0,b:0};let t=e.replace("#","").trim();if(t.length===3&&(t=t.split("").map(s=>s+s).join("")),t.length!==6||!/^[0-9a-fA-F]{6}$/.test(t))return{r:0,g:0,b:0};const n=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16);return!Number.isFinite(n)||!Number.isFinite(o)||!Number.isFinite(i)?{r:0,g:0,b:0}:{r:n,g:o,b:i}}function Xe(e){const t=Ye(e),n=t.r/255,o=t.g/255,i=t.b/255,s=Math.max(n,o,i),l=Math.min(n,o,i),c=s-l;let a=0;c!==0&&(s===n?a=(o-i)/c%6:s===o?a=(i-n)/c+2:a=(n-o)/c+4),a=Math.round(a*60),a<0&&(a+=360),a=(a+30)%360;const _=(s+l)/2,g=c===0?0:c/(1-Math.abs(2*_-1)),y=(1-Math.abs(2*_-1))*g,b=y*(1-Math.abs(a/60%2-1)),R=_-y/2;let T=0,v=0,M=0;return a<60?(T=y,v=b,M=0):a<120?(T=b,v=y,M=0):a<180?(T=0,v=y,M=b):a<240?(T=0,v=b,M=y):a<300?(T=b,v=0,M=y):(T=y,v=0,M=b),Ge(Math.round((T+R)*255),Math.round((v+R)*255),Math.round((M+R)*255))}function _e(e,t=null){if(!e||typeof e!="string")return;const n=t||Xe(e),o=document.body,i=document.getElementById("winnieos-canvas");o&&o.style.setProperty("background",e),i&&i.style.setProperty("background",`linear-gradient(135deg, ${e} 0%, ${n} 100%)`)}function Je(){return x.get(qe,null)}function pt(e){return!e||typeof e!="string"?!1:x.set(qe,e)}function ft(){const e=Je();e?_e(e):_e(ut,dt)}const A={apply:_e,getSaved:Je,save:pt,load:ft,rgbToHex:Ge,hexToRgb:Ye,generateSecondary:Xe};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Background=A);const ht="display.reference";function mt(){return x.has(ht)}function wt(e){const t=e&&e.display&&e.display.reference;if(!t||!Number.isFinite(t.width)||!Number.isFinite(t.height)||t.width<=0||t.height<=0||mt())return;if(F&&typeof F.setReferenceSize=="function"){F.setReferenceSize({width:t.width,height:t.height,persist:!1});return}const n=document.documentElement;n.style.setProperty("--ref-width",`${Math.round(t.width)}px`),n.style.setProperty("--ref-height",`${Math.round(t.height)}px`),n.style.setProperty("--ref-aspect-ratio",String(t.width/t.height))}function De(){const e=Z&&typeof Z.load=="function"?Z.load():Promise.resolve(null);F?F.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),Se?Se.init():console.error("WinnieOS: Viewport module failed to load"),be?be.init():console.error("WinnieOS: Kiosk module failed to load"),A&&typeof A.load=="function"&&A.load(),e.then(wt).catch(()=>{})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",De):De();const gt={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=gt);const yt={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=yt);const vt={id:"animals",title:"Animals",iconEmoji:"ðŸ¦",sortOrder:25,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Animals</div>
            <div class="wos-app-placeholder-text">Animal sounds and matching will live here.</div>
        `)},unmount:function(){}},St=Object.freeze(Object.defineProperty({__proto__:null,default:vt},Symbol.toStringTag,{value:"Module"})),bt={id:"blocks",title:"Blocks",iconEmoji:"ðŸ§±",sortOrder:15,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Blocks</div>
            <div class="wos-app-placeholder-text">A building blocks game will live here.</div>
        `)},unmount:function(){}},_t=Object.freeze(Object.defineProperty({__proto__:null,default:bt},Symbol.toStringTag,{value:"Module"})),Ot={id:"bubbles",title:"Bubbles",iconEmoji:"ðŸ«§",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Bubbles</div>
            <div class="wos-app-placeholder-text">Pop pop pop!</div>
        `)},unmount:function(){}},Et=Object.freeze(Object.defineProperty({__proto__:null,default:Ot},Symbol.toStringTag,{value:"Module"})),Mt={id:"colors",title:"Colors",iconEmoji:"ðŸŒˆ",sortOrder:30,mount:function({root:e}){if(!e)return;e.className="wos-colors-app",e.innerHTML="";const t=document.createElement("div");t.className="wos-colors-container";const n=document.createElement("div");n.className="wos-colors-picker",n.setAttribute("role","application"),n.setAttribute("aria-label","Color picker");const o=document.createElement("canvas");o.className="wos-colors-canvas";const i=.35,s=.95;let l=0;const c=r=>Math.max(0,Math.min(1,r)),a=(r,p,f)=>{r=r%360,r<0&&(r+=360);const u=f*p,h=u*(1-Math.abs(r/60%2-1)),m=f-u;let d=0,w=0,S=0;return r<60?(d=u,w=h,S=0):r<120?(d=h,w=u,S=0):r<180?(d=0,w=u,S=h):r<240?(d=0,w=h,S=u):r<300?(d=h,w=0,S=u):(d=u,w=0,S=h),{r:Math.round((d+m)*255),g:Math.round((w+m)*255),b:Math.round((S+m)*255)}},_=(r,p,f)=>{r=r/255,p=p/255,f=f/255;const u=Math.max(r,p,f),h=Math.min(r,p,f),m=u-h;let d=0;m!==0&&(u===r?d=(p-f)/m%6:u===p?d=(f-r)/m+2:d=(r-p)/m+4),d=Math.round(d*60),d<0&&(d+=360);const w=u===0?0:m/u;return{h:d,s:w,v:u}},g=()=>{const r=n.getBoundingClientRect(),p=Math.max(1,r.width),f=Math.max(1,r.height),u=p/2,h=f/2,m=Math.min(u,h);return{rect:r,width:p,height:f,cx:u,cy:h,radius:m}},y=r=>i+(1-i)*c(r),b=r=>c((r-i)/(1-i)),R=(r,p)=>{const{rect:f,width:u,height:h,cx:m,cy:d,radius:w}=g(),S=r-f.left,D=p-f.top,L=S-m,N=D-d,j=Math.sqrt(L*L+N*N),z=Math.min(w,j),B=Math.atan2(N,L),q=j<1?l:(B*180/Math.PI+360)%360,ee=w<=0?0:z/w;return{width:u,height:h,cx:m,cy:d,radius:w,dx:L,dy:N,distance:j,distClamped:z,angle:B,hue:q,t:ee}},T=({hue:r,t:p})=>{const f=y(p),u=a(r,f,s);return A.rgbToHex(u.r,u.g,u.b)},v=document.createElement("div");v.className="wos-colors-indicator",v.setAttribute("aria-hidden","true");const M=({cx:r,cy:p,radius:f,angle:u,distClamped:h,width:m,height:d})=>{const w=r+Math.cos(u)*h,S=p+Math.sin(u)*h;v.style.left=`${w/m*100}%`,v.style.top=`${S/d*100}%`},Le=()=>{const r=A.getSaved(),{width:p,height:f,cx:u,cy:h,radius:m}=g();if(!r||m<=0){v.style.left="50%",v.style.top="50%";return}const d=A.hexToRgb(r),w=_(d.r,d.g,d.b);l=w.h;const S=b(w.s),D=w.h*Math.PI/180,L=S*m,N=u+Math.cos(D)*L,j=h+Math.sin(D)*L;v.style.left=`${N/p*100}%`,v.style.top=`${j/f*100}%`},Ne=()=>{const r=n.getBoundingClientRect(),p=window.devicePixelRatio||1,f=Math.max(1,Math.floor(r.width)),u=Math.max(1,Math.floor(r.height)),h=Math.max(1,Math.floor(f*p)),m=Math.max(1,Math.floor(u*p));o.width=h,o.height=m;const d=o.getContext("2d");if(!d)return;const w=d.createImageData(h,m),S=w.data,D=h/2,L=m/2,N=Math.min(D,L);for(let j=0;j<m;j++)for(let z=0;z<h;z++){const B=z-D,q=j-L,ee=Math.sqrt(B*B+q*q),G=(j*h+z)*4;if(ee>N){S[G+3]=0;continue}const tt=(Math.atan2(q,B)*180/Math.PI+360)%360,nt=N<=0?0:ee/N,ot=y(nt),fe=a(tt,ot,s);S[G]=fe.r,S[G+1]=fe.g,S[G+2]=fe.b,S[G+3]=255}d.putImageData(w,0,0)};n.appendChild(o),n.appendChild(v),t.appendChild(n),e.appendChild(t),requestAnimationFrame(()=>{Ne(),Le()});const je=new ResizeObserver(()=>{Ne(),Le()});je.observe(n);let k=null;const We=(r,p)=>{const f=R(r,p);l=f.hue,M(f);const u=T(f);v.classList.add("wos-colors-indicator-active"),setTimeout(()=>{v.classList.remove("wos-colors-indicator-active")},180),A.apply(u),A.save(u)},ke=r=>{if(k===null){k=r.pointerId;try{n.setPointerCapture(k)}catch{}r.preventDefault(),We(r.clientX,r.clientY)}},Ae=r=>{k===null||r.pointerId!==k||(r.preventDefault(),We(r.clientX,r.clientY))},Q=r=>{if(!(k===null||r.pointerId!==k)){r.preventDefault();try{n.releasePointerCapture(k)}catch{}k=null}};return n.addEventListener("pointerdown",ke),n.addEventListener("pointermove",Ae),n.addEventListener("pointerup",Q),n.addEventListener("pointercancel",Q),function(){try{je.disconnect()}catch{}n.removeEventListener("pointerdown",ke),n.removeEventListener("pointermove",Ae),n.removeEventListener("pointerup",Q),n.removeEventListener("pointercancel",Q)}},unmount:function(){}},Tt=Object.freeze(Object.defineProperty({__proto__:null,default:Mt},Symbol.toStringTag,{value:"Module"})),Ct={id:"dance",title:"Dance",iconEmoji:"ðŸ’ƒ",sortOrder:55,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Dance</div>
            <div class="wos-app-placeholder-text">A dance party will live here.</div>
        `)},unmount:function(){}},Lt=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),Nt={id:"garden",title:"Garden",iconEmoji:"ðŸŒ»",sortOrder:60,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Garden</div>
            <div class="wos-app-placeholder-text">Plant and grow little flowers.</div>
        `)},unmount:function(){}},jt=Object.freeze(Object.defineProperty({__proto__:null,default:Nt},Symbol.toStringTag,{value:"Module"})),Wt={id:"memory",title:"Memory",iconEmoji:"ðŸ§ ",sortOrder:45,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Memory</div>
            <div class="wos-app-placeholder-text">A simple matching game will live here.</div>
        `)},unmount:function(){}},kt=Object.freeze(Object.defineProperty({__proto__:null,default:Wt},Symbol.toStringTag,{value:"Module"})),At={id:"music",title:"Music",iconEmoji:"ðŸŽµ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Music</div>
            <div class="wos-app-placeholder-text">This will become a simple music player with big buttons.</div>
        `)},unmount:function(){}},Pt=Object.freeze(Object.defineProperty({__proto__:null,default:At},Symbol.toStringTag,{value:"Module"})),Ft={id:"numbers",title:"Numbers",iconEmoji:"ðŸ”¢",sortOrder:35,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Numbers</div>
            <div class="wos-app-placeholder-text">Count and tap!</div>
        `)},unmount:function(){}},It=Object.freeze(Object.defineProperty({__proto__:null,default:Ft},Symbol.toStringTag,{value:"Module"})),Rt={id:"paint",title:"Paint",iconEmoji:"ðŸŽ¨",sortOrder:10,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Paint</div>
            <div class="wos-app-placeholder-text">A simple drawing app will live here.</div>
        `)},unmount:function(){}},Dt=Object.freeze(Object.defineProperty({__proto__:null,default:Rt},Symbol.toStringTag,{value:"Module"})),zt={id:"piano",title:"Piano",iconEmoji:"ðŸŽ¹",sortOrder:50,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Piano</div>
            <div class="wos-app-placeholder-text">Tap keys to make music.</div>
        `)},unmount:function(){}},Ht=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"})),$t={id:"shapes",title:"Shapes",iconEmoji:"ðŸ”º",sortOrder:40,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Shapes</div>
            <div class="wos-app-placeholder-text">Match the shapes.</div>
        `)},unmount:function(){}},xt=Object.freeze(Object.defineProperty({__proto__:null,default:$t},Symbol.toStringTag,{value:"Module"})),Bt={id:"story",title:"Story Time",iconEmoji:"ðŸ“–",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Story Time</div>
            <div class="wos-app-placeholder-text">Soon weâ€™ll read and play through stories here.</div>
        `)},unmount:function(){}},Kt=Object.freeze(Object.defineProperty({__proto__:null,default:Bt},Symbol.toStringTag,{value:"Module"}));function Ut(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"&&e.id.trim()?e.id.trim():null,n=typeof e.title=="string"&&e.title.trim()?e.title.trim():null,o=typeof e.mount=="function"?e.mount:null,i=typeof e.unmount=="function"?e.unmount:null;return!t||!n||!o?null:{id:t,title:n,iconSrc:typeof e.iconSrc=="string"?e.iconSrc:null,iconEmoji:typeof e.iconEmoji=="string"?e.iconEmoji:null,sortOrder:Number.isFinite(e.sortOrder)?e.sortOrder:0,mount:o,unmount:i}}const ze=Object.assign({"./animals/app.js":St,"./blocks/app.js":_t,"./bubbles/app.js":Et,"./colors/app.js":Tt,"./dance/app.js":Lt,"./garden/app.js":jt,"./memory/app.js":kt,"./music/app.js":Pt,"./numbers/app.js":It,"./paint/app.js":Dt,"./piano/app.js":Ht,"./shapes/app.js":xt,"./story/app.js":Kt}),V=new Map;Object.keys(ze).forEach(e=>{const t=ze[e],n=t&&(t.default||t.app)||null,o=Ut(n);if(!o){console.warn(`WinnieOS.Apps: invalid app module at ${e}`);return}if(V.has(o.id)){console.warn(`WinnieOS.Apps: duplicate app id "${o.id}" (skipping ${e})`);return}V.set(o.id,o)});let C=null;async function Oe(){if(C!==null)return C;try{const e=await Z.load();e&&e.apps&&Array.isArray(e.apps.enabled)?C=new Set(e.apps.enabled.map(t=>String(t).trim()).filter(Boolean)):C=new Set(V.keys())}catch(e){console.warn("WinnieOS.Apps: failed to load config, enabling all apps",e),C=new Set(V.keys())}return C}function Ee(){return Array.from(V.values()).sort((e,t)=>e.sortOrder!==t.sortOrder?e.sortOrder-t.sortOrder:e.title.localeCompare(t.title))}function Vt(e){return e?Ee().filter(t=>e.has(t.id)):Ee()}typeof window<"u"&&Oe().catch(()=>{});const Ze={list:function(){return C!==null?Vt(C):(Oe().catch(()=>{}),Ee())},get:function(e){const t=V.get(String(e||""))||null;return!t||C!==null&&!C.has(t.id)?null:t},refreshConfig:async function(){C=null,await Oe()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Apps=Ze);let we=!1,pe={screen:"startup"};const ce=new Set;function qt(e,t){return!e||!t||e.screen!==t.screen?!1:e.screen==="app"?e.appId===t.appId:!0}function Qe(){ce.forEach(e=>{try{e($.getState())}catch{}})}function re(e){const t=e&&typeof e=="object"?e:{screen:"desktop"},n=t.screen==="app"?{screen:"app",appId:String(t.appId||"")}:{screen:t.screen==="startup"?"startup":"desktop"};qt(pe,n)||(pe=n,Qe())}const $={init:function(e){we||(we=!0,e&&e.initialState&&re(e.initialState),Qe())},getState:function(){return{...pe}},subscribe:function(e){return typeof e!="function"?function(){}:(ce.add(e),function(){ce.delete(e)})},start:function(){re({screen:"startup"})},goHome:function(){re({screen:"desktop"})},openApp:function(e){re({screen:"app",appId:e})},_resetForTests:function(){we=!1,pe={screen:"startup"},ce.clear()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Navigation=$);const Gt="/assets/images/winnieOS_logo_temp.png",Yt=(function(){let e=null,t=!1;const n=new Map;function o(){n.forEach((l,c)=>{try{clearTimeout(c)}catch{}try{l()}catch{}}),n.clear()}function i(l){return new Promise(c=>{const a=setTimeout(()=>{n.delete(a),c()},l);n.set(a,c)})}async function s(l){const c=e?e.querySelector("[data-wos-startup-status]"):null,a=g=>{c&&(c.textContent=g)},_=[{label:"Waking up WinnieOS",run:()=>i(450)},{label:"Checking apps",run:()=>i(450)},{label:"Almost ready",run:()=>i(450)}];for(const g of _){if(t)return;a(g.label);try{await g.run()}catch{}}if(!t)try{l.goHome()}catch{}}return{mount:function(l){const c=l&&l.root,a=l&&l.nav;c&&(t=!1,e=document.createElement("div"),e.className="wos-startup",e.innerHTML=`
                <div class="wos-startup-logo-layer">
                    <img class="wos-startup-logo" src="${Gt}" alt="WinnieOS" />
                </div>
                <div class="wos-startup-text-layer">
                    <div class="wos-startup-status">
                        <span data-wos-startup-status>Starting up</span>
                        <span class="wos-startup-dots" aria-hidden="true">
                            <span>.</span><span>.</span><span>.</span>
                        </span>
                    </div>
                </div>
            `,c.replaceChildren(e),a&&s(a))},unmount:function(){if(t=!0,o(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),Xt=(function(){let e=null,t=null;function n(i,s){const l=document.createElement("button");if(l.className="wos-app-tile",l.type="button",l.setAttribute("aria-label",i.title),l.addEventListener("click",()=>s.openApp(i.id)),i.iconSrc){const a=document.createElement("img");a.className="wos-app-icon",a.alt="",a.src=i.iconSrc,l.appendChild(a)}else{const a=document.createElement("div");a.className="wos-app-emoji",a.textContent=i.iconEmoji||"â­",l.appendChild(a)}const c=document.createElement("div");return c.className="wos-app-title",c.textContent=i.title,l.appendChild(c),l}function o(i,s,l){if(t)try{t()}catch{}const c=l.list();e=document.createElement("div"),e.className="wos-desktop";const a=document.createElement("div");a.className="wos-desktop-inner";const _=document.createElement("div");_.className="wos-app-grid",c.forEach(b=>{_.appendChild(n(b,s))}),a.appendChild(_),e.appendChild(a),i.replaceChildren(e);const g=()=>{if(!e)return;const b=getComputedStyle(e),R=parseFloat(b.paddingTop)||0,T=parseFloat(b.paddingBottom)||0,v=Math.max(0,e.clientHeight-R-T),M=_.getBoundingClientRect().height;M>0&&M<v?e.classList.add("wos-desktop--centered"):e.classList.remove("wos-desktop--centered")},y=requestAnimationFrame(g);window.addEventListener("resize",g),t=()=>{try{cancelAnimationFrame(y)}catch{}window.removeEventListener("resize",g)}}return{mount:async function(i){const s=i&&i.root,l=i&&i.nav,c=i&&i.apps;if(!(!s||!l||!c)){if(c.refreshConfig&&typeof c.refreshConfig=="function")try{await c.refreshConfig()}catch(a){console.warn("DesktopScreen: Failed to load config, showing all apps",a)}o(s,l,c)}},unmount:function(){if(t)try{t()}catch{}if(t=null,e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),Jt=(function(){let e=null,t=null,n=null,o=null;function i(){if(typeof o=="function")try{o()}catch{}if(n&&typeof n.unmount=="function")try{n.unmount()}catch{}o=null,n=null}return{mount:function(s){const l=s&&s.root,c=s&&s.nav,a=s&&s.apps,_=s&&s.appId;if(!l||!a)return;e=document.createElement("div"),e.className="wos-app-host",t=document.createElement("div"),t.className="wos-app-root",e.appendChild(t),l.replaceChildren(e);const g=a.get(_);if(!g){t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Oops!</div>
                    <div class="wos-app-placeholder-text">That app isnâ€™t here yet.</div>
                `;return}n=g;try{const y=g.mount({root:t,nav:c});o=typeof y=="function"?y:null}catch{t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Uh oh!</div>
                    <div class="wos-app-placeholder-text">This app had a little problem starting.</div>
                `,n=null,o=null}},unmount:function(){if(i(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null,t=null}}})(),Me={startup:Yt,desktop:Xt,app:Jt};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Screens=Me);let ge=!1,se=null,E=null,I=null,P=null,Te=null;function Zt(){return document.getElementById("winnieos-canvas")}function Qt(){const e=Zt();if(!e)return!1;const t=e.querySelector(".wos-html-fallback");if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch{}E=e.querySelector("#wos-shell"),E||(E=document.createElement("div"),E.id="wos-shell",e.appendChild(E));let n=E.querySelector("#wos-topbar");n||(n=document.createElement("div"),n.id="wos-topbar",E.appendChild(n));let o=E.querySelector("#wos-home-btn");return o||(o=document.createElement("button"),o.id="wos-home-btn",o.type="button",o.setAttribute("aria-label","Home"),o.innerHTML=`
            <svg class="wos-home-icon" aria-hidden="true" viewBox="0 0 24 24" focusable="false">
                <path fill="currentColor" d="M12 3.2 3 10.4v10.4h6.2v-6.2h5.6v6.2H21V10.4L12 3.2Zm7 15.6h-2.6v-6.2H7.6v6.2H5V11.4l7-5.6 7 5.6v7.4Z"/>
            </svg>
        `,o.addEventListener("click",()=>$.goHome()),n.appendChild(o)),I=E.querySelector("#wos-content"),I||(I=document.createElement("div"),I.id="wos-content",E.appendChild(I)),!0}function et(){if(P&&typeof P.unmount=="function")try{P.unmount()}catch{}P=null}async function He(e){if(!I||!E)return;const t=e&&e.screen?e.screen:"desktop";E.dataset.screen=t;const n=Me[t]||Me.desktop,o=t==="app"?`app:${String(e&&e.appId||"")}`:t;if(!(P===n&&Te===o)&&(et(),P=n,Te=o,P&&typeof P.mount=="function"))try{const i=P.mount({root:I,nav:$,apps:Ze,appId:e&&e.appId});i&&typeof i.then=="function"&&await i}catch(i){console.error("Shell: Error mounting screen",i)}}const ue={init:function(){ge||Qt()&&(ge=!0,$.init({initialState:{screen:"startup"}}),se=$.subscribe(He),He($.getState()))},_resetForTests:function(){if(se)try{se()}catch{}se=null,et(),ge=!1,E=null,I=null,Te=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Shell=ue);function $e(){!ue||typeof ue.init!="function"||ue.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",$e):$e();
