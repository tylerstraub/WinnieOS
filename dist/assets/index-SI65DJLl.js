(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))v(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const a of e.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&v(a)}).observe(document,{childList:!0,subtree:!0});function m(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function v(s){if(s.ep)return;s.ep=!0;const e=m(s);fetch(s.href,e)}})();const Dt="winnieos.";function Mt(){try{if(typeof window>"u"||!window.localStorage)return!1;const r="__storage_test__";return window.localStorage.setItem(r,"test"),window.localStorage.removeItem(r),!0}catch{return!1}}function Qt(r){if(!r||typeof r!="string")throw new Error("Storage key must be a non-empty string");return r.startsWith(Dt)?r:Dt+r}const je={get:function(r,p=null){if(!Mt())return p;try{const m=Qt(r),v=window.localStorage.getItem(m);if(v===null)return p;try{return JSON.parse(v)}catch{return v}}catch(m){if(m.message&&m.message.includes("Storage key must be"))throw m;return p}},set:function(r,p){if(!Mt())return!1;try{const m=Qt(r),v=JSON.stringify(p);return window.localStorage.setItem(m,v),!0}catch(m){if(m.message&&m.message.includes("Storage key must be"))throw m;return!1}},remove:function(r){if(!Mt())return!1;try{const p=Qt(r);return window.localStorage.removeItem(p),!0}catch(p){if(p.message&&p.message.includes("Storage key must be"))throw p;return!1}},has:function(r){if(!Mt())return!1;try{const p=Qt(r);return window.localStorage.getItem(p)!==null}catch(p){if(p.message&&p.message.includes("Storage key must be"))throw p;return!1}},clear:function(){if(!Mt())return!1;try{const r=[];for(let p=0;p<window.localStorage.length;p++){const m=window.localStorage.key(p);m&&m.startsWith(Dt)&&r.push(m)}return r.forEach(p=>window.localStorage.removeItem(p)),!0}catch{return!1}},keys:function(){if(!Mt())return[];try{const r=[];for(let p=0;p<window.localStorage.length;p++){const m=window.localStorage.key(p);m&&m.startsWith(Dt)&&r.push(m.substring(Dt.length))}return r}catch{return[]}}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Storage=je);const Nn="display.reference",li={width:1280,height:800};let Re=null;function jn(r){if(r==null)return null;const p=String(r).trim();if(!p)return null;const m=p.match(/^([0-9.]+)px$/i);if(!m)return null;const v=Number(m[1]);return Number.isFinite(v)?v:null}function cn(r,p,m){const v=Math.round(Number(r));return Number.isFinite(v)?Math.min(m,Math.max(p,v)):null}function ci(r){return!!r&&Number.isFinite(r.width)&&Number.isFinite(r.height)&&r.width>=320&&r.height>=240&&r.width<=7680&&r.height<=4320}function ui(){const r=document.documentElement,p=window.getComputedStyle(r),m=jn(p.getPropertyValue("--ref-width")),v=jn(p.getPropertyValue("--ref-height"));return Number.isFinite(m)&&Number.isFinite(v)&&m>0&&v>0?{width:Math.round(m),height:Math.round(v)}:null}function zi(){const r=je.get(Nn);if(!r||typeof r!="object")return null;const p=cn(r.width,320,7680),m=cn(r.height,240,4320),v={width:p,height:m};return ci(v)?v:null}function Ui(r){je.set(Nn,r)}function Gi(){je.remove(Nn)}function Tn(r){const p=document.documentElement;p.style.setProperty("--ref-width",r.width+"px"),p.style.setProperty("--ref-height",r.height+"px"),p.style.setProperty("--ref-aspect-ratio",String(r.width/r.height)),p.dataset.refWidth=String(r.width),p.dataset.refHeight=String(r.height)}function Mn(r){try{const p=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:r.width,height:r.height}}});document.dispatchEvent(p)}catch{}}function bn(){Re||(Re=zi()||ui()||li,Tn(Re))}const Je={init:function(){bn(),Mn(Re)},getReferenceSize:function(){return bn(),{width:Re.width,height:Re.height}},setReferenceSize:function(r){bn();const p=cn(r&&r.width,320,7680),m=cn(r&&r.height,240,4320),v={width:p,height:m};return ci(v)?(Re=v,Tn(Re),(!r||r.persist!==!1)&&Ui(Re),Mn(Re),!0):!1},resetReferenceSize:function(){Re=ui()||li,Gi(),Tn(Re),Mn(Re)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=Je);let on=null,Pt=null,Xt=!1,ut=null;function rn(){return on||(on=document.getElementById("winnieos-canvas")),on}function An(){if(Je&&typeof Je.getReferenceSize=="function"){const v=Je.getReferenceSize();if(v&&Number.isFinite(v.width)&&Number.isFinite(v.height)&&v.width>0&&v.height>0)return{width:v.width,height:v.height}}const r=window.getComputedStyle(document.documentElement),p=parseFloat(r.getPropertyValue("--ref-width")),m=parseFloat(r.getPropertyValue("--ref-height"));return Number.isFinite(p)&&Number.isFinite(m)&&p>0&&m>0?{width:Math.round(p),height:Math.round(m)}:{width:1280,height:800}}function fi(){const r=window.visualViewport;return r&&typeof r.width=="number"&&typeof r.height=="number"?{width:r.width,height:r.height,offsetLeft:r.offsetLeft||0,offsetTop:r.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function ji(){const r=rn();if(!r)return;const p=An(),m=p.width,v=p.height,s=fi(),e=s.width,a=s.height,i=Math.min(e/m,a/v),n=m*i,d=v*i,o=Math.round(s.offsetLeft+(e-n)/2),f=Math.round(s.offsetTop+(a-d)/2);r.style.position="fixed",r.style.width=m+"px",r.style.height=v+"px",r.style.left=o+"px",r.style.top=f+"px",r.style.margin="0",r.style.padding="0",r.style.transformOrigin="top left";const u=String(pi(i));r.style.transform=`scale(${u})`,r.dataset.scale=u,r.dataset.vw=String(Math.round(e)),r.dataset.vh=String(Math.round(a)),r.dataset.left=String(o),r.dataset.top=String(f),document.documentElement.style.setProperty("--viewport-scale",u)}function qe(){Pt||(Pt=window.requestAnimationFrame(function(){Pt=null,ji()}))}function pi(r){return Math.round(r*1e5)/1e5}const Be={init:function(){Xt||rn()&&(Xt=!0,qe(),window.addEventListener("resize",qe),document.addEventListener("winnieos:displaychange",qe),window.visualViewport&&(ut=window.visualViewport,ut.addEventListener("resize",qe),ut.addEventListener("scroll",qe)))},getScale:function(){const r=rn();return r?parseFloat(r.dataset.scale||"1"):1},getReferenceSize:function(){return An()},getMetrics:function(){const r=An(),p=fi(),m=rn(),v=m?parseFloat(m.dataset.scale||"1"):pi(Math.min(p.width/r.width,p.height/r.height));return{reference:{width:r.width,height:r.height},viewport:{width:p.width,height:p.height,offsetLeft:p.offsetLeft||0,offsetTop:p.offsetTop||0},scale:v}},refresh:function(){qe()},_resetForTests:function(){if(Xt&&(window.removeEventListener("resize",qe),document.removeEventListener("winnieos:displaychange",qe),ut&&(ut.removeEventListener("resize",qe),ut.removeEventListener("scroll",qe))),Pt&&typeof window.cancelAnimationFrame=="function")try{window.cancelAnimationFrame(Pt)}catch{}Xt=!1,Pt=null,on=null,ut=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=Be);let Jt=!1,It=null;function Kn(r){return r.preventDefault(),!1}function qn(r){if(r.key==="F5"||r.ctrlKey&&(r.key==="r"||r.key==="R")||r.altKey&&(r.key==="ArrowLeft"||r.key==="ArrowRight")||r.key==="Backspace"&&r.target.tagName!=="INPUT"&&r.target.tagName!=="TEXTAREA"&&!r.target.isContentEditable||r.ctrlKey&&(r.key==="w"||r.key==="W"))return r.preventDefault(),!1}function Yn(r){if(r.button===1)return r.preventDefault(),!1}function Ki(r){return r.preventDefault(),!1}const En={init:function(){Jt||(Jt=!0,document.addEventListener("contextmenu",Kn),document.addEventListener("keydown",qn),document.addEventListener("mousedown",Yn),It=Ki,document.addEventListener("dragstart",It))},_resetForTests:function(){Jt&&(document.removeEventListener("contextmenu",Kn),document.removeEventListener("keydown",qn),document.removeEventListener("mousedown",Yn),It&&document.removeEventListener("dragstart",It)),Jt=!1,It=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=En);let kt=null,bt=null;function qi(r){return new Promise(p=>setTimeout(p,r))}async function Yi(r,p){const m=typeof AbortController<"u"?new AbortController:null,v=m?setTimeout(()=>m.abort(),p):null;try{const s=await fetch(r,{cache:"no-store",signal:m?m.signal:void 0});return s.ok?await s.json():null}catch{return null}finally{v&&clearTimeout(v)}}const Ze={load:async function(){return kt||bt||(bt=(async()=>{const r=[{timeoutMs:1500,sleepMs:250},{timeoutMs:1500,sleepMs:250},{timeoutMs:2e3,sleepMs:500},{timeoutMs:2500,sleepMs:750}];let p=null;for(let m=0;m<r.length;m++){const v=r[m];if(p=await Yi("/winnieos-config.json",v.timeoutMs),p&&typeof p=="object")break;v.sleepMs&&await qi(v.sleepMs)}return kt=p&&typeof p=="object"?p:null,bt=null,kt})(),bt)},clearCache:function(){kt=null,bt=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Config=Ze);const di="preferences.backgroundColor",Qi="#667eea",Xi="#764ba2";function hi(r,p,m){const v=s=>{const e=Math.round(Math.max(0,Math.min(255,s))).toString(16);return e.length===1?"0"+e:e};return`#${v(r)}${v(p)}${v(m)}`}function mi(r){if(!r||typeof r!="string")return{r:0,g:0,b:0};let p=r.replace("#","").trim();if(p.length===3&&(p=p.split("").map(e=>e+e).join("")),p.length!==6||!/^[0-9a-fA-F]{6}$/.test(p))return{r:0,g:0,b:0};const m=parseInt(p.substring(0,2),16),v=parseInt(p.substring(2,4),16),s=parseInt(p.substring(4,6),16);return!Number.isFinite(m)||!Number.isFinite(v)||!Number.isFinite(s)?{r:0,g:0,b:0}:{r:m,g:v,b:s}}function gi(r){const p=mi(r),m=p.r/255,v=p.g/255,s=p.b/255,e=Math.max(m,v,s),a=Math.min(m,v,s),i=e-a;let n=0;i!==0&&(e===m?n=(v-s)/i%6:e===v?n=(s-m)/i+2:n=(m-v)/i+4),n=Math.round(n*60),n<0&&(n+=360),n=(n+30)%360;const d=(e+a)/2,o=i===0?0:i/(1-Math.abs(2*d-1)),f=(1-Math.abs(2*d-1))*o,u=f*(1-Math.abs(n/60%2-1)),t=d-f/2;let c=0,l=0,h=0;return n<60?(c=f,l=u,h=0):n<120?(c=u,l=f,h=0):n<180?(c=0,l=f,h=u):n<240?(c=0,l=u,h=f):n<300?(c=u,l=0,h=f):(c=f,l=0,h=u),hi(Math.round((c+t)*255),Math.round((l+t)*255),Math.round((h+t)*255))}function Bn(r,p=null){if(!r||typeof r!="string")return;const m=p||gi(r),v=document.body,s=document.getElementById("winnieos-canvas");v&&v.style.setProperty("background",r),s&&s.style.setProperty("background",`linear-gradient(135deg, ${r} 0%, ${m} 100%)`)}function vi(){return je.get(di,null)}function Ji(r){return!r||typeof r!="string"?!1:je.set(di,r)}function Zi(){const r=vi();r?Bn(r):Bn(Qi,Xi)}const Qe={apply:Bn,getSaved:vi,save:Ji,load:Zi,rgbToHex:hi,hexToRgb:mi,generateSecondary:gi};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Background=Qe);const _i="display.reference";function eo(){return je.has(_i)}function to(r){const p=r&&r.display&&r.display.reference;if(!p||!Number.isFinite(p.width)||!Number.isFinite(p.height)||p.width<=0||p.height<=0||eo())return;if(Je&&typeof Je.setReferenceSize=="function"){Je.setReferenceSize({width:p.width,height:p.height,persist:!1});return}const m=document.documentElement;m.style.setProperty("--ref-width",`${Math.round(p.width)}px`),m.style.setProperty("--ref-height",`${Math.round(p.height)}px`),m.style.setProperty("--ref-aspect-ratio",String(p.width/p.height))}function Qn(){const r=Ze&&typeof Ze.load=="function"?Ze.load():Promise.resolve(null);Je?Je.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),Be?Be.init():console.error("WinnieOS: Viewport module failed to load"),En?En.init():console.error("WinnieOS: Kiosk module failed to load"),Qe&&typeof Qe.load=="function"&&Qe.load(),r.then(to).catch(()=>{})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Qn):Qn();let Ge=null,Y=null,Nt=null,ot=null,Ot=null,Ln=!1,Ft=1;const In=-24,yi=18,Xn=new Map,no={tick:.06,plink:.03,pop:.08,buzz:.1,thud:.05,launch:.12,bounce:.02,reward:.2,poof:.18,ready:.3,binBounce:.03,scoreTick:.09,star:.35};function io(){return Ge?Ge.currentTime:0}function oo(r,p,m){const v=Number(r);return Number.isFinite(v)?Math.max(p,Math.min(m,v)):p}function Pe(r){const p=Number(r);return Number.isFinite(p)?Math.max(0,Math.min(1,p)):0}function ro(r){return Number.isFinite(r)?Math.pow(10,r/20):0}function xi(r){const p=Pe(r),m=Math.pow(p,1.35);return In+(yi-In)*m}function kn(r,{immediate:p=!1}={}){const m=pe();if(!m||!Nt)return;const v=m.currentTime,s=Nt.gain,e=ro(r);s.cancelScheduledValues(v),p?s.setValueAtTime(e,v):s.setTargetAtTime(e,v,.03)}function Ve(r){const p=io(),m=no[r]||0,v=Xn.get(r)||-1/0;return p-v<m?!1:(Xn.set(r,p),!0)}function pe(){if(Ge)return Ge;const r=window.AudioContext||window.webkitAudioContext;if(!r)return null;Ge=new r({latencyHint:"interactive"}),Y=Ge.createGain(),Y.gain.value=1,ot=Ge.createDynamicsCompressor(),ot.threshold.value=-6,ot.knee.value=0,ot.ratio.value=20,ot.attack.value=.002,ot.release.value=.1,Nt=Ge.createGain(),kn(xi(Ft),{immediate:!0}),Ot=Ge.createWaveShaper(),Ot.oversample="4x";const p=2048,m=new Float32Array(p);for(let v=0;v<p;v++){const s=v*2/(p-1)-1;m[v]=Math.tanh(1.35*s)}return Ot.curve=m,Y.connect(Nt),Nt.connect(ot),ot.connect(Ot),Ot.connect(Ge.destination),Ge}async function so(){const r=pe();if(!r)return!1;if(Ln)return!0;try{r.state==="suspended"&&await r.resume();const p=r.currentTime,m=r.createOscillator(),v=r.createGain();return v.gain.setValueAtTime(1e-5,p),m.frequency.setValueAtTime(440,p),m.connect(v),v.connect(Y),m.start(p),m.stop(p+.01),Ln=!0,!0}catch{return!1}}function we(r,p,m,v,s,e){const a=r.gain;a.cancelScheduledValues(p),a.setValueAtTime(Math.max(0,e),p),a.linearRampToValueAtTime(Math.max(0,s),p+m),a.exponentialRampToValueAtTime(Math.max(1e-5,e),p+m+v)}function fn(r){const p=pe();if(!p)return null;const m=p.sampleRate,v=Math.max(1,Math.floor(r*m)),s=p.createBuffer(1,v,m),e=s.getChannelData(0);for(let a=0;a<v;a++)e[a]=Math.random()*2-1;return s}function _e(r,p,{gainPeak:m=.02,gainFloor:v=1e-5,hpHz:s=1800,bpHz:e=null,bpQ:a=1}={}){const i=pe();if(!i||!Y)return;const n=fn(p);if(!n)return;const d=i.createBufferSource();d.buffer=n;const o=i.createGain();if(we(o,r,.001,Math.max(.02,p),m,v),e&&Number.isFinite(e)){const f=i.createBiquadFilter();f.type="bandpass",f.frequency.setValueAtTime(e,r),f.Q.setValueAtTime(a,r),d.connect(f),f.connect(o)}else{const f=i.createBiquadFilter();f.type="highpass",f.frequency.setValueAtTime(s,r),d.connect(f),f.connect(o)}o.connect(Y),d.start(r),d.stop(r+p+.02)}function ao(r=.8){const p=pe();if(!p||!Y||!Ve("launch"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createGain(),a=p.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(1400+1e3*m,v),s.type="sawtooth";const i=220+120*m,n=720+260*m;s.frequency.setValueAtTime(i,v),s.frequency.exponentialRampToValueAtTime(n,v+.12),we(e,v,.003,.16,.11*(.65+.35*m),1e-5),s.connect(a),a.connect(e),e.connect(Y),s.start(v),s.stop(v+.18),_e(v,.06,{gainPeak:.01+.014*m,bpHz:2600+900*m,bpQ:.9})}function lo(r=.4,p="peg"){const m=pe();if(!m||!Y||!Ve("bounce"))return;const v=Pe(r),s=m.currentTime,e=m.createOscillator(),a=m.createGain(),i=m.createBiquadFilter();i.type="bandpass",i.Q.setValueAtTime(.9+.6*v,s),i.frequency.setValueAtTime((p==="wall"?520:p==="bin"?380:760)+520*v,s),e.type=p==="wall"||p==="bin"?"sine":"triangle";const n=(p==="wall"?220:p==="bin"?160:360)+520*v;e.frequency.setValueAtTime(n,s),e.frequency.exponentialRampToValueAtTime(Math.max(60,n*.92),s+.08),we(a,s,.001,p==="wall"?.1:p==="bin"?.13:.07,.06*(.25+.75*v),1e-5),e.connect(i),i.connect(a),a.connect(Y),e.start(s),e.stop(s+.11),v>.35&&_e(s,.03,{gainPeak:(p==="bin"?.006:.004)+.01*v,hpHz:(p==="bin"?2200:3200)+900*v})}function co(r=.4){const p=pe();if(!p||!Y||!Ve("binBounce"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createGain(),a=p.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(900+500*m,v),s.type="sine";const i=130+110*m;s.frequency.setValueAtTime(i,v),s.frequency.exponentialRampToValueAtTime(Math.max(60,i*.82),v+.14),we(e,v,.001,.16,.07*(.25+.75*m),1e-5),s.connect(a),a.connect(e),e.connect(Y),s.start(v),s.stop(v+.2),_e(v,.06,{gainPeak:.004+.008*m,bpHz:720+220*m,bpQ:.9})}function uo(r=.6,p=180){const m=pe();if(!m||!Y)return;const v=Pe(r),s=m.currentTime,e=m.createOscillator(),a=m.createGain(),i=m.createBiquadFilter();i.type="lowpass",i.frequency.setValueAtTime(800+900*v,s),e.type="sine";const n=Math.max(80,p);e.frequency.setValueAtTime(n,s),e.frequency.exponentialRampToValueAtTime(Math.max(60,n*.76),s+.12),we(a,s,.001,.14,.09*(.35+.65*v),1e-5),e.connect(i),i.connect(a),a.connect(Y),e.start(s),e.stop(s+.18),_e(s,.025,{gainPeak:.003+.006*v,hpHz:2800+700*v})}function fo(r=2e3,p=.6){const m=pe();if(!m)return function(){};const v=Pe(p),s=m.currentTime,e=s+Math.max(.2,r/1e3);let a=!1;const i=new Set,n=()=>{if(a)return;const d=m.currentTime;if(d>=e)return;const o=Pe((d-s)/Math.max(1e-4,e-s)),f=(1-o)*.16+.05,u=150+120*o;uo(.45+.45*v,u);const t=setTimeout(()=>{i.delete(t),n()},Math.round(f*1e3));i.add(t)};return n(),function(){a=!0;for(const o of Array.from(i))try{clearTimeout(o)}catch{}i.clear()}}function po(r="blue",p=.8){const m=pe();if(!m||!Y||!Ve("reward"))return;const v=Pe(p),s=m.currentTime,e={red:{f:520,type:"square",sparkle:3200},orange:{f:460,type:"sawtooth",sparkle:3e3},yellow:{f:600,type:"triangle",sparkle:3600},green:{f:420,type:"triangle",sparkle:2600},blue:{f:560,type:"sine",sparkle:2400},purple:{f:480,type:"sawtooth",sparkle:2800}},a=e[String(r||"").toLowerCase()]||e.blue,i=m.createOscillator(),n=m.createOscillator(),d=m.createGain(),o=m.createBiquadFilter();o.type="lowpass",o.frequency.setValueAtTime(1400+1100*v,s),i.type=a.type,n.type="sine",i.frequency.setValueAtTime(a.f,s),n.frequency.setValueAtTime(a.f*1.18,s),we(d,s,.003,.2,.14*(.55+.45*v),1e-5),i.connect(o),n.connect(o),o.connect(d),d.connect(Y),i.start(s),n.start(s),i.stop(s+.24),n.stop(s+.24),_e(s,.08,{gainPeak:.008+.014*v,bpHz:a.sparkle,bpQ:.8})}function ho(r=.6){const p=pe();if(!p||!Y||!Ve("poof"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createGain(),a=p.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(600+300*m,v),s.type="sine";const i=160+40*m;s.frequency.setValueAtTime(i,v),s.frequency.exponentialRampToValueAtTime(Math.max(60,i*.72),v+.14),we(e,v,.002,.16,.07*(.5+.5*m),1e-5),s.connect(a),a.connect(e),e.connect(Y),s.start(v),s.stop(v+.2),_e(v,.1,{gainPeak:.01+.012*m,bpHz:420+120*m,bpQ:.7})}function mo(r=.6){const p=pe();if(!p||!Y||!Ve("ready"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createOscillator(),a=p.createGain(),i=p.createBiquadFilter();i.type="lowpass",i.frequency.setValueAtTime(1800+1200*m,v),s.type="triangle",e.type="sine";const n=520+120*m;s.frequency.setValueAtTime(n,v),s.frequency.exponentialRampToValueAtTime(n*1.6,v+.16),e.frequency.setValueAtTime(n*2,v+.02),we(a,v,.003,.18,.11*(.55+.45*m),1e-5),s.connect(i),e.connect(i),i.connect(a),a.connect(Y),s.start(v),e.start(v),s.stop(v+.22),e.stop(v+.22),_e(v+.03,.07,{gainPeak:.007+.01*m,bpHz:3100+700*m,bpQ:.9})}function go(){const r=pe();if(!r||!Y||!Ve("tick"))return;const p=r.currentTime,m=r.createOscillator(),v=r.createGain();m.type="sine",m.frequency.setValueAtTime(920,p),we(v,p,.001,.03,.015,1e-5),m.connect(v),v.connect(Y),m.start(p),m.stop(p+.04)}function vo(r=.6){const p=pe();if(!p||!Y||!Ve("pop"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createOscillator(),a=p.createGain(),i=520;s.type="triangle",e.type="sine",s.frequency.setValueAtTime(i,v),e.frequency.setValueAtTime(i*1.24,v),we(a,v,.002,.09,.1*(.6+.4*m),1e-5),s.connect(a),e.connect(a),a.connect(Y),s.start(v),e.start(v),s.stop(v+.12),e.stop(v+.12);const n=fn(.06);if(n){const d=p.createBufferSource();d.buffer=n;const o=p.createGain(),f=p.createBiquadFilter();f.type="highpass",f.frequency.setValueAtTime(2600,v),we(o,v,.001,.06,.018*(.6+.4*m),1e-5),d.connect(f),f.connect(o),o.connect(Y),d.start(v),d.stop(v+.07)}}function yo(r=.7){const p=pe();if(!p||!Y||!Ve("buzz"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createGain(),a=p.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(1400+600*m,v),s.type="square",s.frequency.setValueAtTime(155+25*m,v);const i=p.createOscillator(),n=p.createGain();i.type="sine",i.frequency.setValueAtTime(16,v),n.gain.setValueAtTime(10+8*m,v),i.connect(n),n.connect(s.frequency),we(e,v,.004,.12,.085*(.6+.4*m),1e-5),s.connect(a),a.connect(e),e.connect(Y),s.start(v),i.start(v),s.stop(v+.15),i.stop(v+.15);const d=fn(.09);if(d){const o=p.createBufferSource();o.buffer=d;const f=p.createBiquadFilter();f.type="bandpass",f.frequency.setValueAtTime(520,v),f.Q.setValueAtTime(1.2,v);const u=p.createGain();we(u,v,.002,.1,.028*(.55+.45*m),1e-5),o.connect(f),f.connect(u),u.connect(Y),o.start(v),o.stop(v+.11)}}function xo(r=.4){const p=pe();if(!p||!Y||!Ve("plink"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createGain(),a=p.createBiquadFilter();a.type="highpass",a.frequency.setValueAtTime(220+1800*m,v),s.type="triangle";const i=420+260*m,n=(Math.random()*2-1)*16;s.frequency.setValueAtTime(i,v),s.detune.setValueAtTime(n,v),we(e,v,.001,.07,.07*(.35+.65*m),1e-5),s.connect(a),a.connect(e),e.connect(Y),s.start(v),s.stop(v+.09);const d=fn(.04);if(d){const o=p.createBufferSource();o.buffer=d;const f=p.createBiquadFilter();f.type="highpass",f.frequency.setValueAtTime(3e3,v);const u=p.createGain();we(u,v,.001,.04,.012*(.3+.7*m),1e-5),o.connect(f),f.connect(u),u.connect(Y),o.start(v),o.stop(v+.05)}}function wo(r=.7){const p=pe();if(!p||!Y||!Ve("scoreTick"))return;const m=Pe(r),v=p.currentTime,s=p.createOscillator(),e=p.createGain(),a=p.createBiquadFilter();a.type="bandpass",a.Q.setValueAtTime(1.1+.6*m,v),a.frequency.setValueAtTime(980+520*m,v),s.type="sine",s.frequency.setValueAtTime(820+460*m,v),s.frequency.exponentialRampToValueAtTime(1200+700*m,v+.04),we(e,v,.001,.07,.06*(.55+.45*m),1e-5),s.connect(a),a.connect(e),e.connect(Y),s.start(v),s.stop(v+.09),m>.35&&_e(v,.03,{gainPeak:.003+.004*m,hpHz:4200+900*m})}function So(r=.9){const p=pe();if(!p||!Y||!Ve("star"))return;const m=Pe(r),v=p.currentTime,s=[660,880+40*m,1175+80*m];for(let e=0;e<s.length;e++){const a=p.createOscillator(),i=p.createGain(),n=v+e*.045;a.type="triangle",a.frequency.setValueAtTime(s[e],n),we(i,n,.001,.11,.05*(.65+.35*m),1e-5),a.connect(i),i.connect(Y),a.start(n),a.stop(n+.13)}_e(v+.02,.12,{gainPeak:.006+.01*m,gainFloor:1e-5,hpHz:2500,bpHz:4200+800*m,bpQ:.9})}const se={ensure:function(){return!!pe()},unlock:function(){return so()},isUnlocked:function(){return Ln},setMasterLevel:function(r,p){return Ft=Pe(r),kn(xi(Ft),p||{}),Ft},getMasterLevel:function(){return Ft},setMasterDb:function(r,p){const m=oo(r,In,yi);return kn(m,p||{}),m},tick:function(){go()},pop:function(r){vo(r)},buzz:function(r){yo(r)},plink:function(r){xo(r)},launch:function(r){ao(r)},bounce:function(r,p){lo(r,p)},binBounce:function(r){co(r)},reward:function(r,p){po(r,p)},scoreTick:function(r){wo(r)},star:function(r){So(r)},poof:function(r){ho(r)},ready:function(r){mo(r)},drumroll:function(r,p){return fo(r,p)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Audio=se);typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils);const Mo={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=Mo);const bo={id:"animals",title:"Animals",iconEmoji:"ðŸ¦",sortOrder:25,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Animals</div>
            <div class="wos-app-placeholder-text">Animal sounds and matching will live here.</div>
        `)},unmount:function(){}},Co=Object.freeze(Object.defineProperty({__proto__:null,default:bo},Symbol.toStringTag,{value:"Module"})),Po={id:"blocks",title:"Blocks",iconEmoji:"ðŸ§±",sortOrder:15,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Blocks</div>
            <div class="wos-app-placeholder-text">A building blocks game will live here.</div>
        `)},unmount:function(){}},To=Object.freeze(Object.defineProperty({__proto__:null,default:Po},Symbol.toStringTag,{value:"Module"})),Ao={id:"bubbles",title:"Bubbles",iconEmoji:"ðŸ«§",sortOrder:20,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Bubbles</div>
            <div class="wos-app-placeholder-text">Pop pop pop!</div>
        `)},unmount:function(){}},Eo=Object.freeze(Object.defineProperty({__proto__:null,default:Ao},Symbol.toStringTag,{value:"Module"})),Bo={id:"colors",title:"Colors",iconEmoji:"ðŸŒˆ",sortOrder:30,mount:function({root:r}){if(!r)return;r.className="wos-colors-app",r.innerHTML="";const p=document.createElement("div");p.className="wos-colors-container";const m=document.createElement("div");m.className="wos-colors-picker",m.setAttribute("role","application"),m.setAttribute("aria-label","Color picker");const v=document.createElement("canvas");v.className="wos-colors-canvas";const s=.35,e=.95;let a=0;const i=S=>Math.max(0,Math.min(1,S)),n=(S,M,A)=>{S=S%360,S<0&&(S+=360);const P=A*M,L=P*(1-Math.abs(S/60%2-1)),k=A-P;let I=0,R=0,O=0;return S<60?(I=P,R=L,O=0):S<120?(I=L,R=P,O=0):S<180?(I=0,R=P,O=L):S<240?(I=0,R=L,O=P):S<300?(I=L,R=0,O=P):(I=P,R=0,O=L),{r:Math.round((I+k)*255),g:Math.round((R+k)*255),b:Math.round((O+k)*255)}},d=(S,M,A)=>{S=S/255,M=M/255,A=A/255;const P=Math.max(S,M,A),L=Math.min(S,M,A),k=P-L;let I=0;k!==0&&(P===S?I=(M-A)/k%6:P===M?I=(A-S)/k+2:I=(S-M)/k+4),I=Math.round(I*60),I<0&&(I+=360);const R=P===0?0:k/P;return{h:I,s:R,v:P}},o=()=>{const S=m.getBoundingClientRect(),M=Math.max(1,S.width),A=Math.max(1,S.height),P=M/2,L=A/2,k=Math.min(P,L);return{rect:S,width:M,height:A,cx:P,cy:L,radius:k}},f=S=>s+(1-s)*i(S),u=S=>i((S-s)/(1-s)),t=(S,M)=>{const{rect:A,width:P,height:L,cx:k,cy:I,radius:R}=o(),O=S-A.left,V=M-A.top,N=O-k,K=V-I,J=Math.sqrt(N*N+K*K),Z=Math.min(R,J),_=Math.atan2(K,N),Se=J<1?a:(_*180/Math.PI+360)%360,de=R<=0?0:Z/R;return{width:P,height:L,cx:k,cy:I,radius:R,dx:N,dy:K,distance:J,distClamped:Z,angle:_,hue:Se,t:de}},c=({hue:S,t:M})=>{const A=f(M),P=n(S,A,e);return Qe.rgbToHex(P.r,P.g,P.b)},l=document.createElement("div");l.className="wos-colors-indicator",l.setAttribute("aria-hidden","true");const h=({cx:S,cy:M,radius:A,angle:P,distClamped:L,width:k,height:I})=>{const R=S+Math.cos(P)*L,O=M+Math.sin(P)*L;l.style.left=`${R/k*100}%`,l.style.top=`${O/I*100}%`},w=()=>{const S=Qe.getSaved(),{width:M,height:A,cx:P,cy:L,radius:k}=o();if(!S||k<=0){l.style.left="50%",l.style.top="50%";return}const I=Qe.hexToRgb(S),R=d(I.r,I.g,I.b);a=R.h;const O=u(R.s),V=R.h*Math.PI/180,N=O*k,K=P+Math.cos(V)*N,J=L+Math.sin(V)*N;l.style.left=`${K/M*100}%`,l.style.top=`${J/A*100}%`},C=()=>{const S=m.getBoundingClientRect(),M=window.devicePixelRatio||1,A=Math.max(1,Math.floor(S.width)),P=Math.max(1,Math.floor(S.height)),L=Math.max(1,Math.floor(A*M)),k=Math.max(1,Math.floor(P*M));v.width=L,v.height=k;const I=v.getContext("2d");if(!I)return;const R=I.createImageData(L,k),O=R.data,V=L/2,N=k/2,K=Math.min(V,N);for(let J=0;J<k;J++)for(let Z=0;Z<L;Z++){const _=Z-V,Se=J-N,de=Math.sqrt(_*_+Se*Se),G=(J*L+Z)*4;if(de>K){O[G+3]=0;continue}const le=(Math.atan2(Se,_)*180/Math.PI+360)%360,Ye=K<=0?0:de/K,Ie=f(Ye),Me=n(le,Ie,e);O[G]=Me.r,O[G+1]=Me.g,O[G+2]=Me.b,O[G+3]=255}I.putImageData(R,0,0)};m.appendChild(v),m.appendChild(l),p.appendChild(m),r.appendChild(p),requestAnimationFrame(()=>{C(),w()});const T=new ResizeObserver(()=>{C(),w()});T.observe(m);let E=null;const g=(S,M)=>{const A=t(S,M);a=A.hue,h(A);const P=c(A);l.classList.add("wos-colors-indicator-active"),setTimeout(()=>{l.classList.remove("wos-colors-indicator-active")},180),Qe.apply(P),Qe.save(P)},x=S=>{if(E===null){E=S.pointerId;try{m.setPointerCapture(E)}catch{}S.preventDefault(),g(S.clientX,S.clientY)}},b=S=>{E===null||S.pointerId!==E||(S.preventDefault(),g(S.clientX,S.clientY))},y=S=>{if(!(E===null||S.pointerId!==E)){S.preventDefault();try{m.releasePointerCapture(E)}catch{}E=null}};return m.addEventListener("pointerdown",x),m.addEventListener("pointermove",b),m.addEventListener("pointerup",y),m.addEventListener("pointercancel",y),function(){try{T.disconnect()}catch{}m.removeEventListener("pointerdown",x),m.removeEventListener("pointermove",b),m.removeEventListener("pointerup",y),m.removeEventListener("pointercancel",y)}},unmount:function(){}},Lo=Object.freeze(Object.defineProperty({__proto__:null,default:Bo},Symbol.toStringTag,{value:"Module"})),Io={id:"dance",title:"Dance",iconEmoji:"ðŸ’ƒ",sortOrder:55,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Dance</div>
            <div class="wos-app-placeholder-text">A dance party will live here.</div>
        `)},unmount:function(){}},ko=Object.freeze(Object.defineProperty({__proto__:null,default:Io},Symbol.toStringTag,{value:"Module"})),Oo={id:"garden",title:"Garden",iconEmoji:"ðŸŒ»",sortOrder:60,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Garden</div>
            <div class="wos-app-placeholder-text">Plant and grow little flowers.</div>
        `)},unmount:function(){}},Ro=Object.freeze(Object.defineProperty({__proto__:null,default:Oo},Symbol.toStringTag,{value:"Module"}));var Jn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var sn={exports:{}};var Do=sn.exports,Zn;function No(){return Zn||(Zn=1,(function(r,p){(function(v,s){r.exports=s()})(Do,function(){return(function(m){var v={};function s(e){if(v[e])return v[e].exports;var a=v[e]={i:e,l:!1,exports:{}};return m[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=m,s.c=v,s.d=function(e,a,i){s.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:i})},s.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,a){if(a&1&&(e=s(e)),a&8||a&4&&typeof e=="object"&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),a&2&&typeof e!="string")for(var n in e)s.d(i,n,(function(d){return e[d]}).bind(null,n));return i},s.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(a,"a",a),a},s.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},s.p="",s(s.s=20)})([(function(m,v){var s={};m.exports=s,(function(){s._baseDelta=1e3/60,s._nextId=0,s._seed=0,s._nowStartTime=+new Date,s._warnedOnce={},s._decomp=null,s.extend=function(a,i){var n,d;typeof i=="boolean"?(n=2,d=i):(n=1,d=!0);for(var o=n;o<arguments.length;o++){var f=arguments[o];if(f)for(var u in f)d&&f[u]&&f[u].constructor===Object&&(!a[u]||a[u].constructor===Object)?(a[u]=a[u]||{},s.extend(a[u],d,f[u])):a[u]=f[u]}return a},s.clone=function(a,i){return s.extend({},i,a)},s.keys=function(a){if(Object.keys)return Object.keys(a);var i=[];for(var n in a)i.push(n);return i},s.values=function(a){var i=[];if(Object.keys){for(var n=Object.keys(a),d=0;d<n.length;d++)i.push(a[n[d]]);return i}for(var o in a)i.push(a[o]);return i},s.get=function(a,i,n,d){i=i.split(".").slice(n,d);for(var o=0;o<i.length;o+=1)a=a[i[o]];return a},s.set=function(a,i,n,d,o){var f=i.split(".").slice(d,o);return s.get(a,i,0,-1)[f[f.length-1]]=n,n},s.shuffle=function(a){for(var i=a.length-1;i>0;i--){var n=Math.floor(s.random()*(i+1)),d=a[i];a[i]=a[n],a[n]=d}return a},s.choose=function(a){return a[Math.floor(s.random()*a.length)]},s.isElement=function(a){return typeof HTMLElement<"u"?a instanceof HTMLElement:!!(a&&a.nodeType&&a.nodeName)},s.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"},s.isFunction=function(a){return typeof a=="function"},s.isPlainObject=function(a){return typeof a=="object"&&a.constructor===Object},s.isString=function(a){return toString.call(a)==="[object String]"},s.clamp=function(a,i,n){return a<i?i:a>n?n:a},s.sign=function(a){return a<0?-1:1},s.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-s._nowStartTime},s.random=function(a,i){return a=typeof a<"u"?a:0,i=typeof i<"u"?i:1,a+e()*(i-a)};var e=function(){return s._seed=(s._seed*9301+49297)%233280,s._seed/233280};s.colorToNumber=function(a){return a=a.replace("#",""),a.length==3&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)),parseInt(a,16)},s.logLevel=1,s.log=function(){console&&s.logLevel>0&&s.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},s.info=function(){console&&s.logLevel>0&&s.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},s.warn=function(){console&&s.logLevel>0&&s.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},s.warnOnce=function(){var a=Array.prototype.slice.call(arguments).join(" ");s._warnedOnce[a]||(s.warn(a),s._warnedOnce[a]=!0)},s.deprecated=function(a,i,n){a[i]=s.chain(function(){s.warnOnce("ðŸ”… deprecated ðŸ”…",n)},a[i])},s.nextId=function(){return s._nextId++},s.indexOf=function(a,i){if(a.indexOf)return a.indexOf(i);for(var n=0;n<a.length;n++)if(a[n]===i)return n;return-1},s.map=function(a,i){if(a.map)return a.map(i);for(var n=[],d=0;d<a.length;d+=1)n.push(i(a[d]));return n},s.topologicalSort=function(a){var i=[],n=[],d=[];for(var o in a)!n[o]&&!d[o]&&s._topologicalSort(o,n,d,a,i);return i},s._topologicalSort=function(a,i,n,d,o){var f=d[a]||[];n[a]=!0;for(var u=0;u<f.length;u+=1){var t=f[u];n[t]||i[t]||s._topologicalSort(t,i,n,d,o)}n[a]=!1,i[a]=!0,o.push(a)},s.chain=function(){for(var a=[],i=0;i<arguments.length;i+=1){var n=arguments[i];n._chained?a.push.apply(a,n._chained):a.push(n)}var d=function(){for(var o,f=new Array(arguments.length),u=0,t=arguments.length;u<t;u++)f[u]=arguments[u];for(u=0;u<a.length;u+=1){var c=a[u].apply(o,f);typeof c<"u"&&(o=c)}return o};return d._chained=a,d},s.chainPathBefore=function(a,i,n){return s.set(a,i,s.chain(n,s.get(a,i)))},s.chainPathAfter=function(a,i,n){return s.set(a,i,s.chain(s.get(a,i),n))},s.setDecomp=function(a){s._decomp=a},s.getDecomp=function(){var a=s._decomp;try{!a&&typeof window<"u"&&(a=window.decomp),!a&&typeof Jn<"u"&&(a=Jn.decomp)}catch{a=null}return a}})()}),(function(m,v){var s={};m.exports=s,(function(){s.create=function(e){var a={min:{x:0,y:0},max:{x:0,y:0}};return e&&s.update(a,e),a},s.update=function(e,a,i){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var n=0;n<a.length;n++){var d=a[n];d.x>e.max.x&&(e.max.x=d.x),d.x<e.min.x&&(e.min.x=d.x),d.y>e.max.y&&(e.max.y=d.y),d.y<e.min.y&&(e.min.y=d.y)}i&&(i.x>0?e.max.x+=i.x:e.min.x+=i.x,i.y>0?e.max.y+=i.y:e.min.y+=i.y)},s.contains=function(e,a){return a.x>=e.min.x&&a.x<=e.max.x&&a.y>=e.min.y&&a.y<=e.max.y},s.overlaps=function(e,a){return e.min.x<=a.max.x&&e.max.x>=a.min.x&&e.max.y>=a.min.y&&e.min.y<=a.max.y},s.translate=function(e,a){e.min.x+=a.x,e.max.x+=a.x,e.min.y+=a.y,e.max.y+=a.y},s.shift=function(e,a){var i=e.max.x-e.min.x,n=e.max.y-e.min.y;e.min.x=a.x,e.max.x=a.x+i,e.min.y=a.y,e.max.y=a.y+n}})()}),(function(m,v){var s={};m.exports=s,(function(){s.create=function(e,a){return{x:e||0,y:a||0}},s.clone=function(e){return{x:e.x,y:e.y}},s.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},s.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},s.rotate=function(e,a,i){var n=Math.cos(a),d=Math.sin(a);i||(i={});var o=e.x*n-e.y*d;return i.y=e.x*d+e.y*n,i.x=o,i},s.rotateAbout=function(e,a,i,n){var d=Math.cos(a),o=Math.sin(a);n||(n={});var f=i.x+((e.x-i.x)*d-(e.y-i.y)*o);return n.y=i.y+((e.x-i.x)*o+(e.y-i.y)*d),n.x=f,n},s.normalise=function(e){var a=s.magnitude(e);return a===0?{x:0,y:0}:{x:e.x/a,y:e.y/a}},s.dot=function(e,a){return e.x*a.x+e.y*a.y},s.cross=function(e,a){return e.x*a.y-e.y*a.x},s.cross3=function(e,a,i){return(a.x-e.x)*(i.y-e.y)-(a.y-e.y)*(i.x-e.x)},s.add=function(e,a,i){return i||(i={}),i.x=e.x+a.x,i.y=e.y+a.y,i},s.sub=function(e,a,i){return i||(i={}),i.x=e.x-a.x,i.y=e.y-a.y,i},s.mult=function(e,a){return{x:e.x*a,y:e.y*a}},s.div=function(e,a){return{x:e.x/a,y:e.y/a}},s.perp=function(e,a){return a=a===!0?-1:1,{x:a*-e.y,y:a*e.x}},s.neg=function(e){return{x:-e.x,y:-e.y}},s.angle=function(e,a){return Math.atan2(a.y-e.y,a.x-e.x)},s._temp=[s.create(),s.create(),s.create(),s.create(),s.create(),s.create()]})()}),(function(m,v,s){var e={};m.exports=e;var a=s(2),i=s(0);(function(){e.create=function(n,d){for(var o=[],f=0;f<n.length;f++){var u=n[f],t={x:u.x,y:u.y,index:f,body:d,isInternal:!1};o.push(t)}return o},e.fromPath=function(n,d){var o=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,f=[];return n.replace(o,function(u,t,c){f.push({x:parseFloat(t),y:parseFloat(c)})}),e.create(f,d)},e.centre=function(n){for(var d=e.area(n,!0),o={x:0,y:0},f,u,t,c=0;c<n.length;c++)t=(c+1)%n.length,f=a.cross(n[c],n[t]),u=a.mult(a.add(n[c],n[t]),f),o=a.add(o,u);return a.div(o,6*d)},e.mean=function(n){for(var d={x:0,y:0},o=0;o<n.length;o++)d.x+=n[o].x,d.y+=n[o].y;return a.div(d,n.length)},e.area=function(n,d){for(var o=0,f=n.length-1,u=0;u<n.length;u++)o+=(n[f].x-n[u].x)*(n[f].y+n[u].y),f=u;return d?o/2:Math.abs(o)/2},e.inertia=function(n,d){for(var o=0,f=0,u=n,t,c,l=0;l<u.length;l++)c=(l+1)%u.length,t=Math.abs(a.cross(u[c],u[l])),o+=t*(a.dot(u[c],u[c])+a.dot(u[c],u[l])+a.dot(u[l],u[l])),f+=t;return d/6*(o/f)},e.translate=function(n,d,o){o=typeof o<"u"?o:1;var f=n.length,u=d.x*o,t=d.y*o,c;for(c=0;c<f;c++)n[c].x+=u,n[c].y+=t;return n},e.rotate=function(n,d,o){if(d!==0){var f=Math.cos(d),u=Math.sin(d),t=o.x,c=o.y,l=n.length,h,w,C,T;for(T=0;T<l;T++)h=n[T],w=h.x-t,C=h.y-c,h.x=t+(w*f-C*u),h.y=c+(w*u+C*f);return n}},e.contains=function(n,d){for(var o=d.x,f=d.y,u=n.length,t=n[u-1],c,l=0;l<u;l++){if(c=n[l],(o-t.x)*(c.y-t.y)+(f-t.y)*(t.x-c.x)>0)return!1;t=c}return!0},e.scale=function(n,d,o,f){if(d===1&&o===1)return n;f=f||e.centre(n);for(var u,t,c=0;c<n.length;c++)u=n[c],t=a.sub(u,f),n[c].x=f.x+t.x*d,n[c].y=f.y+t.y*o;return n},e.chamfer=function(n,d,o,f,u){typeof d=="number"?d=[d]:d=d||[8],o=typeof o<"u"?o:-1,f=f||2,u=u||14;for(var t=[],c=0;c<n.length;c++){var l=n[c-1>=0?c-1:n.length-1],h=n[c],w=n[(c+1)%n.length],C=d[c<d.length?c:d.length-1];if(C===0){t.push(h);continue}var T=a.normalise({x:h.y-l.y,y:l.x-h.x}),E=a.normalise({x:w.y-h.y,y:h.x-w.x}),g=Math.sqrt(2*Math.pow(C,2)),x=a.mult(i.clone(T),C),b=a.normalise(a.mult(a.add(T,E),.5)),y=a.sub(h,a.mult(b,g)),S=o;o===-1&&(S=Math.pow(C,.32)*1.75),S=i.clamp(S,f,u),S%2===1&&(S+=1);for(var M=Math.acos(a.dot(T,E)),A=M/S,P=0;P<S;P++)t.push(a.add(a.rotate(x,A*P),y))}return t},e.clockwiseSort=function(n){var d=e.mean(n);return n.sort(function(o,f){return a.angle(d,o)-a.angle(d,f)}),n},e.isConvex=function(n){var d=0,o=n.length,f,u,t,c;if(o<3)return null;for(f=0;f<o;f++)if(u=(f+1)%o,t=(f+2)%o,c=(n[u].x-n[f].x)*(n[t].y-n[u].y),c-=(n[u].y-n[f].y)*(n[t].x-n[u].x),c<0?d|=1:c>0&&(d|=2),d===3)return!1;return d!==0?!0:null},e.hull=function(n){var d=[],o=[],f,u;for(n=n.slice(0),n.sort(function(t,c){var l=t.x-c.x;return l!==0?l:t.y-c.y}),u=0;u<n.length;u+=1){for(f=n[u];o.length>=2&&a.cross3(o[o.length-2],o[o.length-1],f)<=0;)o.pop();o.push(f)}for(u=n.length-1;u>=0;u-=1){for(f=n[u];d.length>=2&&a.cross3(d[d.length-2],d[d.length-1],f)<=0;)d.pop();d.push(f)}return d.pop(),o.pop(),d.concat(o)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(3),i=s(2),n=s(7),d=s(0),o=s(1),f=s(11);(function(){e._timeCorrection=!0,e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e._baseDelta=1e3/60,e.create=function(t){var c={id:d.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:a.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},l=d.extend(c,t);return u(l,t),l},e.nextGroup=function(t){return t?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var u=function(t,c){c=c||{},e.set(t,{bounds:t.bounds||o.create(t.vertices),positionPrev:t.positionPrev||i.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),a.rotate(t.vertices,t.angle,t.position),f.rotate(t.axes,t.angle),o.update(t.bounds,t.vertices,t.velocity),e.set(t,{axes:c.axes||t.axes,area:c.area||t.area,mass:c.mass||t.mass,inertia:c.inertia||t.inertia});var l=t.isStatic?"#14151f":d.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),h=t.isStatic?"#555":"#ccc",w=t.isStatic&&t.render.fillStyle===null?1:0;t.render.fillStyle=t.render.fillStyle||l,t.render.strokeStyle=t.render.strokeStyle||h,t.render.lineWidth=t.render.lineWidth||w,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};e.set=function(t,c,l){var h;typeof c=="string"&&(h=c,c={},c[h]=l);for(h in c)if(Object.prototype.hasOwnProperty.call(c,h))switch(l=c[h],h){case"isStatic":e.setStatic(t,l);break;case"isSleeping":n.set(t,l);break;case"mass":e.setMass(t,l);break;case"density":e.setDensity(t,l);break;case"inertia":e.setInertia(t,l);break;case"vertices":e.setVertices(t,l);break;case"position":e.setPosition(t,l);break;case"angle":e.setAngle(t,l);break;case"velocity":e.setVelocity(t,l);break;case"angularVelocity":e.setAngularVelocity(t,l);break;case"speed":e.setSpeed(t,l);break;case"angularSpeed":e.setAngularSpeed(t,l);break;case"parts":e.setParts(t,l);break;case"centre":e.setCentre(t,l);break;default:t[h]=l}},e.setStatic=function(t,c){for(var l=0;l<t.parts.length;l++){var h=t.parts[l];c?(h.isStatic||(h._original={restitution:h.restitution,friction:h.friction,mass:h.mass,inertia:h.inertia,density:h.density,inverseMass:h.inverseMass,inverseInertia:h.inverseInertia}),h.restitution=0,h.friction=1,h.mass=h.inertia=h.density=1/0,h.inverseMass=h.inverseInertia=0,h.positionPrev.x=h.position.x,h.positionPrev.y=h.position.y,h.anglePrev=h.angle,h.angularVelocity=0,h.speed=0,h.angularSpeed=0,h.motion=0):h._original&&(h.restitution=h._original.restitution,h.friction=h._original.friction,h.mass=h._original.mass,h.inertia=h._original.inertia,h.density=h._original.density,h.inverseMass=h._original.inverseMass,h.inverseInertia=h._original.inverseInertia,h._original=null),h.isStatic=c}},e.setMass=function(t,c){var l=t.inertia/(t.mass/6);t.inertia=l*(c/6),t.inverseInertia=1/t.inertia,t.mass=c,t.inverseMass=1/t.mass,t.density=t.mass/t.area},e.setDensity=function(t,c){e.setMass(t,c*t.area),t.density=c},e.setInertia=function(t,c){t.inertia=c,t.inverseInertia=1/t.inertia},e.setVertices=function(t,c){c[0].body===t?t.vertices=c:t.vertices=a.create(c,t),t.axes=f.fromVertices(t.vertices),t.area=a.area(t.vertices),e.setMass(t,t.density*t.area);var l=a.centre(t.vertices);a.translate(t.vertices,l,-1),e.setInertia(t,e._inertiaScale*a.inertia(t.vertices,t.mass)),a.translate(t.vertices,t.position),o.update(t.bounds,t.vertices,t.velocity)},e.setParts=function(t,c,l){var h;for(c=c.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,h=0;h<c.length;h++){var w=c[h];w!==t&&(w.parent=t,t.parts.push(w))}if(t.parts.length!==1){if(l=typeof l<"u"?l:!0,l){var C=[];for(h=0;h<c.length;h++)C=C.concat(c[h].vertices);a.clockwiseSort(C);var T=a.hull(C),E=a.centre(T);e.setVertices(t,T),a.translate(t.vertices,E)}var g=e._totalProperties(t);t.area=g.area,t.parent=t,t.position.x=g.centre.x,t.position.y=g.centre.y,t.positionPrev.x=g.centre.x,t.positionPrev.y=g.centre.y,e.setMass(t,g.mass),e.setInertia(t,g.inertia),e.setPosition(t,g.centre)}},e.setCentre=function(t,c,l){l?(t.positionPrev.x+=c.x,t.positionPrev.y+=c.y,t.position.x+=c.x,t.position.y+=c.y):(t.positionPrev.x=c.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=c.y-(t.position.y-t.positionPrev.y),t.position.x=c.x,t.position.y=c.y)},e.setPosition=function(t,c,l){var h=i.sub(c,t.position);l?(t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.velocity.x=h.x,t.velocity.y=h.y,t.speed=i.magnitude(h)):(t.positionPrev.x+=h.x,t.positionPrev.y+=h.y);for(var w=0;w<t.parts.length;w++){var C=t.parts[w];C.position.x+=h.x,C.position.y+=h.y,a.translate(C.vertices,h),o.update(C.bounds,C.vertices,t.velocity)}},e.setAngle=function(t,c,l){var h=c-t.angle;l?(t.anglePrev=t.angle,t.angularVelocity=h,t.angularSpeed=Math.abs(h)):t.anglePrev+=h;for(var w=0;w<t.parts.length;w++){var C=t.parts[w];C.angle+=h,a.rotate(C.vertices,h,t.position),f.rotate(C.axes,h),o.update(C.bounds,C.vertices,t.velocity),w>0&&i.rotateAbout(C.position,h,t.position,C.position)}},e.setVelocity=function(t,c){var l=t.deltaTime/e._baseDelta;t.positionPrev.x=t.position.x-c.x*l,t.positionPrev.y=t.position.y-c.y*l,t.velocity.x=(t.position.x-t.positionPrev.x)/l,t.velocity.y=(t.position.y-t.positionPrev.y)/l,t.speed=i.magnitude(t.velocity)},e.getVelocity=function(t){var c=e._baseDelta/t.deltaTime;return{x:(t.position.x-t.positionPrev.x)*c,y:(t.position.y-t.positionPrev.y)*c}},e.getSpeed=function(t){return i.magnitude(e.getVelocity(t))},e.setSpeed=function(t,c){e.setVelocity(t,i.mult(i.normalise(e.getVelocity(t)),c))},e.setAngularVelocity=function(t,c){var l=t.deltaTime/e._baseDelta;t.anglePrev=t.angle-c*l,t.angularVelocity=(t.angle-t.anglePrev)/l,t.angularSpeed=Math.abs(t.angularVelocity)},e.getAngularVelocity=function(t){return(t.angle-t.anglePrev)*e._baseDelta/t.deltaTime},e.getAngularSpeed=function(t){return Math.abs(e.getAngularVelocity(t))},e.setAngularSpeed=function(t,c){e.setAngularVelocity(t,d.sign(e.getAngularVelocity(t))*c)},e.translate=function(t,c,l){e.setPosition(t,i.add(t.position,c),l)},e.rotate=function(t,c,l,h){if(!l)e.setAngle(t,t.angle+c,h);else{var w=Math.cos(c),C=Math.sin(c),T=t.position.x-l.x,E=t.position.y-l.y;e.setPosition(t,{x:l.x+(T*w-E*C),y:l.y+(T*C+E*w)},h),e.setAngle(t,t.angle+c,h)}},e.scale=function(t,c,l,h){var w=0,C=0;h=h||t.position;for(var T=0;T<t.parts.length;T++){var E=t.parts[T];a.scale(E.vertices,c,l,h),E.axes=f.fromVertices(E.vertices),E.area=a.area(E.vertices),e.setMass(E,t.density*E.area),a.translate(E.vertices,{x:-E.position.x,y:-E.position.y}),e.setInertia(E,e._inertiaScale*a.inertia(E.vertices,E.mass)),a.translate(E.vertices,{x:E.position.x,y:E.position.y}),T>0&&(w+=E.area,C+=E.inertia),E.position.x=h.x+(E.position.x-h.x)*c,E.position.y=h.y+(E.position.y-h.y)*l,o.update(E.bounds,E.vertices,t.velocity)}t.parts.length>1&&(t.area=w,t.isStatic||(e.setMass(t,t.density*w),e.setInertia(t,C))),t.circleRadius&&(c===l?t.circleRadius*=c:t.circleRadius=null)},e.update=function(t,c){c=(typeof c<"u"?c:1e3/60)*t.timeScale;var l=c*c,h=e._timeCorrection?c/(t.deltaTime||c):1,w=1-t.frictionAir*(c/d._baseDelta),C=(t.position.x-t.positionPrev.x)*h,T=(t.position.y-t.positionPrev.y)*h;t.velocity.x=C*w+t.force.x/t.mass*l,t.velocity.y=T*w+t.force.y/t.mass*l,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.deltaTime=c,t.angularVelocity=(t.angle-t.anglePrev)*w*h+t.torque/t.inertia*l,t.anglePrev=t.angle,t.angle+=t.angularVelocity;for(var E=0;E<t.parts.length;E++){var g=t.parts[E];a.translate(g.vertices,t.velocity),E>0&&(g.position.x+=t.velocity.x,g.position.y+=t.velocity.y),t.angularVelocity!==0&&(a.rotate(g.vertices,t.angularVelocity,t.position),f.rotate(g.axes,t.angularVelocity),E>0&&i.rotateAbout(g.position,t.angularVelocity,t.position,g.position)),o.update(g.bounds,g.vertices,t.velocity)}},e.updateVelocities=function(t){var c=e._baseDelta/t.deltaTime,l=t.velocity;l.x=(t.position.x-t.positionPrev.x)*c,l.y=(t.position.y-t.positionPrev.y)*c,t.speed=Math.sqrt(l.x*l.x+l.y*l.y),t.angularVelocity=(t.angle-t.anglePrev)*c,t.angularSpeed=Math.abs(t.angularVelocity)},e.applyForce=function(t,c,l){var h={x:c.x-t.position.x,y:c.y-t.position.y};t.force.x+=l.x,t.force.y+=l.y,t.torque+=h.x*l.y-h.y*l.x},e._totalProperties=function(t){for(var c={mass:0,area:0,inertia:0,centre:{x:0,y:0}},l=t.parts.length===1?0:1;l<t.parts.length;l++){var h=t.parts[l],w=h.mass!==1/0?h.mass:1;c.mass+=w,c.area+=h.area,c.inertia+=h.inertia,c.centre=i.add(c.centre,i.mult(h.position,w))}return c.centre=i.div(c.centre,c.mass),c}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(0);(function(){e.on=function(i,n,d){for(var o=n.split(" "),f,u=0;u<o.length;u++)f=o[u],i.events=i.events||{},i.events[f]=i.events[f]||[],i.events[f].push(d);return d},e.off=function(i,n,d){if(!n){i.events={};return}typeof n=="function"&&(d=n,n=a.keys(i.events).join(" "));for(var o=n.split(" "),f=0;f<o.length;f++){var u=i.events[o[f]],t=[];if(d&&u)for(var c=0;c<u.length;c++)u[c]!==d&&t.push(u[c]);i.events[o[f]]=t}},e.trigger=function(i,n,d){var o,f,u,t,c=i.events;if(c&&a.keys(c).length>0){d||(d={}),o=n.split(" ");for(var l=0;l<o.length;l++)if(f=o[l],u=c[f],u){t=a.clone(d,!1),t.name=f,t.source=i;for(var h=0;h<u.length;h++)u[h].apply(i,[t])}}}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(5),i=s(0),n=s(1),d=s(4);(function(){e.create=function(o){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},o)},e.setModified=function(o,f,u,t){if(o.isModified=f,f&&o.cache&&(o.cache.allBodies=null,o.cache.allConstraints=null,o.cache.allComposites=null),u&&o.parent&&e.setModified(o.parent,f,u,t),t)for(var c=0;c<o.composites.length;c++){var l=o.composites[c];e.setModified(l,f,u,t)}},e.add=function(o,f){var u=[].concat(f);a.trigger(o,"beforeAdd",{object:f});for(var t=0;t<u.length;t++){var c=u[t];switch(c.type){case"body":if(c.parent!==c){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(o,c);break;case"constraint":e.addConstraint(o,c);break;case"composite":e.addComposite(o,c);break;case"mouseConstraint":e.addConstraint(o,c.constraint);break}}return a.trigger(o,"afterAdd",{object:f}),o},e.remove=function(o,f,u){var t=[].concat(f);a.trigger(o,"beforeRemove",{object:f});for(var c=0;c<t.length;c++){var l=t[c];switch(l.type){case"body":e.removeBody(o,l,u);break;case"constraint":e.removeConstraint(o,l,u);break;case"composite":e.removeComposite(o,l,u);break;case"mouseConstraint":e.removeConstraint(o,l.constraint);break}}return a.trigger(o,"afterRemove",{object:f}),o},e.addComposite=function(o,f){return o.composites.push(f),f.parent=o,e.setModified(o,!0,!0,!1),o},e.removeComposite=function(o,f,u){var t=i.indexOf(o.composites,f);if(t!==-1){var c=e.allBodies(f);e.removeCompositeAt(o,t);for(var l=0;l<c.length;l++)c[l].sleepCounter=0}if(u)for(var l=0;l<o.composites.length;l++)e.removeComposite(o.composites[l],f,!0);return o},e.removeCompositeAt=function(o,f){return o.composites.splice(f,1),e.setModified(o,!0,!0,!1),o},e.addBody=function(o,f){return o.bodies.push(f),e.setModified(o,!0,!0,!1),o},e.removeBody=function(o,f,u){var t=i.indexOf(o.bodies,f);if(t!==-1&&(e.removeBodyAt(o,t),f.sleepCounter=0),u)for(var c=0;c<o.composites.length;c++)e.removeBody(o.composites[c],f,!0);return o},e.removeBodyAt=function(o,f){return o.bodies.splice(f,1),e.setModified(o,!0,!0,!1),o},e.addConstraint=function(o,f){return o.constraints.push(f),e.setModified(o,!0,!0,!1),o},e.removeConstraint=function(o,f,u){var t=i.indexOf(o.constraints,f);if(t!==-1&&e.removeConstraintAt(o,t),u)for(var c=0;c<o.composites.length;c++)e.removeConstraint(o.composites[c],f,!0);return o},e.removeConstraintAt=function(o,f){return o.constraints.splice(f,1),e.setModified(o,!0,!0,!1),o},e.clear=function(o,f,u){if(u)for(var t=0;t<o.composites.length;t++)e.clear(o.composites[t],f,!0);return f?o.bodies=o.bodies.filter(function(c){return c.isStatic}):o.bodies.length=0,o.constraints.length=0,o.composites.length=0,e.setModified(o,!0,!0,!1),o},e.allBodies=function(o){if(o.cache&&o.cache.allBodies)return o.cache.allBodies;for(var f=[].concat(o.bodies),u=0;u<o.composites.length;u++)f=f.concat(e.allBodies(o.composites[u]));return o.cache&&(o.cache.allBodies=f),f},e.allConstraints=function(o){if(o.cache&&o.cache.allConstraints)return o.cache.allConstraints;for(var f=[].concat(o.constraints),u=0;u<o.composites.length;u++)f=f.concat(e.allConstraints(o.composites[u]));return o.cache&&(o.cache.allConstraints=f),f},e.allComposites=function(o){if(o.cache&&o.cache.allComposites)return o.cache.allComposites;for(var f=[].concat(o.composites),u=0;u<o.composites.length;u++)f=f.concat(e.allComposites(o.composites[u]));return o.cache&&(o.cache.allComposites=f),f},e.get=function(o,f,u){var t,c;switch(u){case"body":t=e.allBodies(o);break;case"constraint":t=e.allConstraints(o);break;case"composite":t=e.allComposites(o).concat(o);break}return t?(c=t.filter(function(l){return l.id.toString()===f.toString()}),c.length===0?null:c[0]):null},e.move=function(o,f,u){return e.remove(o,f),e.add(u,f),o},e.rebase=function(o){for(var f=e.allBodies(o).concat(e.allConstraints(o)).concat(e.allComposites(o)),u=0;u<f.length;u++)f[u].id=i.nextId();return o},e.translate=function(o,f,u){for(var t=u?e.allBodies(o):o.bodies,c=0;c<t.length;c++)d.translate(t[c],f);return o},e.rotate=function(o,f,u,t){for(var c=Math.cos(f),l=Math.sin(f),h=t?e.allBodies(o):o.bodies,w=0;w<h.length;w++){var C=h[w],T=C.position.x-u.x,E=C.position.y-u.y;d.setPosition(C,{x:u.x+(T*c-E*l),y:u.y+(T*l+E*c)}),d.rotate(C,f)}return o},e.scale=function(o,f,u,t,c){for(var l=c?e.allBodies(o):o.bodies,h=0;h<l.length;h++){var w=l[h],C=w.position.x-t.x,T=w.position.y-t.y;d.setPosition(w,{x:t.x+C*f,y:t.y+T*u}),d.scale(w,f,u)}return o},e.bounds=function(o){for(var f=e.allBodies(o),u=[],t=0;t<f.length;t+=1){var c=f[t];u.push(c.bounds.min,c.bounds.max)}return n.create(u)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(4),i=s(5),n=s(0);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(d,o){for(var f=o/n._baseDelta,u=e._motionSleepThreshold,t=0;t<d.length;t++){var c=d[t],l=a.getSpeed(c),h=a.getAngularSpeed(c),w=l*l+h*h;if(c.force.x!==0||c.force.y!==0){e.set(c,!1);continue}var C=Math.min(c.motion,w),T=Math.max(c.motion,w);c.motion=e._minBias*C+(1-e._minBias)*T,c.sleepThreshold>0&&c.motion<u?(c.sleepCounter+=1,c.sleepCounter>=c.sleepThreshold/f&&e.set(c,!0)):c.sleepCounter>0&&(c.sleepCounter-=1)}},e.afterCollisions=function(d){for(var o=e._motionSleepThreshold,f=0;f<d.length;f++){var u=d[f];if(u.isActive){var t=u.collision,c=t.bodyA.parent,l=t.bodyB.parent;if(!(c.isSleeping&&l.isSleeping||c.isStatic||l.isStatic)&&(c.isSleeping||l.isSleeping)){var h=c.isSleeping&&!c.isStatic?c:l,w=h===c?l:c;!h.isStatic&&w.motion>o&&e.set(h,!1)}}}},e.set=function(d,o){var f=d.isSleeping;o?(d.isSleeping=!0,d.sleepCounter=d.sleepThreshold,d.positionImpulse.x=0,d.positionImpulse.y=0,d.positionPrev.x=d.position.x,d.positionPrev.y=d.position.y,d.anglePrev=d.angle,d.speed=0,d.angularSpeed=0,d.motion=0,f||i.trigger(d,"sleepStart")):(d.isSleeping=!1,d.sleepCounter=0,f&&i.trigger(d,"sleepEnd"))}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(3),i=s(9);(function(){var n=[],d={overlap:0,axis:null},o={overlap:0,axis:null};e.create=function(f,u){return{pair:null,collided:!1,bodyA:f,bodyB:u,parentA:f.parent,parentB:u.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},e.collides=function(f,u,t){if(e._overlapAxes(d,f.vertices,u.vertices,f.axes),d.overlap<=0||(e._overlapAxes(o,u.vertices,f.vertices,u.axes),o.overlap<=0))return null;var c=t&&t.table[i.id(f,u)],l;c?l=c.collision:(l=e.create(f,u),l.collided=!0,l.bodyA=f.id<u.id?f:u,l.bodyB=f.id<u.id?u:f,l.parentA=l.bodyA.parent,l.parentB=l.bodyB.parent),f=l.bodyA,u=l.bodyB;var h;d.overlap<o.overlap?h=d:h=o;var w=l.normal,C=l.tangent,T=l.penetration,E=l.supports,g=h.overlap,x=h.axis,b=x.x,y=x.y,S=u.position.x-f.position.x,M=u.position.y-f.position.y;b*S+y*M>=0&&(b=-b,y=-y),w.x=b,w.y=y,C.x=-y,C.y=b,T.x=b*g,T.y=y*g,l.depth=g;var A=e._findSupports(f,u,w,1),P=0;if(a.contains(f.vertices,A[0])&&(E[P++]=A[0]),a.contains(f.vertices,A[1])&&(E[P++]=A[1]),P<2){var L=e._findSupports(u,f,w,-1);a.contains(u.vertices,L[0])&&(E[P++]=L[0]),P<2&&a.contains(u.vertices,L[1])&&(E[P++]=L[1])}return P===0&&(E[P++]=A[0]),l.supportCount=P,l},e._overlapAxes=function(f,u,t,c){var l=u.length,h=t.length,w=u[0].x,C=u[0].y,T=t[0].x,E=t[0].y,g=c.length,x=Number.MAX_VALUE,b=0,y,S,M,A,P,L;for(P=0;P<g;P++){var k=c[P],I=k.x,R=k.y,O=w*I+C*R,V=T*I+E*R,N=O,K=V;for(L=1;L<l;L+=1)A=u[L].x*I+u[L].y*R,A>N?N=A:A<O&&(O=A);for(L=1;L<h;L+=1)A=t[L].x*I+t[L].y*R,A>K?K=A:A<V&&(V=A);if(S=N-V,M=K-O,y=S<M?S:M,y<x&&(x=y,b=P,y<=0))break}f.axis=c[b],f.overlap=x},e._findSupports=function(f,u,t,c){var l=u.vertices,h=l.length,w=f.position.x,C=f.position.y,T=t.x*c,E=t.y*c,g=l[0],x=g,b=T*(w-x.x)+E*(C-x.y),y,S,M;for(M=1;M<h;M+=1)x=l[M],S=T*(w-x.x)+E*(C-x.y),S<b&&(b=S,g=x);return y=l[(h+g.index-1)%h],b=T*(w-y.x)+E*(C-y.y),x=l[(g.index+1)%h],T*(w-x.x)+E*(C-x.y)<b?(n[0]=g,n[1]=x,n):(n[0]=g,n[1]=y,n)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(16);(function(){e.create=function(i,n){var d=i.bodyA,o=i.bodyB,f={id:e.id(d,o),bodyA:d,bodyB:o,collision:i,contacts:[a.create(),a.create()],contactCount:0,separation:0,isActive:!0,isSensor:d.isSensor||o.isSensor,timeCreated:n,timeUpdated:n,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(f,i,n),f},e.update=function(i,n,d){var o=n.supports,f=n.supportCount,u=i.contacts,t=n.parentA,c=n.parentB;i.isActive=!0,i.timeUpdated=d,i.collision=n,i.separation=n.depth,i.inverseMass=t.inverseMass+c.inverseMass,i.friction=t.friction<c.friction?t.friction:c.friction,i.frictionStatic=t.frictionStatic>c.frictionStatic?t.frictionStatic:c.frictionStatic,i.restitution=t.restitution>c.restitution?t.restitution:c.restitution,i.slop=t.slop>c.slop?t.slop:c.slop,i.contactCount=f,n.pair=i;var l=o[0],h=u[0],w=o[1],C=u[1];(C.vertex===l||h.vertex===w)&&(u[1]=h,u[0]=h=C,C=u[1]),h.vertex=l,C.vertex=w},e.setActive=function(i,n,d){n?(i.isActive=!0,i.timeUpdated=d):(i.isActive=!1,i.contactCount=0)},e.id=function(i,n){return i.id<n.id?i.id.toString(36)+":"+n.id.toString(36):n.id.toString(36)+":"+i.id.toString(36)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(3),i=s(2),n=s(7),d=s(1),o=s(11),f=s(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(u){var t=u;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var c=t.bodyA?i.add(t.bodyA.position,t.pointA):t.pointA,l=t.bodyB?i.add(t.bodyB.position,t.pointB):t.pointB,h=i.magnitude(i.sub(c,l));t.length=typeof t.length<"u"?t.length:h,t.id=t.id||f.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var w={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return t.length===0&&t.stiffness>.1?(w.type="pin",w.anchors=!1):t.stiffness<.9&&(w.type="spring"),t.render=f.extend(w,t.render),t},e.preSolveAll=function(u){for(var t=0;t<u.length;t+=1){var c=u[t],l=c.constraintImpulse;c.isStatic||l.x===0&&l.y===0&&l.angle===0||(c.position.x+=l.x,c.position.y+=l.y,c.angle+=l.angle)}},e.solveAll=function(u,t){for(var c=f.clamp(t/f._baseDelta,0,1),l=0;l<u.length;l+=1){var h=u[l],w=!h.bodyA||h.bodyA&&h.bodyA.isStatic,C=!h.bodyB||h.bodyB&&h.bodyB.isStatic;(w||C)&&e.solve(u[l],c)}for(l=0;l<u.length;l+=1)h=u[l],w=!h.bodyA||h.bodyA&&h.bodyA.isStatic,C=!h.bodyB||h.bodyB&&h.bodyB.isStatic,!w&&!C&&e.solve(u[l],c)},e.solve=function(u,t){var c=u.bodyA,l=u.bodyB,h=u.pointA,w=u.pointB;if(!(!c&&!l)){c&&!c.isStatic&&(i.rotate(h,c.angle-u.angleA,h),u.angleA=c.angle),l&&!l.isStatic&&(i.rotate(w,l.angle-u.angleB,w),u.angleB=l.angle);var C=h,T=w;if(c&&(C=i.add(c.position,h)),l&&(T=i.add(l.position,w)),!(!C||!T)){var E=i.sub(C,T),g=i.magnitude(E);g<e._minLength&&(g=e._minLength);var x=(g-u.length)/g,b=u.stiffness>=1||u.length===0,y=b?u.stiffness*t:u.stiffness*t*t,S=u.damping*t,M=i.mult(E,x*y),A=(c?c.inverseMass:0)+(l?l.inverseMass:0),P=(c?c.inverseInertia:0)+(l?l.inverseInertia:0),L=A+P,k,I,R,O,V;if(S>0){var N=i.create();R=i.div(E,g),V=i.sub(l&&i.sub(l.position,l.positionPrev)||N,c&&i.sub(c.position,c.positionPrev)||N),O=i.dot(R,V)}c&&!c.isStatic&&(I=c.inverseMass/A,c.constraintImpulse.x-=M.x*I,c.constraintImpulse.y-=M.y*I,c.position.x-=M.x*I,c.position.y-=M.y*I,S>0&&(c.positionPrev.x-=S*R.x*O*I,c.positionPrev.y-=S*R.y*O*I),k=i.cross(h,M)/L*e._torqueDampen*c.inverseInertia*(1-u.angularStiffness),c.constraintImpulse.angle-=k,c.angle-=k),l&&!l.isStatic&&(I=l.inverseMass/A,l.constraintImpulse.x+=M.x*I,l.constraintImpulse.y+=M.y*I,l.position.x+=M.x*I,l.position.y+=M.y*I,S>0&&(l.positionPrev.x+=S*R.x*O*I,l.positionPrev.y+=S*R.y*O*I),k=i.cross(w,M)/L*e._torqueDampen*l.inverseInertia*(1-u.angularStiffness),l.constraintImpulse.angle+=k,l.angle+=k)}}},e.postSolveAll=function(u){for(var t=0;t<u.length;t++){var c=u[t],l=c.constraintImpulse;if(!(c.isStatic||l.x===0&&l.y===0&&l.angle===0)){n.set(c,!1);for(var h=0;h<c.parts.length;h++){var w=c.parts[h];a.translate(w.vertices,l),h>0&&(w.position.x+=l.x,w.position.y+=l.y),l.angle!==0&&(a.rotate(w.vertices,l.angle,c.position),o.rotate(w.axes,l.angle),h>0&&i.rotateAbout(w.position,l.angle,c.position,w.position)),d.update(w.bounds,w.vertices,c.velocity)}l.angle*=e._warming,l.x*=e._warming,l.y*=e._warming}}},e.pointAWorld=function(u){return{x:(u.bodyA?u.bodyA.position.x:0)+(u.pointA?u.pointA.x:0),y:(u.bodyA?u.bodyA.position.y:0)+(u.pointA?u.pointA.y:0)}},e.pointBWorld=function(u){return{x:(u.bodyB?u.bodyB.position.x:0)+(u.pointB?u.pointB.x:0),y:(u.bodyB?u.bodyB.position.y:0)+(u.pointB?u.pointB.y:0)}},e.currentLength=function(u){var t=(u.bodyA?u.bodyA.position.x:0)+(u.pointA?u.pointA.x:0),c=(u.bodyA?u.bodyA.position.y:0)+(u.pointA?u.pointA.y:0),l=(u.bodyB?u.bodyB.position.x:0)+(u.pointB?u.pointB.x:0),h=(u.bodyB?u.bodyB.position.y:0)+(u.pointB?u.pointB.y:0),w=t-l,C=c-h;return Math.sqrt(w*w+C*C)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(2),i=s(0);(function(){e.fromVertices=function(n){for(var d={},o=0;o<n.length;o++){var f=(o+1)%n.length,u=a.normalise({x:n[f].y-n[o].y,y:n[o].x-n[f].x}),t=u.y===0?1/0:u.x/u.y;t=t.toFixed(3).toString(),d[t]=u}return i.values(d)},e.rotate=function(n,d){if(d!==0)for(var o=Math.cos(d),f=Math.sin(d),u=0;u<n.length;u++){var t=n[u],c;c=t.x*o-t.y*f,t.y=t.x*f+t.y*o,t.x=c}}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(3),i=s(0),n=s(4),d=s(1),o=s(2);(function(){e.rectangle=function(f,u,t,c,l){l=l||{};var h={label:"Rectangle Body",position:{x:f,y:u},vertices:a.fromPath("L 0 0 L "+t+" 0 L "+t+" "+c+" L 0 "+c)};if(l.chamfer){var w=l.chamfer;h.vertices=a.chamfer(h.vertices,w.radius,w.quality,w.qualityMin,w.qualityMax),delete l.chamfer}return n.create(i.extend({},h,l))},e.trapezoid=function(f,u,t,c,l,h){h=h||{},l>=1&&i.warn("Bodies.trapezoid: slope parameter must be < 1."),l*=.5;var w=(1-l*2)*t,C=t*l,T=C+w,E=T+C,g;l<.5?g="L 0 0 L "+C+" "+-c+" L "+T+" "+-c+" L "+E+" 0":g="L 0 0 L "+T+" "+-c+" L "+E+" 0";var x={label:"Trapezoid Body",position:{x:f,y:u},vertices:a.fromPath(g)};if(h.chamfer){var b=h.chamfer;x.vertices=a.chamfer(x.vertices,b.radius,b.quality,b.qualityMin,b.qualityMax),delete h.chamfer}return n.create(i.extend({},x,h))},e.circle=function(f,u,t,c,l){c=c||{};var h={label:"Circle Body",circleRadius:t};l=l||25;var w=Math.ceil(Math.max(10,Math.min(l,t)));return w%2===1&&(w+=1),e.polygon(f,u,w,t,i.extend({},h,c))},e.polygon=function(f,u,t,c,l){if(l=l||{},t<3)return e.circle(f,u,c,l);for(var h=2*Math.PI/t,w="",C=h*.5,T=0;T<t;T+=1){var E=C+T*h,g=Math.cos(E)*c,x=Math.sin(E)*c;w+="L "+g.toFixed(3)+" "+x.toFixed(3)+" "}var b={label:"Polygon Body",position:{x:f,y:u},vertices:a.fromPath(w)};if(l.chamfer){var y=l.chamfer;b.vertices=a.chamfer(b.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete l.chamfer}return n.create(i.extend({},b,l))},e.fromVertices=function(f,u,t,c,l,h,w,C){var T=i.getDecomp(),E,g,x,b,y,S,M,A,P,L,k;for(E=!!(T&&T.quickDecomp),c=c||{},x=[],l=typeof l<"u"?l:!1,h=typeof h<"u"?h:.01,w=typeof w<"u"?w:10,C=typeof C<"u"?C:.01,i.isArray(t[0])||(t=[t]),L=0;L<t.length;L+=1)if(S=t[L],b=a.isConvex(S),y=!b,y&&!E&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),b||!E)b?S=a.clockwiseSort(S):S=a.hull(S),x.push({position:{x:f,y:u},vertices:S});else{var I=S.map(function(G){return[G.x,G.y]});T.makeCCW(I),h!==!1&&T.removeCollinearPoints(I,h),C!==!1&&T.removeDuplicatePoints&&T.removeDuplicatePoints(I,C);var R=T.quickDecomp(I);for(M=0;M<R.length;M++){var O=R[M],V=O.map(function(G){return{x:G[0],y:G[1]}});w>0&&a.area(V)<w||x.push({position:a.centre(V),vertices:V})}}for(M=0;M<x.length;M++)x[M]=n.create(i.extend(x[M],c));if(l){var N=5;for(M=0;M<x.length;M++){var K=x[M];for(A=M+1;A<x.length;A++){var J=x[A];if(d.overlaps(K.bounds,J.bounds)){var Z=K.vertices,_=J.vertices;for(P=0;P<K.vertices.length;P++)for(k=0;k<J.vertices.length;k++){var Se=o.magnitudeSquared(o.sub(Z[(P+1)%Z.length],_[k])),de=o.magnitudeSquared(o.sub(Z[P],_[(k+1)%_.length]));Se<N&&de<N&&(Z[P].isInternal=!0,_[k].isInternal=!0)}}}}}return x.length>1?(g=n.create(i.extend({parts:x.slice(0)},c)),n.setPosition(g,{x:f,y:u}),g):x[0]}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(0),i=s(8);(function(){e.create=function(n){var d={bodies:[],collisions:[],pairs:null};return a.extend(d,n)},e.setBodies=function(n,d){n.bodies=d.slice(0)},e.clear=function(n){n.bodies=[],n.collisions=[]},e.collisions=function(n){var d=n.pairs,o=n.bodies,f=o.length,u=e.canCollide,t=i.collides,c=n.collisions,l=0,h,w;for(o.sort(e._compareBoundsX),h=0;h<f;h++){var C=o[h],T=C.bounds,E=C.bounds.max.x,g=C.bounds.max.y,x=C.bounds.min.y,b=C.isStatic||C.isSleeping,y=C.parts.length,S=y===1;for(w=h+1;w<f;w++){var M=o[w],A=M.bounds;if(A.min.x>E)break;if(!(g<A.min.y||x>A.max.y)&&!(b&&(M.isStatic||M.isSleeping))&&u(C.collisionFilter,M.collisionFilter)){var P=M.parts.length;if(S&&P===1){var L=t(C,M,d);L&&(c[l++]=L)}else for(var k=y>1?1:0,I=P>1?1:0,R=k;R<y;R++)for(var O=C.parts[R],T=O.bounds,V=I;V<P;V++){var N=M.parts[V],A=N.bounds;if(!(T.min.x>A.max.x||T.max.x<A.min.x||T.max.y<A.min.y||T.min.y>A.max.y)){var L=t(O,N,d);L&&(c[l++]=L)}}}}}return c.length!==l&&(c.length=l),c},e.canCollide=function(n,d){return n.group===d.group&&n.group!==0?n.group>0:(n.mask&d.category)!==0&&(d.mask&n.category)!==0},e._compareBoundsX=function(n,d){return n.bounds.min.x-d.bounds.min.x}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(0);(function(){e.create=function(i){var n={};return i||a.log("Mouse.create: element was undefined, defaulting to document.body","warn"),n.element=i||document.body,n.absolute={x:0,y:0},n.position={x:0,y:0},n.mousedownPosition={x:0,y:0},n.mouseupPosition={x:0,y:0},n.offset={x:0,y:0},n.scale={x:1,y:1},n.wheelDelta=0,n.button=-1,n.pixelRatio=parseInt(n.element.getAttribute("data-pixel-ratio"),10)||1,n.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},n.mousemove=function(d){var o=e._getRelativeMousePosition(d,n.element,n.pixelRatio),f=d.changedTouches;f&&(n.button=0,d.preventDefault()),n.absolute.x=o.x,n.absolute.y=o.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.sourceEvents.mousemove=d},n.mousedown=function(d){var o=e._getRelativeMousePosition(d,n.element,n.pixelRatio),f=d.changedTouches;f?(n.button=0,d.preventDefault()):n.button=d.button,n.absolute.x=o.x,n.absolute.y=o.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mousedownPosition.x=n.position.x,n.mousedownPosition.y=n.position.y,n.sourceEvents.mousedown=d},n.mouseup=function(d){var o=e._getRelativeMousePosition(d,n.element,n.pixelRatio),f=d.changedTouches;f&&d.preventDefault(),n.button=-1,n.absolute.x=o.x,n.absolute.y=o.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mouseupPosition.x=n.position.x,n.mouseupPosition.y=n.position.y,n.sourceEvents.mouseup=d},n.mousewheel=function(d){n.wheelDelta=Math.max(-1,Math.min(1,d.wheelDelta||-d.detail)),d.preventDefault(),n.sourceEvents.mousewheel=d},e.setElement(n,n.element),n},e.setElement=function(i,n){i.element=n,n.addEventListener("mousemove",i.mousemove,{passive:!0}),n.addEventListener("mousedown",i.mousedown,{passive:!0}),n.addEventListener("mouseup",i.mouseup,{passive:!0}),n.addEventListener("wheel",i.mousewheel,{passive:!1}),n.addEventListener("touchmove",i.mousemove,{passive:!1}),n.addEventListener("touchstart",i.mousedown,{passive:!1}),n.addEventListener("touchend",i.mouseup,{passive:!1})},e.clearSourceEvents=function(i){i.sourceEvents.mousemove=null,i.sourceEvents.mousedown=null,i.sourceEvents.mouseup=null,i.sourceEvents.mousewheel=null,i.wheelDelta=0},e.setOffset=function(i,n){i.offset.x=n.x,i.offset.y=n.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e.setScale=function(i,n){i.scale.x=n.x,i.scale.y=n.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e._getRelativeMousePosition=function(i,n,d){var o=n.getBoundingClientRect(),f=document.documentElement||document.body.parentNode||document.body,u=window.pageXOffset!==void 0?window.pageXOffset:f.scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:f.scrollTop,c=i.changedTouches,l,h;return c?(l=c[0].pageX-o.left-u,h=c[0].pageY-o.top-t):(l=i.pageX-o.left-u,h=i.pageY-o.top-t),{x:l/(n.clientWidth/(n.width||n.clientWidth)*d),y:h/(n.clientHeight/(n.height||n.clientHeight)*d)}}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(0);(function(){e._registry={},e.register=function(i){if(e.isPlugin(i)||a.warn("Plugin.register:",e.toString(i),"does not implement all required fields."),i.name in e._registry){var n=e._registry[i.name],d=e.versionParse(i.version).number,o=e.versionParse(n.version).number;d>o?(a.warn("Plugin.register:",e.toString(n),"was upgraded to",e.toString(i)),e._registry[i.name]=i):d<o?a.warn("Plugin.register:",e.toString(n),"can not be downgraded to",e.toString(i)):i!==n&&a.warn("Plugin.register:",e.toString(i),"is already registered to different plugin object")}else e._registry[i.name]=i;return i},e.resolve=function(i){return e._registry[e.dependencyParse(i).name]},e.toString=function(i){return typeof i=="string"?i:(i.name||"anonymous")+"@"+(i.version||i.range||"0.0.0")},e.isPlugin=function(i){return i&&i.name&&i.version&&i.install},e.isUsed=function(i,n){return i.used.indexOf(n)>-1},e.isFor=function(i,n){var d=i.for&&e.dependencyParse(i.for);return!i.for||n.name===d.name&&e.versionSatisfies(n.version,d.range)},e.use=function(i,n){if(i.uses=(i.uses||[]).concat(n||[]),i.uses.length===0){a.warn("Plugin.use:",e.toString(i),"does not specify any dependencies to install.");return}for(var d=e.dependencies(i),o=a.topologicalSort(d),f=[],u=0;u<o.length;u+=1)if(o[u]!==i.name){var t=e.resolve(o[u]);if(!t){f.push("âŒ "+o[u]);continue}e.isUsed(i,t.name)||(e.isFor(t,i)||(a.warn("Plugin.use:",e.toString(t),"is for",t.for,"but installed on",e.toString(i)+"."),t._warned=!0),t.install?t.install(i):(a.warn("Plugin.use:",e.toString(t),"does not specify an install function."),t._warned=!0),t._warned?(f.push("ðŸ”¶ "+e.toString(t)),delete t._warned):f.push("âœ… "+e.toString(t)),i.used.push(t.name))}f.length>0&&a.info(f.join("  "))},e.dependencies=function(i,n){var d=e.dependencyParse(i),o=d.name;if(n=n||{},!(o in n)){i=e.resolve(i)||i,n[o]=a.map(i.uses||[],function(u){e.isPlugin(u)&&e.register(u);var t=e.dependencyParse(u),c=e.resolve(u);return c&&!e.versionSatisfies(c.version,t.range)?(a.warn("Plugin.dependencies:",e.toString(c),"does not satisfy",e.toString(t),"used by",e.toString(d)+"."),c._warned=!0,i._warned=!0):c||(a.warn("Plugin.dependencies:",e.toString(u),"used by",e.toString(d),"could not be resolved."),i._warned=!0),t.name});for(var f=0;f<n[o].length;f+=1)e.dependencies(n[o][f],n);return n}},e.dependencyParse=function(i){if(a.isString(i)){var n=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return n.test(i)||a.warn("Plugin.dependencyParse:",i,"is not a valid dependency string."),{name:i.split("@")[0],range:i.split("@")[1]||"*"}}return{name:i.name,range:i.range||i.version}},e.versionParse=function(i){var n=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;n.test(i)||a.warn("Plugin.versionParse:",i,"is not a valid version or range.");var d=n.exec(i),o=Number(d[4]),f=Number(d[5]),u=Number(d[6]);return{isRange:!!(d[1]||d[2]),version:d[3],range:i,operator:d[1]||d[2]||"",major:o,minor:f,patch:u,parts:[o,f,u],prerelease:d[7],number:o*1e8+f*1e4+u}},e.versionSatisfies=function(i,n){n=n||"*";var d=e.versionParse(n),o=e.versionParse(i);if(d.isRange){if(d.operator==="*"||i==="*")return!0;if(d.operator===">")return o.number>d.number;if(d.operator===">=")return o.number>=d.number;if(d.operator==="~")return o.major===d.major&&o.minor===d.minor&&o.patch>=d.patch;if(d.operator==="^")return d.major>0?o.major===d.major&&o.number>=d.number:d.minor>0?o.minor===d.minor&&o.patch>=d.patch:o.patch===d.patch}return i===n||i==="*"}})()}),(function(m,v){var s={};m.exports=s,(function(){s.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(7),i=s(18),n=s(13),d=s(19),o=s(5),f=s(6),u=s(10),t=s(0),c=s(4);(function(){e._deltaMax=1e3/60,e.create=function(l){l=l||{};var h={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},w=t.extend(h,l);return w.world=l.world||f.create({label:"World"}),w.pairs=l.pairs||d.create(),w.detector=l.detector||n.create(),w.detector.pairs=w.pairs,w.grid={buckets:[]},w.world.gravity=w.gravity,w.broadphase=w.grid,w.metrics={},w},e.update=function(l,h){var w=t.now(),C=l.world,T=l.detector,E=l.pairs,g=l.timing,x=g.timestamp,b;h>e._deltaMax&&t.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",e._deltaMax.toFixed(3),"ms."),h=typeof h<"u"?h:t._baseDelta,h*=g.timeScale,g.timestamp+=h,g.lastDelta=h;var y={timestamp:g.timestamp,delta:h};o.trigger(l,"beforeUpdate",y);var S=f.allBodies(C),M=f.allConstraints(C);for(C.isModified&&(n.setBodies(T,S),f.setModified(C,!1,!1,!0)),l.enableSleeping&&a.update(S,h),e._bodiesApplyGravity(S,l.gravity),h>0&&e._bodiesUpdate(S,h),o.trigger(l,"beforeSolve",y),u.preSolveAll(S),b=0;b<l.constraintIterations;b++)u.solveAll(M,h);u.postSolveAll(S);var A=n.collisions(T);d.update(E,A,x),l.enableSleeping&&a.afterCollisions(E.list),E.collisionStart.length>0&&o.trigger(l,"collisionStart",{pairs:E.collisionStart,timestamp:g.timestamp,delta:h});var P=t.clamp(20/l.positionIterations,0,1);for(i.preSolvePosition(E.list),b=0;b<l.positionIterations;b++)i.solvePosition(E.list,h,P);for(i.postSolvePosition(S),u.preSolveAll(S),b=0;b<l.constraintIterations;b++)u.solveAll(M,h);for(u.postSolveAll(S),i.preSolveVelocity(E.list),b=0;b<l.velocityIterations;b++)i.solveVelocity(E.list,h);return e._bodiesUpdateVelocities(S),E.collisionActive.length>0&&o.trigger(l,"collisionActive",{pairs:E.collisionActive,timestamp:g.timestamp,delta:h}),E.collisionEnd.length>0&&o.trigger(l,"collisionEnd",{pairs:E.collisionEnd,timestamp:g.timestamp,delta:h}),e._bodiesClearForces(S),o.trigger(l,"afterUpdate",y),l.timing.lastElapsed=t.now()-w,l},e.merge=function(l,h){if(t.extend(l,h),h.world){l.world=h.world,e.clear(l);for(var w=f.allBodies(l.world),C=0;C<w.length;C++){var T=w[C];a.set(T,!1),T.id=t.nextId()}}},e.clear=function(l){d.clear(l.pairs),n.clear(l.detector)},e._bodiesClearForces=function(l){for(var h=l.length,w=0;w<h;w++){var C=l[w];C.force.x=0,C.force.y=0,C.torque=0}},e._bodiesApplyGravity=function(l,h){var w=typeof h.scale<"u"?h.scale:.001,C=l.length;if(!(h.x===0&&h.y===0||w===0))for(var T=0;T<C;T++){var E=l[T];E.isStatic||E.isSleeping||(E.force.y+=E.mass*h.y*w,E.force.x+=E.mass*h.x*w)}},e._bodiesUpdate=function(l,h){for(var w=l.length,C=0;C<w;C++){var T=l[C];T.isStatic||T.isSleeping||c.update(T,h)}},e._bodiesUpdateVelocities=function(l){for(var h=l.length,w=0;w<h;w++)c.updateVelocities(l[w])}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(3),i=s(0),n=s(1);(function(){e._restingThresh=2,e._restingThreshTangent=Math.sqrt(6),e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e._frictionMaxStatic=Number.MAX_VALUE,e.preSolvePosition=function(d){var o,f,u,t=d.length;for(o=0;o<t;o++)f=d[o],f.isActive&&(u=f.contactCount,f.collision.parentA.totalContacts+=u,f.collision.parentB.totalContacts+=u)},e.solvePosition=function(d,o,f){var u,t,c,l,h,w,C,T,E=e._positionDampen*(f||1),g=i.clamp(o/i._baseDelta,0,1),x=d.length;for(u=0;u<x;u++)t=d[u],!(!t.isActive||t.isSensor)&&(c=t.collision,l=c.parentA,h=c.parentB,w=c.normal,t.separation=c.depth+w.x*(h.positionImpulse.x-l.positionImpulse.x)+w.y*(h.positionImpulse.y-l.positionImpulse.y));for(u=0;u<x;u++)t=d[u],!(!t.isActive||t.isSensor)&&(c=t.collision,l=c.parentA,h=c.parentB,w=c.normal,T=t.separation-t.slop*g,(l.isStatic||h.isStatic)&&(T*=2),l.isStatic||l.isSleeping||(C=E/l.totalContacts,l.positionImpulse.x+=w.x*T*C,l.positionImpulse.y+=w.y*T*C),h.isStatic||h.isSleeping||(C=E/h.totalContacts,h.positionImpulse.x-=w.x*T*C,h.positionImpulse.y-=w.y*T*C))},e.postSolvePosition=function(d){for(var o=e._positionWarming,f=d.length,u=a.translate,t=n.update,c=0;c<f;c++){var l=d[c],h=l.positionImpulse,w=h.x,C=h.y,T=l.velocity;if(l.totalContacts=0,w!==0||C!==0){for(var E=0;E<l.parts.length;E++){var g=l.parts[E];u(g.vertices,h),t(g.bounds,g.vertices,T),g.position.x+=w,g.position.y+=C}l.positionPrev.x+=w,l.positionPrev.y+=C,w*T.x+C*T.y<0?(h.x=0,h.y=0):(h.x*=o,h.y*=o)}}},e.preSolveVelocity=function(d){var o=d.length,f,u;for(f=0;f<o;f++){var t=d[f];if(!(!t.isActive||t.isSensor)){var c=t.contacts,l=t.contactCount,h=t.collision,w=h.parentA,C=h.parentB,T=h.normal,E=h.tangent;for(u=0;u<l;u++){var g=c[u],x=g.vertex,b=g.normalImpulse,y=g.tangentImpulse;if(b!==0||y!==0){var S=T.x*b+E.x*y,M=T.y*b+E.y*y;w.isStatic||w.isSleeping||(w.positionPrev.x+=S*w.inverseMass,w.positionPrev.y+=M*w.inverseMass,w.anglePrev+=w.inverseInertia*((x.x-w.position.x)*M-(x.y-w.position.y)*S)),C.isStatic||C.isSleeping||(C.positionPrev.x-=S*C.inverseMass,C.positionPrev.y-=M*C.inverseMass,C.anglePrev-=C.inverseInertia*((x.x-C.position.x)*M-(x.y-C.position.y)*S))}}}}},e.solveVelocity=function(d,o){var f=o/i._baseDelta,u=f*f,t=u*f,c=-e._restingThresh*f,l=e._restingThreshTangent,h=e._frictionNormalMultiplier*f,w=e._frictionMaxStatic,C=d.length,T,E,g,x;for(g=0;g<C;g++){var b=d[g];if(!(!b.isActive||b.isSensor)){var y=b.collision,S=y.parentA,M=y.parentB,A=y.normal.x,P=y.normal.y,L=y.tangent.x,k=y.tangent.y,I=b.inverseMass,R=b.friction*b.frictionStatic*h,O=b.contacts,V=b.contactCount,N=1/V,K=S.position.x-S.positionPrev.x,J=S.position.y-S.positionPrev.y,Z=S.angle-S.anglePrev,_=M.position.x-M.positionPrev.x,Se=M.position.y-M.positionPrev.y,de=M.angle-M.anglePrev;for(x=0;x<V;x++){var G=O[x],Le=G.vertex,le=Le.x-S.position.x,Ye=Le.y-S.position.y,Ie=Le.x-M.position.x,Me=Le.y-M.position.y,ge=K-Ye*Z,pn=J+le*Z,dn=_-Me*de,hn=Se+Ie*de,He=ge-dn,Tt=pn-hn,pt=A*He+P*Tt,$e=L*He+k*Tt,Vt=b.separation+pt,ze=Math.min(Vt,1);ze=Vt<0?0:ze;var At=ze*R;$e<-At||$e>At?(E=$e>0?$e:-$e,T=b.friction*($e>0?1:-1)*t,T<-E?T=-E:T>E&&(T=E)):(T=$e,E=w);var at=le*P-Ye*A,Ht=Ie*P-Me*A,Ue=N/(I+S.inverseInertia*at*at+M.inverseInertia*Ht*Ht),dt=(1+b.restitution)*pt*Ue;if(T*=Ue,pt<c)G.normalImpulse=0;else{var Et=G.normalImpulse;G.normalImpulse+=dt,G.normalImpulse>0&&(G.normalImpulse=0),dt=G.normalImpulse-Et}if($e<-l||$e>l)G.tangentImpulse=0;else{var mn=G.tangentImpulse;G.tangentImpulse+=T,G.tangentImpulse<-E&&(G.tangentImpulse=-E),G.tangentImpulse>E&&(G.tangentImpulse=E),T=G.tangentImpulse-mn}var ht=A*dt+L*T,mt=P*dt+k*T;S.isStatic||S.isSleeping||(S.positionPrev.x+=ht*S.inverseMass,S.positionPrev.y+=mt*S.inverseMass,S.anglePrev+=(le*mt-Ye*ht)*S.inverseInertia),M.isStatic||M.isSleeping||(M.positionPrev.x-=ht*M.inverseMass,M.positionPrev.y-=mt*M.inverseMass,M.anglePrev-=(Ie*mt-Me*ht)*M.inverseInertia)}}}}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(9),i=s(0);(function(){e.create=function(n){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},n)},e.update=function(n,d,o){var f=a.update,u=a.create,t=a.setActive,c=n.table,l=n.list,h=l.length,w=h,C=n.collisionStart,T=n.collisionEnd,E=n.collisionActive,g=d.length,x=0,b=0,y=0,S,M,A;for(A=0;A<g;A++)S=d[A],M=S.pair,M?(M.isActive&&(E[y++]=M),f(M,S,o)):(M=u(S,o),c[M.id]=M,C[x++]=M,l[w++]=M);for(w=0,h=l.length,A=0;A<h;A++)M=l[A],M.timeUpdated>=o?l[w++]=M:(t(M,!1,o),M.collision.bodyA.sleepCounter>0&&M.collision.bodyB.sleepCounter>0?l[w++]=M:(T[b++]=M,delete c[M.id]));l.length!==w&&(l.length=w),C.length!==x&&(C.length=x),T.length!==b&&(T.length=b),E.length!==y&&(E.length=y)},e.clear=function(n){return n.table={},n.list.length=0,n.collisionStart.length=0,n.collisionActive.length=0,n.collisionEnd.length=0,n}})()}),(function(m,v,s){var e=m.exports=s(21);e.Axes=s(11),e.Bodies=s(12),e.Body=s(4),e.Bounds=s(1),e.Collision=s(8),e.Common=s(0),e.Composite=s(6),e.Composites=s(22),e.Constraint=s(10),e.Contact=s(16),e.Detector=s(13),e.Engine=s(17),e.Events=s(5),e.Grid=s(23),e.Mouse=s(14),e.MouseConstraint=s(24),e.Pair=s(9),e.Pairs=s(19),e.Plugin=s(15),e.Query=s(25),e.Render=s(26),e.Resolver=s(18),e.Runner=s(27),e.SAT=s(28),e.Sleeping=s(7),e.Svg=s(29),e.Vector=s(2),e.Vertices=s(3),e.World=s(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run âž¤ use Matter.Runner.run(engine) instead")}),(function(m,v,s){var e={};m.exports=e;var a=s(15),i=s(0);(function(){e.name="matter-js",e.version="0.20.0",e.uses=[],e.used=[],e.use=function(){a.use(e,Array.prototype.slice.call(arguments))},e.before=function(n,d){return n=n.replace(/^Matter./,""),i.chainPathBefore(e,n,d)},e.after=function(n,d){return n=n.replace(/^Matter./,""),i.chainPathAfter(e,n,d)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(6),i=s(10),n=s(0),d=s(4),o=s(12),f=n.deprecated;(function(){e.stack=function(u,t,c,l,h,w,C){for(var T=a.create({label:"Stack"}),E=u,g=t,x,b=0,y=0;y<l;y++){for(var S=0,M=0;M<c;M++){var A=C(E,g,M,y,x,b);if(A){var P=A.bounds.max.y-A.bounds.min.y,L=A.bounds.max.x-A.bounds.min.x;P>S&&(S=P),d.translate(A,{x:L*.5,y:P*.5}),E=A.bounds.max.x+h,a.addBody(T,A),x=A,b+=1}else E+=h}g+=S+w,E=u}return T},e.chain=function(u,t,c,l,h,w){for(var C=u.bodies,T=1;T<C.length;T++){var E=C[T-1],g=C[T],x=E.bounds.max.y-E.bounds.min.y,b=E.bounds.max.x-E.bounds.min.x,y=g.bounds.max.y-g.bounds.min.y,S=g.bounds.max.x-g.bounds.min.x,M={bodyA:E,pointA:{x:b*t,y:x*c},bodyB:g,pointB:{x:S*l,y:y*h}},A=n.extend(M,w);a.addConstraint(u,i.create(A))}return u.label+=" Chain",u},e.mesh=function(u,t,c,l,h){var w=u.bodies,C,T,E,g,x;for(C=0;C<c;C++){for(T=1;T<t;T++)E=w[T-1+C*t],g=w[T+C*t],a.addConstraint(u,i.create(n.extend({bodyA:E,bodyB:g},h)));if(C>0)for(T=0;T<t;T++)E=w[T+(C-1)*t],g=w[T+C*t],a.addConstraint(u,i.create(n.extend({bodyA:E,bodyB:g},h))),l&&T>0&&(x=w[T-1+(C-1)*t],a.addConstraint(u,i.create(n.extend({bodyA:x,bodyB:g},h)))),l&&T<t-1&&(x=w[T+1+(C-1)*t],a.addConstraint(u,i.create(n.extend({bodyA:x,bodyB:g},h))))}return u.label+=" Mesh",u},e.pyramid=function(u,t,c,l,h,w,C){return e.stack(u,t,c,l,h,w,function(T,E,g,x,b,y){var S=Math.min(l,Math.ceil(c/2)),M=b?b.bounds.max.x-b.bounds.min.x:0;if(!(x>S)){x=S-x;var A=x,P=c-1-x;if(!(g<A||g>P)){y===1&&d.translate(b,{x:(g+(c%2===1?1:-1))*M,y:0});var L=b?g*M:0;return C(u+L+g*h,E,g,x,b,y)}}})},e.newtonsCradle=function(u,t,c,l,h){for(var w=a.create({label:"Newtons Cradle"}),C=0;C<c;C++){var T=1.9,E=o.circle(u+C*(l*T),t+h,l,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),g=i.create({pointA:{x:u+C*(l*T),y:t},bodyB:E});a.addBody(w,E),a.addConstraint(w,g)}return w},f(e,"newtonsCradle","Composites.newtonsCradle âž¤ moved to newtonsCradle example"),e.car=function(u,t,c,l,h){var w=d.nextGroup(!0),C=20,T=-c*.5+C,E=c*.5-C,g=0,x=a.create({label:"Car"}),b=o.rectangle(u,t,c,l,{collisionFilter:{group:w},chamfer:{radius:l*.5},density:2e-4}),y=o.circle(u+T,t+g,h,{collisionFilter:{group:w},friction:.8}),S=o.circle(u+E,t+g,h,{collisionFilter:{group:w},friction:.8}),M=i.create({bodyB:b,pointB:{x:T,y:g},bodyA:y,stiffness:1,length:0}),A=i.create({bodyB:b,pointB:{x:E,y:g},bodyA:S,stiffness:1,length:0});return a.addBody(x,b),a.addBody(x,y),a.addBody(x,S),a.addConstraint(x,M),a.addConstraint(x,A),x},f(e,"car","Composites.car âž¤ moved to car example"),e.softBody=function(u,t,c,l,h,w,C,T,E,g){E=n.extend({inertia:1/0},E),g=n.extend({stiffness:.2,render:{type:"line",anchors:!1}},g);var x=e.stack(u,t,c,l,h,w,function(b,y){return o.circle(b,y,T,E)});return e.mesh(x,c,l,C,g),x.label="Soft Body",x},f(e,"softBody","Composites.softBody âž¤ moved to softBody and cloth examples")})()}),(function(m,v,s){var e={};m.exports=e;var a=s(9),i=s(0),n=i.deprecated;(function(){e.create=function(d){var o={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(o,d)},e.update=function(d,o,f,u){var t,c,l,h=f.world,w=d.buckets,C,T,E=!1;for(t=0;t<o.length;t++){var g=o[t];if(!(g.isSleeping&&!u)&&!(h.bounds&&(g.bounds.max.x<h.bounds.min.x||g.bounds.min.x>h.bounds.max.x||g.bounds.max.y<h.bounds.min.y||g.bounds.min.y>h.bounds.max.y))){var x=e._getRegion(d,g);if(!g.region||x.id!==g.region.id||u){(!g.region||u)&&(g.region=x);var b=e._regionUnion(x,g.region);for(c=b.startCol;c<=b.endCol;c++)for(l=b.startRow;l<=b.endRow;l++){T=e._getBucketId(c,l),C=w[T];var y=c>=x.startCol&&c<=x.endCol&&l>=x.startRow&&l<=x.endRow,S=c>=g.region.startCol&&c<=g.region.endCol&&l>=g.region.startRow&&l<=g.region.endRow;!y&&S&&S&&C&&e._bucketRemoveBody(d,C,g),(g.region===x||y&&!S||u)&&(C||(C=e._createBucket(w,T)),e._bucketAddBody(d,C,g))}g.region=x,E=!0}}}E&&(d.pairsList=e._createActivePairsList(d))},n(e,"update","Grid.update âž¤ replaced by Matter.Detector"),e.clear=function(d){d.buckets={},d.pairs={},d.pairsList=[]},n(e,"clear","Grid.clear âž¤ replaced by Matter.Detector"),e._regionUnion=function(d,o){var f=Math.min(d.startCol,o.startCol),u=Math.max(d.endCol,o.endCol),t=Math.min(d.startRow,o.startRow),c=Math.max(d.endRow,o.endRow);return e._createRegion(f,u,t,c)},e._getRegion=function(d,o){var f=o.bounds,u=Math.floor(f.min.x/d.bucketWidth),t=Math.floor(f.max.x/d.bucketWidth),c=Math.floor(f.min.y/d.bucketHeight),l=Math.floor(f.max.y/d.bucketHeight);return e._createRegion(u,t,c,l)},e._createRegion=function(d,o,f,u){return{id:d+","+o+","+f+","+u,startCol:d,endCol:o,startRow:f,endRow:u}},e._getBucketId=function(d,o){return"C"+d+"R"+o},e._createBucket=function(d,o){var f=d[o]=[];return f},e._bucketAddBody=function(d,o,f){var u=d.pairs,t=a.id,c=o.length,l;for(l=0;l<c;l++){var h=o[l];if(!(f.id===h.id||f.isStatic&&h.isStatic)){var w=t(f,h),C=u[w];C?C[2]+=1:u[w]=[f,h,1]}}o.push(f)},e._bucketRemoveBody=function(d,o,f){var u=d.pairs,t=a.id,c;o.splice(i.indexOf(o,f),1);var l=o.length;for(c=0;c<l;c++){var h=u[t(f,o[c])];h&&(h[2]-=1)}},e._createActivePairsList=function(d){var o,f=d.pairs,u=i.keys(f),t=u.length,c=[],l;for(l=0;l<t;l++)o=f[u[l]],o[2]>0?c.push(o):delete f[u[l]];return c}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(3),i=s(7),n=s(14),d=s(5),o=s(13),f=s(10),u=s(6),t=s(0),c=s(1);(function(){e.create=function(l,h){var w=(l?l.mouse:null)||(h?h.mouse:null);w||(l&&l.render&&l.render.canvas?w=n.create(l.render.canvas):h&&h.element?w=n.create(h.element):(w=n.create(),t.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var C=f.create({label:"Mouse Constraint",pointA:w.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),T={type:"mouseConstraint",mouse:w,element:null,body:null,constraint:C,collisionFilter:{category:1,mask:4294967295,group:0}},E=t.extend(T,h);return d.on(l,"beforeUpdate",function(){var g=u.allBodies(l.world);e.update(E,g),e._triggerEvents(E)}),E},e.update=function(l,h){var w=l.mouse,C=l.constraint,T=l.body;if(w.button===0){if(C.bodyB)i.set(C.bodyB,!1),C.pointA=w.position;else for(var E=0;E<h.length;E++)if(T=h[E],c.contains(T.bounds,w.position)&&o.canCollide(T.collisionFilter,l.collisionFilter))for(var g=T.parts.length>1?1:0;g<T.parts.length;g++){var x=T.parts[g];if(a.contains(x.vertices,w.position)){C.pointA=w.position,C.bodyB=l.body=T,C.pointB={x:w.position.x-T.position.x,y:w.position.y-T.position.y},C.angleB=T.angle,i.set(T,!1),d.trigger(l,"startdrag",{mouse:w,body:T});break}}}else C.bodyB=l.body=null,C.pointB=null,T&&d.trigger(l,"enddrag",{mouse:w,body:T})},e._triggerEvents=function(l){var h=l.mouse,w=h.sourceEvents;w.mousemove&&d.trigger(l,"mousemove",{mouse:h}),w.mousedown&&d.trigger(l,"mousedown",{mouse:h}),w.mouseup&&d.trigger(l,"mouseup",{mouse:h}),n.clearSourceEvents(h)}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(2),i=s(8),n=s(1),d=s(12),o=s(3);(function(){e.collides=function(f,u){for(var t=[],c=u.length,l=f.bounds,h=i.collides,w=n.overlaps,C=0;C<c;C++){var T=u[C],E=T.parts.length,g=E===1?0:1;if(w(T.bounds,l))for(var x=g;x<E;x++){var b=T.parts[x];if(w(b.bounds,l)){var y=h(b,f);if(y){t.push(y);break}}}}return t},e.ray=function(f,u,t,c){c=c||1e-100;for(var l=a.angle(u,t),h=a.magnitude(a.sub(u,t)),w=(t.x+u.x)*.5,C=(t.y+u.y)*.5,T=d.rectangle(w,C,h,c,{angle:l}),E=e.collides(T,f),g=0;g<E.length;g+=1){var x=E[g];x.body=x.bodyB=x.bodyA}return E},e.region=function(f,u,t){for(var c=[],l=0;l<f.length;l++){var h=f[l],w=n.overlaps(h.bounds,u);(w&&!t||!w&&t)&&c.push(h)}return c},e.point=function(f,u){for(var t=[],c=0;c<f.length;c++){var l=f[c];if(n.contains(l.bounds,u))for(var h=l.parts.length===1?0:1;h<l.parts.length;h++){var w=l.parts[h];if(n.contains(w.bounds,u)&&o.contains(w.vertices,u)){t.push(l);break}}}return t}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(4),i=s(0),n=s(6),d=s(1),o=s(5),f=s(2),u=s(14);(function(){var t,c;typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(g){window.setTimeout(function(){g(i.now())},1e3/60)},c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(g){var x={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!g.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},b=i.extend(x,g);return b.canvas&&(b.canvas.width=b.options.width||b.canvas.width,b.canvas.height=b.options.height||b.canvas.height),b.mouse=g.mouse,b.engine=g.engine,b.canvas=b.canvas||w(b.options.width,b.options.height),b.context=b.canvas.getContext("2d"),b.textures={},b.bounds=b.bounds||{min:{x:0,y:0},max:{x:b.canvas.width,y:b.canvas.height}},b.controller=e,b.options.showBroadphase=!1,b.options.pixelRatio!==1&&e.setPixelRatio(b,b.options.pixelRatio),i.isElement(b.element)&&b.element.appendChild(b.canvas),b},e.run=function(g){(function x(b){g.frameRequestId=t(x),l(g,b),e.world(g,b),g.context.setTransform(g.options.pixelRatio,0,0,g.options.pixelRatio,0,0),(g.options.showStats||g.options.showDebug)&&e.stats(g,g.context,b),(g.options.showPerformance||g.options.showDebug)&&e.performance(g,g.context,b),g.context.setTransform(1,0,0,1,0,0)})()},e.stop=function(g){c(g.frameRequestId)},e.setPixelRatio=function(g,x){var b=g.options,y=g.canvas;x==="auto"&&(x=C(y)),b.pixelRatio=x,y.setAttribute("data-pixel-ratio",x),y.width=b.width*x,y.height=b.height*x,y.style.width=b.width+"px",y.style.height=b.height+"px"},e.setSize=function(g,x,b){g.options.width=x,g.options.height=b,g.bounds.max.x=g.bounds.min.x+x,g.bounds.max.y=g.bounds.min.y+b,g.options.pixelRatio!==1?e.setPixelRatio(g,g.options.pixelRatio):(g.canvas.width=x,g.canvas.height=b)},e.lookAt=function(g,x,b,y){y=typeof y<"u"?y:!0,x=i.isArray(x)?x:[x],b=b||{x:0,y:0};for(var S={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},M=0;M<x.length;M+=1){var A=x[M],P=A.bounds?A.bounds.min:A.min||A.position||A,L=A.bounds?A.bounds.max:A.max||A.position||A;P&&L&&(P.x<S.min.x&&(S.min.x=P.x),L.x>S.max.x&&(S.max.x=L.x),P.y<S.min.y&&(S.min.y=P.y),L.y>S.max.y&&(S.max.y=L.y))}var k=S.max.x-S.min.x+2*b.x,I=S.max.y-S.min.y+2*b.y,R=g.canvas.height,O=g.canvas.width,V=O/R,N=k/I,K=1,J=1;N>V?J=N/V:K=V/N,g.options.hasBounds=!0,g.bounds.min.x=S.min.x,g.bounds.max.x=S.min.x+k*K,g.bounds.min.y=S.min.y,g.bounds.max.y=S.min.y+I*J,y&&(g.bounds.min.x+=k*.5-k*K*.5,g.bounds.max.x+=k*.5-k*K*.5,g.bounds.min.y+=I*.5-I*J*.5,g.bounds.max.y+=I*.5-I*J*.5),g.bounds.min.x-=b.x,g.bounds.max.x-=b.x,g.bounds.min.y-=b.y,g.bounds.max.y-=b.y,g.mouse&&(u.setScale(g.mouse,{x:(g.bounds.max.x-g.bounds.min.x)/g.canvas.width,y:(g.bounds.max.y-g.bounds.min.y)/g.canvas.height}),u.setOffset(g.mouse,g.bounds.min))},e.startViewTransform=function(g){var x=g.bounds.max.x-g.bounds.min.x,b=g.bounds.max.y-g.bounds.min.y,y=x/g.options.width,S=b/g.options.height;g.context.setTransform(g.options.pixelRatio/y,0,0,g.options.pixelRatio/S,0,0),g.context.translate(-g.bounds.min.x,-g.bounds.min.y)},e.endViewTransform=function(g){g.context.setTransform(g.options.pixelRatio,0,0,g.options.pixelRatio,0,0)},e.world=function(g,x){var b=i.now(),y=g.engine,S=y.world,M=g.canvas,A=g.context,P=g.options,L=g.timing,k=n.allBodies(S),I=n.allConstraints(S),R=P.wireframes?P.wireframeBackground:P.background,O=[],V=[],N,K={timestamp:y.timing.timestamp};if(o.trigger(g,"beforeRender",K),g.currentBackground!==R&&E(g,R),A.globalCompositeOperation="source-in",A.fillStyle="transparent",A.fillRect(0,0,M.width,M.height),A.globalCompositeOperation="source-over",P.hasBounds){for(N=0;N<k.length;N++){var J=k[N];d.overlaps(J.bounds,g.bounds)&&O.push(J)}for(N=0;N<I.length;N++){var Z=I[N],_=Z.bodyA,Se=Z.bodyB,de=Z.pointA,G=Z.pointB;_&&(de=f.add(_.position,Z.pointA)),Se&&(G=f.add(Se.position,Z.pointB)),!(!de||!G)&&(d.contains(g.bounds,de)||d.contains(g.bounds,G))&&V.push(Z)}e.startViewTransform(g),g.mouse&&(u.setScale(g.mouse,{x:(g.bounds.max.x-g.bounds.min.x)/g.options.width,y:(g.bounds.max.y-g.bounds.min.y)/g.options.height}),u.setOffset(g.mouse,g.bounds.min))}else V=I,O=k,g.options.pixelRatio!==1&&g.context.setTransform(g.options.pixelRatio,0,0,g.options.pixelRatio,0,0);!P.wireframes||y.enableSleeping&&P.showSleeping?e.bodies(g,O,A):(P.showConvexHulls&&e.bodyConvexHulls(g,O,A),e.bodyWireframes(g,O,A)),P.showBounds&&e.bodyBounds(g,O,A),(P.showAxes||P.showAngleIndicator)&&e.bodyAxes(g,O,A),P.showPositions&&e.bodyPositions(g,O,A),P.showVelocity&&e.bodyVelocity(g,O,A),P.showIds&&e.bodyIds(g,O,A),P.showSeparations&&e.separations(g,y.pairs.list,A),P.showCollisions&&e.collisions(g,y.pairs.list,A),P.showVertexNumbers&&e.vertexNumbers(g,O,A),P.showMousePosition&&e.mousePosition(g,g.mouse,A),e.constraints(V,A),P.hasBounds&&e.endViewTransform(g),o.trigger(g,"afterRender",K),L.lastElapsed=i.now()-b},e.stats=function(g,x,b){for(var y=g.engine,S=y.world,M=n.allBodies(S),A=0,P=55,L=44,k=0,I=0,R=0;R<M.length;R+=1)A+=M[R].parts.length;var O={Part:A,Body:M.length,Cons:n.allConstraints(S).length,Comp:n.allComposites(S).length,Pair:y.pairs.list.length};x.fillStyle="#0e0f19",x.fillRect(k,I,P*5.5,L),x.font="12px Arial",x.textBaseline="top",x.textAlign="right";for(var V in O){var N=O[V];x.fillStyle="#aaa",x.fillText(V,k+P,I+8),x.fillStyle="#eee",x.fillText(N,k+P,I+26),k+=P}},e.performance=function(g,x){var b=g.engine,y=g.timing,S=y.deltaHistory,M=y.elapsedHistory,A=y.timestampElapsedHistory,P=y.engineDeltaHistory,L=y.engineUpdatesHistory,k=y.engineElapsedHistory,I=b.timing.lastUpdatesPerFrame,R=b.timing.lastDelta,O=h(S),V=h(M),N=h(P),K=h(L),J=h(k),Z=h(A),_=Z/O||0,Se=Math.round(O/R),de=1e3/O||0,G=4,Le=12,le=60,Ye=34,Ie=10,Me=69;x.fillStyle="#0e0f19",x.fillRect(0,50,Le*5+le*6+22,Ye),e.status(x,Ie,Me,le,G,S.length,Math.round(de)+" fps",de/e._goodFps,function(ge){return S[ge]/O-1}),e.status(x,Ie+Le+le,Me,le,G,P.length,R.toFixed(2)+" dt",e._goodDelta/R,function(ge){return P[ge]/N-1}),e.status(x,Ie+(Le+le)*2,Me,le,G,L.length,I+" upf",Math.pow(i.clamp(K/Se||1,0,1),4),function(ge){return L[ge]/K-1}),e.status(x,Ie+(Le+le)*3,Me,le,G,k.length,J.toFixed(2)+" ut",1-I*J/e._goodFps,function(ge){return k[ge]/J-1}),e.status(x,Ie+(Le+le)*4,Me,le,G,M.length,V.toFixed(2)+" rt",1-V/e._goodFps,function(ge){return M[ge]/V-1}),e.status(x,Ie+(Le+le)*5,Me,le,G,A.length,_.toFixed(2)+" x",_*_*_,function(ge){return(A[ge]/S[ge]/_||0)-1})},e.status=function(g,x,b,y,S,M,A,P,L){g.strokeStyle="#888",g.fillStyle="#444",g.lineWidth=1,g.fillRect(x,b+7,y,1),g.beginPath(),g.moveTo(x,b+7-S*i.clamp(.4*L(0),-2,2));for(var k=0;k<y;k+=1)g.lineTo(x+k,b+7-(k<M?S*i.clamp(.4*L(k),-2,2):0));g.stroke(),g.fillStyle="hsl("+i.clamp(25+95*P,0,120)+",100%,60%)",g.fillRect(x,b-7,4,4),g.font="12px Arial",g.textBaseline="middle",g.textAlign="right",g.fillStyle="#eee",g.fillText(A,x+y,b-5)},e.constraints=function(g,x){for(var b=x,y=0;y<g.length;y++){var S=g[y];if(!(!S.render.visible||!S.pointA||!S.pointB)){var M=S.bodyA,A=S.bodyB,P,L;if(M?P=f.add(M.position,S.pointA):P=S.pointA,S.render.type==="pin")b.beginPath(),b.arc(P.x,P.y,3,0,2*Math.PI),b.closePath();else{if(A?L=f.add(A.position,S.pointB):L=S.pointB,b.beginPath(),b.moveTo(P.x,P.y),S.render.type==="spring")for(var k=f.sub(L,P),I=f.perp(f.normalise(k)),R=Math.ceil(i.clamp(S.length/5,12,20)),O,V=1;V<R;V+=1)O=V%2===0?1:-1,b.lineTo(P.x+k.x*(V/R)+I.x*O*4,P.y+k.y*(V/R)+I.y*O*4);b.lineTo(L.x,L.y)}S.render.lineWidth&&(b.lineWidth=S.render.lineWidth,b.strokeStyle=S.render.strokeStyle,b.stroke()),S.render.anchors&&(b.fillStyle=S.render.strokeStyle,b.beginPath(),b.arc(P.x,P.y,3,0,2*Math.PI),b.arc(L.x,L.y,3,0,2*Math.PI),b.closePath(),b.fill())}}},e.bodies=function(g,x,b){var y=b;g.engine;var S=g.options,M=S.showInternalEdges||!S.wireframes,A,P,L,k;for(L=0;L<x.length;L++)if(A=x[L],!!A.render.visible){for(k=A.parts.length>1?1:0;k<A.parts.length;k++)if(P=A.parts[k],!!P.render.visible){if(S.showSleeping&&A.isSleeping?y.globalAlpha=.5*P.render.opacity:P.render.opacity!==1&&(y.globalAlpha=P.render.opacity),P.render.sprite&&P.render.sprite.texture&&!S.wireframes){var I=P.render.sprite,R=T(g,I.texture);y.translate(P.position.x,P.position.y),y.rotate(P.angle),y.drawImage(R,R.width*-I.xOffset*I.xScale,R.height*-I.yOffset*I.yScale,R.width*I.xScale,R.height*I.yScale),y.rotate(-P.angle),y.translate(-P.position.x,-P.position.y)}else{if(P.circleRadius)y.beginPath(),y.arc(P.position.x,P.position.y,P.circleRadius,0,2*Math.PI);else{y.beginPath(),y.moveTo(P.vertices[0].x,P.vertices[0].y);for(var O=1;O<P.vertices.length;O++)!P.vertices[O-1].isInternal||M?y.lineTo(P.vertices[O].x,P.vertices[O].y):y.moveTo(P.vertices[O].x,P.vertices[O].y),P.vertices[O].isInternal&&!M&&y.moveTo(P.vertices[(O+1)%P.vertices.length].x,P.vertices[(O+1)%P.vertices.length].y);y.lineTo(P.vertices[0].x,P.vertices[0].y),y.closePath()}S.wireframes?(y.lineWidth=1,y.strokeStyle=g.options.wireframeStrokeStyle,y.stroke()):(y.fillStyle=P.render.fillStyle,P.render.lineWidth&&(y.lineWidth=P.render.lineWidth,y.strokeStyle=P.render.strokeStyle,y.stroke()),y.fill())}y.globalAlpha=1}}},e.bodyWireframes=function(g,x,b){var y=b,S=g.options.showInternalEdges,M,A,P,L,k;for(y.beginPath(),P=0;P<x.length;P++)if(M=x[P],!!M.render.visible)for(k=M.parts.length>1?1:0;k<M.parts.length;k++){for(A=M.parts[k],y.moveTo(A.vertices[0].x,A.vertices[0].y),L=1;L<A.vertices.length;L++)!A.vertices[L-1].isInternal||S?y.lineTo(A.vertices[L].x,A.vertices[L].y):y.moveTo(A.vertices[L].x,A.vertices[L].y),A.vertices[L].isInternal&&!S&&y.moveTo(A.vertices[(L+1)%A.vertices.length].x,A.vertices[(L+1)%A.vertices.length].y);y.lineTo(A.vertices[0].x,A.vertices[0].y)}y.lineWidth=1,y.strokeStyle=g.options.wireframeStrokeStyle,y.stroke()},e.bodyConvexHulls=function(g,x,b){var y=b,S,M,A;for(y.beginPath(),M=0;M<x.length;M++)if(S=x[M],!(!S.render.visible||S.parts.length===1)){for(y.moveTo(S.vertices[0].x,S.vertices[0].y),A=1;A<S.vertices.length;A++)y.lineTo(S.vertices[A].x,S.vertices[A].y);y.lineTo(S.vertices[0].x,S.vertices[0].y)}y.lineWidth=1,y.strokeStyle="rgba(255,255,255,0.2)",y.stroke()},e.vertexNumbers=function(g,x,b){var y=b,S,M,A;for(S=0;S<x.length;S++){var P=x[S].parts;for(A=P.length>1?1:0;A<P.length;A++){var L=P[A];for(M=0;M<L.vertices.length;M++)y.fillStyle="rgba(255,255,255,0.2)",y.fillText(S+"_"+M,L.position.x+(L.vertices[M].x-L.position.x)*.8,L.position.y+(L.vertices[M].y-L.position.y)*.8)}}},e.mousePosition=function(g,x,b){var y=b;y.fillStyle="rgba(255,255,255,0.8)",y.fillText(x.position.x+"  "+x.position.y,x.position.x+5,x.position.y-5)},e.bodyBounds=function(g,x,b){var y=b;g.engine;var S=g.options;y.beginPath();for(var M=0;M<x.length;M++){var A=x[M];if(A.render.visible)for(var P=x[M].parts,L=P.length>1?1:0;L<P.length;L++){var k=P[L];y.rect(k.bounds.min.x,k.bounds.min.y,k.bounds.max.x-k.bounds.min.x,k.bounds.max.y-k.bounds.min.y)}}S.wireframes?y.strokeStyle="rgba(255,255,255,0.08)":y.strokeStyle="rgba(0,0,0,0.1)",y.lineWidth=1,y.stroke()},e.bodyAxes=function(g,x,b){var y=b;g.engine;var S=g.options,M,A,P,L;for(y.beginPath(),A=0;A<x.length;A++){var k=x[A],I=k.parts;if(k.render.visible)if(S.showAxes)for(P=I.length>1?1:0;P<I.length;P++)for(M=I[P],L=0;L<M.axes.length;L++){var R=M.axes[L];y.moveTo(M.position.x,M.position.y),y.lineTo(M.position.x+R.x*20,M.position.y+R.y*20)}else for(P=I.length>1?1:0;P<I.length;P++)for(M=I[P],L=0;L<M.axes.length;L++)y.moveTo(M.position.x,M.position.y),y.lineTo((M.vertices[0].x+M.vertices[M.vertices.length-1].x)/2,(M.vertices[0].y+M.vertices[M.vertices.length-1].y)/2)}S.wireframes?(y.strokeStyle="indianred",y.lineWidth=1):(y.strokeStyle="rgba(255, 255, 255, 0.4)",y.globalCompositeOperation="overlay",y.lineWidth=2),y.stroke(),y.globalCompositeOperation="source-over"},e.bodyPositions=function(g,x,b){var y=b;g.engine;var S=g.options,M,A,P,L;for(y.beginPath(),P=0;P<x.length;P++)if(M=x[P],!!M.render.visible)for(L=0;L<M.parts.length;L++)A=M.parts[L],y.arc(A.position.x,A.position.y,3,0,2*Math.PI,!1),y.closePath();for(S.wireframes?y.fillStyle="indianred":y.fillStyle="rgba(0,0,0,0.5)",y.fill(),y.beginPath(),P=0;P<x.length;P++)M=x[P],M.render.visible&&(y.arc(M.positionPrev.x,M.positionPrev.y,2,0,2*Math.PI,!1),y.closePath());y.fillStyle="rgba(255,165,0,0.8)",y.fill()},e.bodyVelocity=function(g,x,b){var y=b;y.beginPath();for(var S=0;S<x.length;S++){var M=x[S];if(M.render.visible){var A=a.getVelocity(M);y.moveTo(M.position.x,M.position.y),y.lineTo(M.position.x+A.x,M.position.y+A.y)}}y.lineWidth=3,y.strokeStyle="cornflowerblue",y.stroke()},e.bodyIds=function(g,x,b){var y=b,S,M;for(S=0;S<x.length;S++)if(x[S].render.visible){var A=x[S].parts;for(M=A.length>1?1:0;M<A.length;M++){var P=A[M];y.font="12px Arial",y.fillStyle="rgba(255,255,255,0.5)",y.fillText(P.id,P.position.x+10,P.position.y-10)}}},e.collisions=function(g,x,b){var y=b,S=g.options,M,A,P,L;for(y.beginPath(),P=0;P<x.length;P++)if(M=x[P],!!M.isActive)for(A=M.collision,L=0;L<M.contactCount;L++){var k=M.contacts[L],I=k.vertex;y.rect(I.x-1.5,I.y-1.5,3.5,3.5)}for(S.wireframes?y.fillStyle="rgba(255,255,255,0.7)":y.fillStyle="orange",y.fill(),y.beginPath(),P=0;P<x.length;P++)if(M=x[P],!!M.isActive&&(A=M.collision,M.contactCount>0)){var R=M.contacts[0].vertex.x,O=M.contacts[0].vertex.y;M.contactCount===2&&(R=(M.contacts[0].vertex.x+M.contacts[1].vertex.x)/2,O=(M.contacts[0].vertex.y+M.contacts[1].vertex.y)/2),A.bodyB===A.supports[0].body||A.bodyA.isStatic===!0?y.moveTo(R-A.normal.x*8,O-A.normal.y*8):y.moveTo(R+A.normal.x*8,O+A.normal.y*8),y.lineTo(R,O)}S.wireframes?y.strokeStyle="rgba(255,165,0,0.7)":y.strokeStyle="orange",y.lineWidth=1,y.stroke()},e.separations=function(g,x,b){var y=b,S=g.options,M,A,P,L,k;for(y.beginPath(),k=0;k<x.length;k++)if(M=x[k],!!M.isActive){A=M.collision,P=A.bodyA,L=A.bodyB;var I=1;!L.isStatic&&!P.isStatic&&(I=.5),L.isStatic&&(I=0),y.moveTo(L.position.x,L.position.y),y.lineTo(L.position.x-A.penetration.x*I,L.position.y-A.penetration.y*I),I=1,!L.isStatic&&!P.isStatic&&(I=.5),P.isStatic&&(I=0),y.moveTo(P.position.x,P.position.y),y.lineTo(P.position.x+A.penetration.x*I,P.position.y+A.penetration.y*I)}S.wireframes?y.strokeStyle="rgba(255,165,0,0.5)":y.strokeStyle="orange",y.stroke()},e.inspector=function(g,x){g.engine;var b=g.selected,y=g.render,S=y.options,M;if(S.hasBounds){var A=y.bounds.max.x-y.bounds.min.x,P=y.bounds.max.y-y.bounds.min.y,L=A/y.options.width,k=P/y.options.height;x.scale(1/L,1/k),x.translate(-y.bounds.min.x,-y.bounds.min.y)}for(var I=0;I<b.length;I++){var R=b[I].data;switch(x.translate(.5,.5),x.lineWidth=1,x.strokeStyle="rgba(255,165,0,0.9)",x.setLineDash([1,2]),R.type){case"body":M=R.bounds,x.beginPath(),x.rect(Math.floor(M.min.x-3),Math.floor(M.min.y-3),Math.floor(M.max.x-M.min.x+6),Math.floor(M.max.y-M.min.y+6)),x.closePath(),x.stroke();break;case"constraint":var O=R.pointA;R.bodyA&&(O=R.pointB),x.beginPath(),x.arc(O.x,O.y,10,0,2*Math.PI),x.closePath(),x.stroke();break}x.setLineDash([]),x.translate(-.5,-.5)}g.selectStart!==null&&(x.translate(.5,.5),x.lineWidth=1,x.strokeStyle="rgba(255,165,0,0.6)",x.fillStyle="rgba(255,165,0,0.1)",M=g.selectBounds,x.beginPath(),x.rect(Math.floor(M.min.x),Math.floor(M.min.y),Math.floor(M.max.x-M.min.x),Math.floor(M.max.y-M.min.y)),x.closePath(),x.stroke(),x.fill(),x.translate(-.5,-.5)),S.hasBounds&&x.setTransform(1,0,0,1,0,0)};var l=function(g,x){var b=g.engine,y=g.timing,S=y.historySize,M=b.timing.timestamp;y.delta=x-y.lastTime||e._goodDelta,y.lastTime=x,y.timestampElapsed=M-y.lastTimestamp||0,y.lastTimestamp=M,y.deltaHistory.unshift(y.delta),y.deltaHistory.length=Math.min(y.deltaHistory.length,S),y.engineDeltaHistory.unshift(b.timing.lastDelta),y.engineDeltaHistory.length=Math.min(y.engineDeltaHistory.length,S),y.timestampElapsedHistory.unshift(y.timestampElapsed),y.timestampElapsedHistory.length=Math.min(y.timestampElapsedHistory.length,S),y.engineUpdatesHistory.unshift(b.timing.lastUpdatesPerFrame),y.engineUpdatesHistory.length=Math.min(y.engineUpdatesHistory.length,S),y.engineElapsedHistory.unshift(b.timing.lastElapsed),y.engineElapsedHistory.length=Math.min(y.engineElapsedHistory.length,S),y.elapsedHistory.unshift(y.lastElapsed),y.elapsedHistory.length=Math.min(y.elapsedHistory.length,S)},h=function(g){for(var x=0,b=0;b<g.length;b+=1)x+=g[b];return x/g.length||0},w=function(g,x){var b=document.createElement("canvas");return b.width=g,b.height=x,b.oncontextmenu=function(){return!1},b.onselectstart=function(){return!1},b},C=function(g){var x=g.getContext("2d"),b=window.devicePixelRatio||1,y=x.webkitBackingStorePixelRatio||x.mozBackingStorePixelRatio||x.msBackingStorePixelRatio||x.oBackingStorePixelRatio||x.backingStorePixelRatio||1;return b/y},T=function(g,x){var b=g.textures[x];return b||(b=g.textures[x]=new Image,b.src=x,b)},E=function(g,x){var b=x;/(jpg|gif|png)$/.test(x)&&(b="url("+x+")"),g.canvas.style.background=b,g.canvas.style.backgroundSize="contain",g.currentBackground=x}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(5),i=s(17),n=s(0);(function(){e._maxFrameDelta=1e3/15,e._frameDeltaFallback=1e3/60,e._timeBufferMargin=1.5,e._elapsedNextEstimate=1,e._smoothingLowerBound=.1,e._smoothingUpperBound=.9,e.create=function(o){var f={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},u=n.extend(f,o);return u.fps=0,u},e.run=function(o,f){return o.timeBuffer=e._frameDeltaFallback,(function u(t){o.frameRequestId=e._onNextFrame(o,u),t&&o.enabled&&e.tick(o,f,t)})(),o},e.tick=function(o,f,u){var t=n.now(),c=o.delta,l=0,h=u-o.timeLastTick;if((!h||!o.timeLastTick||h>Math.max(e._maxFrameDelta,o.maxFrameTime))&&(h=o.frameDelta||e._frameDeltaFallback),o.frameDeltaSmoothing){o.frameDeltaHistory.push(h),o.frameDeltaHistory=o.frameDeltaHistory.slice(-o.frameDeltaHistorySize);var w=o.frameDeltaHistory.slice(0).sort(),C=o.frameDeltaHistory.slice(w.length*e._smoothingLowerBound,w.length*e._smoothingUpperBound),T=d(C);h=T||h}o.frameDeltaSnapping&&(h=1e3/Math.round(1e3/h)),o.frameDelta=h,o.timeLastTick=u,o.timeBuffer+=o.frameDelta,o.timeBuffer=n.clamp(o.timeBuffer,0,o.frameDelta+c*e._timeBufferMargin),o.lastUpdatesDeferred=0;var E=o.maxUpdates||Math.ceil(o.maxFrameTime/c),g={timestamp:f.timing.timestamp};a.trigger(o,"beforeTick",g),a.trigger(o,"tick",g);for(var x=n.now();c>0&&o.timeBuffer>=c*e._timeBufferMargin;){a.trigger(o,"beforeUpdate",g),i.update(f,c),a.trigger(o,"afterUpdate",g),o.timeBuffer-=c,l+=1;var b=n.now()-t,y=n.now()-x,S=b+e._elapsedNextEstimate*y/l;if(l>=E||S>o.maxFrameTime){o.lastUpdatesDeferred=Math.round(Math.max(0,o.timeBuffer/c-e._timeBufferMargin));break}}f.timing.lastUpdatesPerFrame=l,a.trigger(o,"afterTick",g),o.frameDeltaHistory.length>=100&&(o.lastUpdatesDeferred&&Math.round(o.frameDelta/c)>E?n.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):o.lastUpdatesDeferred&&n.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof o.isFixed<"u"&&n.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(o.deltaMin||o.deltaMax)&&n.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),o.fps!==0&&n.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},e.stop=function(o){e._cancelNextFrame(o)},e._onNextFrame=function(o,f){if(typeof window<"u"&&window.requestAnimationFrame)o.frameRequestId=window.requestAnimationFrame(f);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return o.frameRequestId},e._cancelNextFrame=function(o){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(o.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var d=function(o){for(var f=0,u=o.length,t=0;t<u;t+=1)f+=o[t];return f/u||0}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(8),i=s(0),n=i.deprecated;(function(){e.collides=function(d,o){return a.collides(d,o)},n(e,"collides","SAT.collides âž¤ replaced by Collision.collides")})()}),(function(m,v,s){var e={};m.exports=e,s(1);var a=s(0);(function(){e.pathToVertices=function(i,n){typeof window<"u"&&!("SVGPathSeg"in window)&&a.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var d,o,f,u,t,c,l,h,w,C,T=[],E,g,x=0,b=0,y=0;n=n||15;var S=function(A,P,L){var k=L%2===1&&L>1;if(!w||A!=w.x||P!=w.y){w&&k?(E=w.x,g=w.y):(E=0,g=0);var I={x:E+A,y:g+P};(k||!w)&&(w=I),T.push(I),b=E+A,y=g+P}},M=function(A){var P=A.pathSegTypeAsLetter.toUpperCase();if(P!=="Z"){switch(P){case"M":case"L":case"T":case"C":case"S":case"Q":b=A.x,y=A.y;break;case"H":b=A.x;break;case"V":y=A.y;break}S(b,y,A.pathSegType)}};for(e._svgPathToAbsolute(i),f=i.getTotalLength(),c=[],d=0;d<i.pathSegList.numberOfItems;d+=1)c.push(i.pathSegList.getItem(d));for(l=c.concat();x<f;){if(C=i.getPathSegAtLength(x),t=c[C],t!=h){for(;l.length&&l[0]!=t;)M(l.shift());h=t}switch(t.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":u=i.getPointAtLength(x),S(u.x,u.y,0);break}x+=n}for(d=0,o=l.length;d<o;++d)M(l[d]);return T},e._svgPathToAbsolute=function(i){for(var n,d,o,f,u,t,c=i.pathSegList,l=0,h=0,w=c.numberOfItems,C=0;C<w;++C){var T=c.getItem(C),E=T.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(E))"x"in T&&(l=T.x),"y"in T&&(h=T.y);else switch("x1"in T&&(o=l+T.x1),"x2"in T&&(u=l+T.x2),"y1"in T&&(f=h+T.y1),"y2"in T&&(t=h+T.y2),"x"in T&&(l+=T.x),"y"in T&&(h+=T.y),E){case"m":c.replaceItem(i.createSVGPathSegMovetoAbs(l,h),C);break;case"l":c.replaceItem(i.createSVGPathSegLinetoAbs(l,h),C);break;case"h":c.replaceItem(i.createSVGPathSegLinetoHorizontalAbs(l),C);break;case"v":c.replaceItem(i.createSVGPathSegLinetoVerticalAbs(h),C);break;case"c":c.replaceItem(i.createSVGPathSegCurvetoCubicAbs(l,h,o,f,u,t),C);break;case"s":c.replaceItem(i.createSVGPathSegCurvetoCubicSmoothAbs(l,h,u,t),C);break;case"q":c.replaceItem(i.createSVGPathSegCurvetoQuadraticAbs(l,h,o,f),C);break;case"t":c.replaceItem(i.createSVGPathSegCurvetoQuadraticSmoothAbs(l,h),C);break;case"a":c.replaceItem(i.createSVGPathSegArcAbs(l,h,T.r1,T.r2,T.angle,T.largeArcFlag,T.sweepFlag),C);break;case"z":case"Z":l=n,h=d;break}(E=="M"||E=="m")&&(n=l,d=h)}}})()}),(function(m,v,s){var e={};m.exports=e;var a=s(6);s(0),(function(){e.create=a.create,e.add=a.add,e.remove=a.remove,e.clear=a.clear,e.addComposite=a.addComposite,e.addBody=a.addBody,e.addConstraint=a.addConstraint})()})])})})(sn)),sn.exports}var Wo=No();const rt=Fo(Wo),_n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function Ct(r){const p=Number(r);return Number.isFinite(p)?Math.max(0,Math.min(1,p)):0}function Rt(){const r=Math.floor(Math.random()*_n.length);return _n[r]||"A"}function Vo(r,p){return r+Math.random()*(p-r)}function Ho(r,p){if(!r||!p)return null;try{const m=Be&&typeof Be.getScale=="function"&&Be.getScale()||1,v=r.getBoundingClientRect(),s=p.getBoundingClientRect(),e=(v.left-s.left)/(m||1),a=(v.top-s.top)/(m||1),i=v.width/(m||1),n=v.height/(m||1);return[e,a,i,n].every(Number.isFinite)?{x:e,y:a,w:i,h:n}:null}catch{return null}}function ei(r,p){return!r||!p?!1:r.x>=p.x&&r.y>=p.y&&r.x<=p.x+p.w&&r.y<=p.y+p.h}function wi(r){return!!r&&r.tagName&&String(r.tagName).toUpperCase()==="CANVAS"}function $o(r,p){if(!r||!wi(r))return;const m=r.getContext("2d");if(!m)return;const v=r.getBoundingClientRect(),s=Math.max(1,Math.floor(v.width||180)),e=Math.max(1,Math.floor(v.height||180)),a=window.devicePixelRatio||1,i=Math.max(1,Math.floor(s*a)),n=Math.max(1,Math.floor(e*a));r.width!==i&&(r.width=i),r.height!==n&&(r.height=n),m.setTransform(1,0,0,1,0,0),m.clearRect(0,0,i,n);const d=Math.round(Math.min(i,n)*.67);m.font=`900 ${d}px system-ui, -apple-system, Segoe UI, Arial, sans-serif`,m.textBaseline="alphabetic",m.textAlign="center";const o=String(p||"A").toUpperCase().slice(0,1),f=m.measureText(o),u=Number.isFinite(f.actualBoundingBoxAscent)&&Number.isFinite(f.actualBoundingBoxDescent)&&Number.isFinite(f.actualBoundingBoxLeft)&&Number.isFinite(f.actualBoundingBoxRight),t=u?f.actualBoundingBoxAscent:d*.78,c=u?f.actualBoundingBoxDescent:d*.22,h=n/2+(t-c)/2;let w=i/2;u&&(w=i/2+(f.actualBoundingBoxLeft-f.actualBoundingBoxRight)/2),m.lineJoin="round",m.miterLimit=2,m.lineWidth=Math.max(2,Math.round(d*.1)),m.strokeStyle="rgba(0,0,0,0.62)",m.fillStyle="rgba(255,255,255,0.98)",m.shadowColor="rgba(0,0,0,0.22)",m.shadowBlur=Math.round(d*.06),m.shadowOffsetX=0,m.shadowOffsetY=Math.round(d*.02),m.strokeText(o,w,h),m.fillText(o,w,h)}function Zt(){const r=Be&&typeof Be.getReferenceSize=="function"?Be.getReferenceSize():{width:1280,height:800},p=r&&Number.isFinite(r.width)?r.width:1280,m=r&&Number.isFinite(r.height)?r.height:800;return{width:p,height:m}}function _t(r,p,m){return r?(r.classList.add(p),setTimeout(()=>{try{r.classList.remove(p)}catch{}},m)):null}function zo(r){const p=r&&r.canvas,m=r&&r.hudEl,v=r&&r.glyphEl,s=r&&r.config&&typeof r.config=="object"?r.config:{};if(!p)return{start:function(){},dispose:function(){}};const e=rt&&rt.Engine?rt:rt&&rt.default&&rt.default.Engine?rt.default:rt,{Engine:a,World:i,Bodies:n,Body:d,Events:o}=e;let f=!1,u=null,t=null,c=null,l=null,h=[],w=new Set,C=null,T=null,E=null,g="introducing",x=Rt(),b=Rt(),y=null,S=0,M=0;const A=new Map,P="letters.score.v1",L=new Map,k=new Map;let I=null,R=0,O=0,V=!1,N=null;const K={x:0,y:0,w:190,h:190},J=Number.isFinite(s.gravityY)?s.gravityY:1.15;Number.isFinite(s.settleBeatMs)&&s.settleBeatMs;const Z=Number.isFinite(s.introBeatMs)?s.introBeatMs:650,_=Number.isFinite(s.postLaunchLockMs)?s.postLaunchLockMs:200,Se=Number.isFinite(s.scoreBeatMs)?s.scoreBeatMs:650,de=Number.isFinite(s.catchLingerMinMs)?s.catchLingerMinMs:1200,G=Number.isFinite(s.catchStillMs)?s.catchStillMs:520,Le=Number.isFinite(s.catchPostConfirmHoldMs)?s.catchPostConfirmHoldMs:1100,le=Number.isFinite(s.nextReadyBaseMs)?s.nextReadyBaseMs:1800,Ye=Number.isFinite(s.nextReadyRandomMinMs)?s.nextReadyRandomMinMs:1e3,Ie=Number.isFinite(s.nextReadyRandomMaxMs)?s.nextReadyRandomMaxMs:3e3,Me=Number.isFinite(s.stuckMinDropMs)?s.stuckMinDropMs:2200,ge=Number.isFinite(s.stuckNoMotionMs)?s.stuckNoMotionMs:2600,pn=Number.isFinite(s.stuckPulseMs)?s.stuckPulseMs:2200,dn=Number.isFinite(s.stuckSpeedEps)?s.stuckSpeedEps:.22,hn=Number.isFinite(s.catchStillSpeedEps)?s.catchStillSpeedEps:.32,He=[{id:"red",hex:"#E11D48"},{id:"orange",hex:"#F97316"},{id:"yellow",hex:"#F59E0B"},{id:"green",hex:"#16A34A"},{id:"blue",hex:"#2563EB"},{id:"purple",hex:"#7C3AED"}];function Tt(F){const D={},B=F&&typeof F=="object"?F:{};for(const W of He){const q=W.id,te=B[q]&&typeof B[q]=="object"?B[q]:{},$=Number.isFinite(te.count)?Math.floor(te.count):0,be=Number.isFinite(te.stars)?Math.floor(te.stars):0;D[q]={count:Math.max(0,Math.min(9,$)),stars:Math.max(0,be)}}return D}function pt(){try{const F=je.get(P,null);return Tt(F)}catch{return Tt(null)}}function $e(){try{je.set(P,I)}catch{}}function Vt(F){const D=String(F||"");I||(I=pt()),I[D]||(I[D]={count:0,stars:0});const B=performance.now?performance.now():Date.now(),W=I[D];W.count=Math.max(0,Math.min(9,Math.floor(W.count||0)))+1;let q=!1;W.count>=10&&(W.count=0,W.stars=Math.max(0,Math.floor(W.stars||0))+1,q=!0),$e(),L.set(D,{start:B,end:B+520}),se.scoreTick(.72),q&&(k.set(D,{start:B,end:B+1100}),Ue(()=>{f||se.star(.95)},120))}function ze(F){g=F}function At(F){x=String(F||"A").toUpperCase().slice(0,1),v&&(wi(v)?$o(v,x):v.textContent=x)}function at(F){m&&(F?m.classList.add("wos-letters-hud--empty"):m.classList.remove("wos-letters-hud--empty"))}function Ht(){for(const F of Array.from(w))try{clearTimeout(F)}catch{}w.clear()}function Ue(F,D){const B=setTimeout(()=>{w.delete(B);try{F()}catch{}},D);return w.add(B),B}function dt(F){const D=F&&F.key?String(F.key):"";return D&&D.length===1?D.toUpperCase():""}function Et(){const F=Zt(),D=Math.max(1,Math.floor(F.width)),B=Math.max(1,Math.floor(F.height));return p.width!==D&&(p.width=D),p.height!==B&&(p.height=B),{w:D,h:B}}function mn(F,D){const B=Be&&typeof Be.getScale=="function"&&Be.getScale()||1,W=p.getBoundingClientRect(),q=(F-W.left)/B,te=(D-W.top)/B;return{x:q,y:te}}function ht(F){return F.x>=K.x&&F.y>=K.y&&F.x<=K.x+K.w&&F.y<=K.y+K.h}function mt(){t=a.create({enableSleeping:!0}),c=t.world,c.gravity.y=J;const F=Zt(),D=F.width,B=F.height;C=Ho(m,p);const W=60,q=n.rectangle(D/2,B+W/2,D+W*2,W,{isStatic:!0}),te=n.rectangle(-W/2,B/2,W,B+W*2,{isStatic:!0}),$=n.rectangle(D+W/2,B/2,W,B+W*2,{isStatic:!0}),be=n.rectangle(D/2,-W/2,D+W*2,W,{isStatic:!0});i.add(c,[q,te,$,be]);const ve=12,ne=B-180,H=110,U=ne-62,Q=140,ae=(()=>{if(!C)return null;const z=140,j=18;return{x:Math.max(0,C.x-z),y:Math.max(0,C.y-j),w:Math.min(D,z+8),h:Math.min(B,C.h+j*2)}})(),Te=Math.floor(Math.random()*1e9);function he(z){return function(){z|=0,z=z+1831565813|0;let j=Math.imul(z^z>>>15,1|z);return j=j+Math.imul(j^j>>>7,61|j)^j,((j^j>>>14)>>>0)/4294967296}}const X=he(Te);function ie(z,j){const ye=Math.sin(z*12.9898+j*78.233+Te*1e-6)*43758.5453123;return ye-Math.floor(ye)}function ce(z,j){if(C){const ye={x:z,y:j};if(ei(ye,C)||ae&&ei(ye,ae))return!0}else if(z>D-240&&j<240)return!0;return!1}function ue({thresholdBase:z}){const j=[],Oe=.01+X()*.004,fe=.01+X()*.004,ke=.006+X()*.003,zt=.006+X()*.003,Ut=X()*Math.PI*2,gt=X()*Math.PI*2,Gt=X()*Math.PI*2,jt=X()*Math.PI*2,vt=ve*3.15,yt=vt,nt=new Map,gn=vt*vt;function vn(Ne,Ae){return`${Ne},${Ae}`}function Kt(Ne,Ae){const xt=Math.floor(Ne/yt),it=Math.floor(Ae/yt);for(let Ee=it-1;Ee<=it+1;Ee++)for(let ct=xt-1;ct<=xt+1;ct++){const qt=nt.get(vn(ct,Ee));if(qt)for(const xn of qt){const wn=j[xn],Sn=wn.x-Ne,Yt=wn.y-Ae;if(Sn*Sn+Yt*Yt<gn)return!1}}return!0}function Un(Ne,Ae){const xt=Math.floor(Ne/yt),it=Math.floor(Ae/yt),Ee=vn(xt,it),ct=j.length;j.push({x:Ne,y:Ae}),nt.has(Ee)||nt.set(Ee,[]),nt.get(Ee).push(ct)}const yn=D/2,Gn=yn-6,Ni=Math.max(3,Math.floor((U-H)/102)+2),Wi=Math.max(3,Math.floor((Gn-Q)/118)+2);for(let Ne=0;Ne<Ni;Ne++){const Ae=H+Ne*102;if(Ae<H-10||Ae>U+10)continue;const xt=Ne%2*(118/2);for(let it=0;it<Wi;it++){const Ee=Q+it*118+xt;if(Ee<Q||Ee>Gn)continue;const ct=(Ae-H)/Math.max(1,U-H),qt=.12*Math.sin(ct*2*Math.PI+Ut),xn=.06*Math.cos(Ee/D*2*Math.PI+gt);if(!(ie(Ee*.018,Ae*.018)>z+qt+xn))continue;const Yt=18*(.65*Math.sin(Ae*fe+Gt)+.35*Math.sin(Ee*ke+jt)),Vi=18*(.55*Math.sin(Ee*Oe+gt)+.25*Math.sin(Ae*zt+Ut)),Hi=(X()*2-1)*8,$i=(X()*2-1)*8,wt=Ee+Yt+Hi,St=Ae+Vi+$i;if(!(wt<Q||wt>D-Q)&&!(St<H||St>U)&&!ce(wt,St)&&Kt(wt,St)&&(Un(wt,St),X()<.86)){const Bt=yn+(yn-wt),Lt=St+(X()*2-1)*3;Bt>Q&&Bt<D-Q&&Lt>=H&&Lt<=U&&!ce(Bt,Lt)&&Kt(Bt,Lt)&&Un(Bt,Lt)}}}return j}const me=56,ee=86;let oe=[],re=.28;for(let z=0;z<5;z++){if(oe=ue({thresholdBase:re}),oe.length<me)re-=.03;else if(oe.length>ee)re+=.03;else break;re=Math.max(.12,Math.min(.46,re))}E={W:D,H:B,pegRadius:ve,pegTop:H,pegBottom:U,xPad:Q,maxDrift:46,minDist:ve*3.15,inNoGoZones:ce};const De=[];for(const z of oe){const j=n.circle(z.x,z.y,ve,{isStatic:!0,restitution:.95,friction:.02});j.label="peg",j.plugin=j.plugin||{},j.plugin.kind="peg",j.plugin.home={x:z.x,y:z.y},j.plugin.style={shade:.74+X()*.2,fillAlpha:.72+X()*.18,outlineAlpha:.55+X()*.2,ringAlpha:.14+X()*.16,drawRadiusJitter:(X()*2-1)*1.8,highlightAngle:X()*Math.PI*2,wiggleUntilMs:0},De.push(j)}i.add(c,De);const Ke=160,$t=He.length,lt=D/$t,et=18;for(let z=0;z<$t;z++){const j=z*lt,ye=(z+1)*lt,Ce=(j+ye)/2,xe=n.rectangle(j+et/2,ne+Ke/2,et,Ke,{isStatic:!0,restitution:.25}),Oe=n.rectangle(ye-et/2,ne+Ke/2,et,Ke,{isStatic:!0,restitution:.25});xe.label="binWall",Oe.label="binWall",xe.plugin={binId:He[z].id},Oe.plugin={binId:He[z].id};const fe=n.rectangle(Ce,ne+Ke,lt,22,{isStatic:!0,restitution:.15,friction:.02});fe.label="binLip",fe.plugin={binId:He[z].id};const ke=n.rectangle(Ce,ne+Ke-20,lt-et*2,40,{isStatic:!0,isSensor:!0});ke.label="binSensor",ke.plugin={binId:He[z].id},i.add(c,[xe,Oe,fe,ke])}const tt=z=>{if(f||!y||!y.body||g!=="dropping"&&g!=="inBin"&&g!=="rewarding")return;const j=z&&z.pairs?z.pairs:[];for(const ye of j){const Ce=ye.bodyA,xe=ye.bodyB,Oe=Ce===y.body?Ce:xe===y.body?xe:null,fe=Oe===Ce?xe:Oe===xe?Ce:null;if(Oe&&fe&&!fe.isSensor&&!Oe.isSensor)try{const gt=Oe.velocity||{x:0,y:0},Gt=fe.velocity||{x:0,y:0},jt=(gt.x||0)-(Gt.x||0),vt=(gt.y||0)-(Gt.y||0),yt=Math.sqrt(jt*jt+vt*vt),nt=Ct((yt-1.5)/12.5);if(nt>.02){const gn=fe.isStatic&&fe.circleRadius;if(fe.label==="binWall"||fe.label==="binLip"||fe.plugin&&fe.plugin.binId)se.binBounce(nt);else{const Kt=gn?"peg":"wall";se.bounce(nt,Kt)}}}catch{}const ke=Ce&&Ce.label==="binSensor"?Ce:xe&&xe.label==="binSensor"?xe:null,zt=ke===Ce?xe:ke===xe?Ce:null;if(!ke||!zt||zt!==y.body)continue;const Ut=ke.plugin&&ke.plugin.binId?String(ke.plugin.binId):"unknown";Oi(Ut,ye);break}};o.on(t,"collisionStart",tt),h.push(()=>{try{o.off(t,"collisionStart",tt)}catch{}})}function Ai(){const F=Zt(),D=F.width,B=F.height;let W=D-120,q=120;try{if(m){const Q=Be&&typeof Be.getScale=="function"&&Be.getScale()||1,ae=m.getBoundingClientRect(),Te=p.getBoundingClientRect(),he=ae.left-18,X=ae.top+ae.height*.52;W=(he-Te.left)/(Q||1),q=(X-Te.top)/(Q||1)}}catch{}W=Math.max(80,Math.min(D-80,W)),q=Math.max(80,Math.min(B-400,q));const $=n.circle(W,q,32,{restitution:.68,friction:.02,frictionAir:.006,density:.0025});$.label="letter",$.plugin={letter:x},i.add(c,$),y={body:$,letter:x};const be=performance.now?performance.now():Date.now();R=be,O=be,V=!1;const ve=Math.random();let ne;ve<.55?ne=-(7+Math.random()*7):ve<.9?ne=-(12+Math.random()*12):ne=-(20+Math.random()*16);const H=Math.random();let U;H<.6?U=-(1.2+Math.random()*4.2):H<.92?U=-(2.8+Math.random()*6):U=-(5.5+Math.random()*7);try{d.setVelocity($,{x:ne,y:U})}catch{}try{d.setAngularVelocity($,(Math.random()*2-1)*.14)}catch{}}function Wn(){if(!c||!y||!y.body){y=null;return}try{i.remove(c,y.body)}catch{}y=null}function Vn(F){if(f)return;Wn(),N=null,ze("introducing"),at(!0);const D=()=>Ue(()=>{if(f)return;se.ready(.62);const B=Math.round(Vo(Ye,Ie));if(T){try{T()}catch{}T=null}T=se.drumroll(B,.55),Ue(()=>{if(f)return;if(T){try{T()}catch{}T=null}const W=Math.random(),q=W<.34?"left":W<.68?"right":W<.86?"wiggle":"none";m&&m.setAttribute("data-wos-letters-intro",q),At(b),b=Rt(),at(!1),m&&_t(m,"wos-letters-hud--intro-slow",700),se.pop(.28),Ue(()=>{f||ze("idleAwaitingKey")},Z)},B)},le);F?(Vt(F),Ue(()=>{f||D()},Se)):D()}function Ei(F){if(!y||!y.body||g!=="dropping"||F-R<Me)return;const D=y.body.velocity||{x:0,y:0};if(Math.sqrt((D.x||0)*(D.x||0)+(D.y||0)*(D.y||0))>dn){O=F,V=!1;return}!V&&F-O>=ge&&(V=!0),V&&F-(O+ge)>=pn&&(se.poof(.65),Vn())}function Bi(F){if(!y||!y.body||g!=="inBin"||!N)return;const W=Zt().height-180;if(y.body.position&&y.body.position.y<W-70){N=null,ze("dropping");return}const q=y.body.velocity||{x:0,y:0};Math.sqrt((q.x||0)*(q.x||0)+(q.y||0)*(q.y||0))<=hn?N.stillStartMs||(N.stillStartMs=F):N.stillStartMs=0;const $=F-N.enterMs>=de,be=!!(N.stillStartMs&&F-N.stillStartMs>=G);if(!$||!be)return;ze("rewarding");const ve=Math.max(.7,Ct(N.impactStrength||.6));se.reward(N.binId,ve);const ne=F;A.set(N.binId,{start:ne,end:ne+700}),Ue(()=>{f||Vn(N&&N.binId?N.binId:null)},Le)}function Li(){f||(ze("dropping"),m&&_t(m,"wos-letters-hud--pop",190),se.launch(.95),Ai(),at(!0),b=Rt(),N=null,Ue(()=>{},_))}function Ii(){f||(m&&_t(m,"wos-letters-hud--wrong",160),se.buzz(.75))}function ki(){f||se.tick()}function Oi(F,D){if(f||g!=="dropping")return;const B=performance.now?performance.now():Date.now();ze("inBin");const W=(()=>{const q=D&&D.collision&&Number.isFinite(D.collision.depth)?Math.abs(D.collision.depth):.4;return Ct(.55+q*.2)})();N={binId:F,enterMs:B,stillStartMs:0,impactStrength:W},se.binBounce(.45)}function Ri(){if(!l||!t)return;const{w:F,h:D}=Et(),B=l;B.clearRect(0,0,F,D),B.save(),B.globalAlpha=.1,B.fillStyle="#000",B.fillRect(0,0,F,D),B.restore();const W=He.length,q=F/W,te=D-180,$=performance.now?performance.now():Date.now();I||(I=pt());function be(H,U,Q,ae,Te,he){const X=he;let ie=-Math.PI/2;const ce=Math.PI/X;H.beginPath();for(let ue=0;ue<X*2;ue++){const me=ue%2===0?ae:Te,ee=U+Math.cos(ie)*me,oe=Q+Math.sin(ie)*me;ue===0?H.moveTo(ee,oe):H.lineTo(ee,oe),ie+=ce}H.closePath()}for(let H=0;H<W;H++){const U=He[H],Q=H*q,ae=A.get(U.id)||null,Te=!!(ae&&ae.end>$),he=ae?Ct(1-(ae.end-$)/Math.max(1,ae.end-ae.start)):0,X=Te?1+Math.sin(he*Math.PI)*.04:1;B.save();const ie=Q+q/2,ce=te+85;B.translate(ie,ce),B.scale(1,X),B.translate(-ie,-ce),B.globalAlpha=.78,B.fillStyle=U.hex,B.fillRect(Q+6,te,q-12,170),B.globalAlpha=.22,B.fillStyle="#000",B.fillRect(Q+6,te+8,q-12,162),B.globalAlpha=.55,B.lineWidth=Te?6:4,B.strokeStyle="rgba(255,255,255,0.75)",B.strokeRect(Q+6+2,te+2,q-12-4,166),Te&&(B.globalAlpha=.35,B.shadowColor="rgba(255,255,255,0.85)",B.shadowBlur=18,B.strokeStyle="rgba(255,255,255,0.85)",B.lineWidth=3,B.strokeRect(Q+6+6,te+8,q-12-12,154)),B.restore();const ue=I&&I[U.id]?I[U.id]:{count:0,stars:0},me=Math.max(0,Math.min(9,Math.floor(ue.count||0))),ee=Math.max(0,Math.floor(ue.stars||0)),oe=Q+q-44,re=te+36,De=L.get(U.id),Ke=!!(De&&De.end>$),$t=Ke?Ct(1-(De.end-$)/Math.max(1,De.end-De.start)):0,lt=Ke?1+Math.sin($t*Math.PI)*.28:1;B.save(),B.translate(oe,re),B.scale(lt,lt),B.translate(-oe,-re),B.globalAlpha=.78,B.fillStyle="rgba(255,255,255,0.22)",B.beginPath(),B.arc(oe,re,20,0,Math.PI*2),B.fill(),B.globalAlpha=.55,B.lineWidth=3,B.strokeStyle="rgba(0,0,0,0.55)",B.stroke(),B.globalAlpha=1,B.font="900 28px system-ui, -apple-system, Segoe UI, Arial, sans-serif",B.textAlign="center",B.textBaseline="middle";const et=String(me);if(B.lineJoin="round",B.miterLimit=2,B.lineWidth=6,B.strokeStyle="rgba(0,0,0,0.55)",B.fillStyle="rgba(255,255,255,0.95)",B.strokeText(et,oe,re+1),B.fillText(et,oe,re+1),B.restore(),ee>0){const tt=Q+44,z=te+38,j=k.get(U.id),ye=!!(j&&j.end>$),Ce=ye?Ct(1-(j.end-$)/Math.max(1,j.end-j.start)):0,xe=ye?1+Math.sin(Ce*Math.PI)*.32:1,Oe=ye?12+10*Math.sin(Ce*Math.PI):0;B.save(),B.translate(tt,z),B.scale(xe,xe),B.translate(-tt,-z),B.globalAlpha=.92,B.shadowColor="rgba(255,255,255,0.75)",B.shadowBlur=Oe,B.fillStyle="rgba(255,255,255,0.92)",B.strokeStyle="rgba(0,0,0,0.62)",B.lineWidth=4,be(B,tt,z,18,8.5,5),B.fill(),B.shadowBlur=0,B.stroke();const fe=ee>=100?"99":String(ee),ke=fe.length>=2?14:16;B.font=`900 ${ke}px system-ui, -apple-system, Segoe UI, Arial, sans-serif`,B.textAlign="center",B.textBaseline="middle",B.lineJoin="round",B.miterLimit=2,B.lineWidth=5,B.strokeStyle="rgba(0,0,0,0.55)",B.fillStyle="rgba(0,0,0,0.88)",B.strokeText(fe,tt,z+1),B.fillText(fe,tt,z+1),B.restore()}}const ve=e.Composite.allBodies(c),ne=performance.now?performance.now():Date.now();for(const H of ve)if(H&&H.label!=="binSensor"&&H.isStatic&&H.circleRadius&&H.label==="peg"){const U=H.plugin&&H.plugin.style?H.plugin.style:null,Q=H.circleRadius||12,ae=U&&U.drawRadiusJitter||0,Te=U&&U.wiggleUntilMs&&ne<U.wiggleUntilMs?1+.1*Math.sin((U.wiggleUntilMs-ne)/36):1,he=Math.max(6,(Q+ae)*Te),X=U&&U.shade||.84,ie=U&&U.fillAlpha||.82,ce=U&&U.outlineAlpha||.65,ue=U&&U.ringAlpha||.18;B.save();const me=Math.round(255*X);if(B.fillStyle=`rgba(${me},${me},${me},${ie})`,B.beginPath(),B.arc(H.position.x,H.position.y,he,0,Math.PI*2),B.fill(),B.globalAlpha=ue,B.strokeStyle="rgba(255,255,255,1)",B.lineWidth=2,B.beginPath(),B.arc(H.position.x,H.position.y,Math.max(2,he-4),0,Math.PI*2),B.stroke(),U){const ee=U.highlightAngle||0,oe=H.position.x+Math.cos(ee)*(he*.35),re=H.position.y+Math.sin(ee)*(he*.35);B.globalAlpha=.26,B.fillStyle="rgba(255,255,255,1)",B.beginPath(),B.arc(oe,re,Math.max(1.5,he*.16),0,Math.PI*2),B.fill()}B.globalAlpha=1,B.strokeStyle=`rgba(0,0,0,${ce})`,B.lineWidth=3,B.beginPath(),B.arc(H.position.x,H.position.y,he,0,Math.PI*2),B.stroke(),B.restore()}if(y&&y.body){const H=y.body,U=performance.now?performance.now():Date.now(),Q=V?.92+.1*(.5+.5*Math.sin(U/120)):1;B.save(),B.translate(H.position.x,H.position.y),B.rotate(H.angle),B.scale(Q,Q),B.fillStyle="rgba(255,255,255,0.85)",B.beginPath(),B.arc(0,0,H.circleRadius||32,0,Math.PI*2),B.fill(),B.fillStyle="rgba(17,17,17,0.92)",B.textAlign="center",B.textBaseline="middle",B.font="900 40px system-ui, -apple-system, Segoe UI, Arial, sans-serif";const ae=H.plugin&&H.plugin.letter?String(H.plugin.letter):"A";B.fillText(ae,0,2),V&&(B.strokeStyle="rgba(255,255,255,0.9)",B.lineWidth=3,B.globalAlpha=.6,B.beginPath(),B.arc(0,0,(H.circleRadius||32)+4,0,Math.PI*2),B.stroke()),B.restore()}}function Hn(F){if(f||!t)return;S||(S=F);const D=Math.min(50,Math.max(0,F-S));S=F,M+=D;const B=1e3/60;for(;M>=B;)e.Engine.update(t,B),M-=B;Ri();const W=performance.now?performance.now():Date.now();Ei(W),Bi(W),u=requestAnimationFrame(Hn)}function $n(F){if(f||F&&(F.ctrlKey||F.metaKey||F.altKey))return;se.unlock().catch(()=>{});const D=dt(F);if(D){if(g!=="idleAwaitingKey"){ki();return}D===x?Li():Ii()}}function zn(F){if(f||!F)return;se.unlock().catch(()=>{});const D=mn(F.clientX,F.clientY);if(ht(D)||!c)return;const B=e.Composite.allBodies(c);let W=null,q=1/0;for(const $ of B){if(!$||!$.isStatic||!$.circleRadius||$.label!=="peg")continue;const be=$.position.x-D.x,ve=$.position.y-D.y,ne=be*be+ve*ve;ne<q&&(q=ne,W=$)}const te=34;if(W&&q<=te*te){const $=E,be=W.plugin&&W.plugin.style?W.plugin.style:null,ve=W.plugin&&W.plugin.home?W.plugin.home:{x:W.position.x,y:W.position.y},ne=$?$.minDist:38,H=ne*ne,U=$?$.maxDrift:46,Q=U*U,ae=(ie,ce)=>{const ue=$?$.W:p.width||1280,me=$?$.H:p.height||800,ee=$?$.xPad:140,oe=$?$.pegTop:110,re=$?$.pegBottom:me-180-62;return!(ie<ee||ie>ue-ee||ce<oe||ce>re||$&&typeof $.inNoGoZones=="function"&&$.inNoGoZones(ie,ce))},Te=(ie,ce)=>{const ue=ie-ve.x,me=ce-ve.y;if(ue*ue+me*me>Q)return!1;for(const ee of B){if(!ee||ee===W||!ee.isStatic||!ee.circleRadius||ee.label!=="peg")continue;const oe=ee.position.x-ie,re=ee.position.y-ce;if(oe*oe+re*re<H)return!1}return!0};let he=!1,X=0;for(let ie=0;ie<10;ie++){const ce=Math.random()<.16,ue=(ce?16:8)+Math.random()*(ce?16:10),me=Math.random()*Math.PI*2,ee=Math.cos(me)*ue,oe=Math.sin(me)*ue,re=W.position.x+ee,De=W.position.y+oe;if(ae(re,De)&&Te(re,De)){try{d.setPosition(W,{x:re,y:De}),he=!0,X=ue}catch{}break}}if(be&&(be.wiggleUntilMs=(performance.now?performance.now():Date.now())+(he?520:280)),he){const ie=Math.min(1,.25+X/32*.75);se.plink(.2+.55*ie),X>22&&se.pop(.22)}else se.plink(.16)}else se.tick()}function Fi(){if(f)return;l=p.getContext("2d",{alpha:!0,desynchronized:!0}),Et(),se.ensure(),mt(),At(x),b=Rt(),at(!1),m&&m.setAttribute("data-wos-letters-intro","none"),m&&_t(m,"wos-letters-hud--intro-slow",700),se.pop(.22),Ue(()=>{f||ze("idleAwaitingKey")},Z),document.addEventListener("keydown",$n,!0),p.addEventListener("pointerdown",zn),h.push(()=>document.removeEventListener("keydown",$n,!0)),h.push(()=>p.removeEventListener("pointerdown",zn));const F=()=>Et();document.addEventListener("winnieos:displaychange",F),h.push(()=>document.removeEventListener("winnieos:displaychange",F)),u=requestAnimationFrame(Hn)}function Di(){if(!f){if(f=!0,T){try{T()}catch{}T=null}try{u&&cancelAnimationFrame(u)}catch{}u=null,Ht();for(const F of h)try{F()}catch{}h=[];try{Wn()}catch{}try{c&&e.World.clear(c,!1),t&&e.Engine.clear(t)}catch{}t=null,c=null,l=null}}return{start:Fi,dispose:Di}}const Uo={id:"letters",title:"Letters",iconEmoji:"ðŸ”¤",sortOrder:10,mount:function({root:r}){if(!r)return;r.className="wos-letters-app",r.innerHTML="";const p=document.createElement("canvas");p.className="wos-letters-canvas",p.setAttribute("aria-label","Letters game"),p.setAttribute("role","application");const m=document.createElement("div");m.className="wos-letters-hud";const v=document.createElement("canvas");v.className="wos-letters-glyph",v.setAttribute("aria-hidden","true"),m.appendChild(v),r.appendChild(p),r.appendChild(m);let s=!1,e=null;return(async()=>{let i=null;try{i=await Ze.load()}catch{}if(s)return;const n=i&&i.apps&&i.apps.config&&typeof i.apps.config=="object"&&i.apps.config.letters||null;e=zo({canvas:p,hudEl:m,glyphEl:v,config:n}),e.start()})(),function(){if(s=!0,e&&typeof e.dispose=="function")try{e.dispose()}catch{}e=null}},unmount:function(){}},Go=Object.freeze(Object.defineProperty({__proto__:null,default:Uo},Symbol.toStringTag,{value:"Module"})),jo={id:"memory",title:"Memory",iconEmoji:"ðŸ§ ",sortOrder:45,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Memory</div>
            <div class="wos-app-placeholder-text">A simple matching game will live here.</div>
        `)},unmount:function(){}},Ko=Object.freeze(Object.defineProperty({__proto__:null,default:jo},Symbol.toStringTag,{value:"Module"})),qo={id:"music",title:"Music",iconEmoji:"ðŸŽµ",sortOrder:30,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Music</div>
            <div class="wos-app-placeholder-text">This will become a simple music player with big buttons.</div>
        `)},unmount:function(){}},Yo=Object.freeze(Object.defineProperty({__proto__:null,default:qo},Symbol.toStringTag,{value:"Module"})),Si="apps.notepad.v1",On=[{id:"black",hex:"#111111"},{id:"red",hex:"#E11D48"},{id:"orange",hex:"#F97316"},{id:"yellow",hex:"#F59E0B"},{id:"green",hex:"#16A34A"},{id:"blue",hex:"#2563EB"},{id:"purple",hex:"#7C3AED"},{id:"pink",hex:"#EC4899"}],Qo=["ðŸ˜€","ðŸ˜","ðŸ˜„","ðŸ˜†","ðŸ˜Š","ðŸ˜","ðŸ¥³","ðŸ˜œ","ðŸµ","ðŸ™ˆ","ðŸ™‰","ðŸ™Š","ðŸ¶","ðŸ±","ðŸ­","ðŸ°","ðŸ¦","ðŸ·","ðŸ½","ðŸ®","ðŸ¸","ðŸ»","ðŸ¼","ðŸ¨","ðŸ¦Š","ðŸ¯","ðŸ™","ðŸ¦„","ðŸž","ðŸ¦‹","ðŸ","ðŸ¢","ðŸ“","ðŸŒ","ðŸŽ","ðŸ‡","ðŸ‰","ðŸ’","ðŸª","ðŸ¦","â­","ðŸŒˆ","â˜€ï¸","ðŸŒ™","â¤ï¸","ðŸ’›","ðŸ’š","ðŸ’™","ðŸ’œ","âœ¨","ðŸŽˆ","ðŸŽ‰","ðŸŽµ"];function Xo(r,p){let m=null;return function(...v){m&&clearTimeout(m),m=setTimeout(()=>r(...v),p)}}function Mi(r){const p=String(r||"").trim();return p?/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p)?p.toLowerCase():/^rgba?\(\s*\d+\s*,\s*\d+\s*,\s*\d+(?:\s*,\s*(0|1|0?\.\d+))?\s*\)$/i.test(p)?p:null:null}function ti(r){const p=document.createElement("template");p.innerHTML=String(r||"");const m=v=>{const s=Array.from(v.childNodes||[]);for(const e of s)if(e.nodeType===Node.ELEMENT_NODE){const a=e.tagName.toLowerCase();if(a!=="br")if(a==="div"||a==="span"){const i=Array.from(e.attributes||[]);for(const n of i)e.removeAttribute(n.name);if(a==="span"){const n=e.style&&e.style.color?e.style.color:"",d=Mi(n);d&&e.setAttribute("style",`color:${d}`)}m(e)}else{const i=e.textContent||"";e.replaceWith(document.createTextNode(i))}}else e.nodeType===Node.COMMENT_NODE&&e.remove()};try{m(p.content)}catch{}return p.innerHTML}function bi(r,p){try{if(r==="foreColor")try{document.execCommand("styleWithCSS",!1,!0)}catch{}return document.execCommand(r,!1,p)}catch{return!1}}function en(r,p){const m=Mi(p)||p,v=bi("foreColor",m);return!v&&r&&r.style&&(r.style.color=m),v}function ni(r){if(bi("insertText",r))return!0;const p=window.getSelection&&window.getSelection();if(!p||p.rangeCount===0)return!1;const m=p.getRangeAt(0);m.deleteContents();const v=document.createTextNode(r);return m.insertNode(v),m.setStartAfter(v),m.setEndAfter(v),p.removeAllRanges(),p.addRange(m),!0}function Jo(){const r=je.get(Si,null);return!r||typeof r!="object"?null:{html:typeof r.html=="string"?r.html:"",color:typeof r.color=="string"?r.color:On[0].hex}}function ii(r,p){if(!r||typeof r.querySelectorAll!="function")return;r.querySelectorAll("[data-wos-notepad-swatch]").forEach(v=>{(v.getAttribute("data-wos-notepad-swatch")||"").toLowerCase()===String(p||"").toLowerCase()?v.classList.add("wos-notepad-swatch--active"):v.classList.remove("wos-notepad-swatch--active")})}const Zo={id:"notepad",title:"Notepad",iconEmoji:"ðŸ“",sortOrder:5,mount:function({root:r}){if(!r)return;r.className="wos-notepad-app",r.innerHTML="";const p=Jo();let m=p&&p.color||On[0].hex;const v=document.createElement("div");v.className="wos-notepad-wrap";const s=document.createElement("div");s.className="wos-notepad-paper";const e=document.createElement("div");e.className="wos-notepad-editor",e.setAttribute("contenteditable","true"),e.setAttribute("role","textbox"),e.setAttribute("aria-multiline","true"),e.setAttribute("aria-label","Notepad"),e.spellcheck=!1,e.innerHTML=p&&p.html?ti(p.html):"",s.appendChild(e);const a=document.createElement("div");a.className="wos-notepad-emoji-strip",a.setAttribute("aria-label","Emojis");const i=document.createElement("div");i.className="wos-notepad-emoji-strip-inner",Qo.forEach(T=>{const E=document.createElement("button");E.type="button",E.className="wos-notepad-emoji",E.setAttribute("aria-label","Emoji"),E.textContent=T,E.addEventListener("click",()=>{e.focus({preventScroll:!0}),ni(T),t()}),i.appendChild(E)}),a.appendChild(i);const n=document.createElement("div");n.className="wos-notepad-controls";const d=document.createElement("div");d.className="wos-notepad-swatches wos-notepad-card",On.forEach(T=>{const E=document.createElement("button");E.type="button",E.className="wos-notepad-swatch",E.setAttribute("aria-label",`Text color ${T.id}`),E.setAttribute("data-wos-notepad-swatch",T.hex),E.style.background=T.hex,E.addEventListener("click",()=>{m=T.hex,ii(n,m),e.focus({preventScroll:!0}),en(e,m)}),d.appendChild(E)});const o=document.createElement("div");o.className="wos-notepad-trash wos-notepad-card";const f=document.createElement("button");f.type="button",f.className="wos-notepad-action",f.setAttribute("aria-label","Clear page"),f.textContent="ðŸ—‘ï¸",o.appendChild(f),n.appendChild(d),n.appendChild(o);const u=()=>{je.set(Si,{html:ti(e.innerHTML),color:m})},t=Xo(u,450),c=T=>{try{T.preventDefault();const E=T.clipboardData&&T.clipboardData.getData("text/plain")||"";if(!E)return;e.focus({preventScroll:!0}),ni(E),t()}catch{}},l=()=>{t()},h=()=>{},w=()=>{e.innerHTML="",u(),e.focus({preventScroll:!0}),en(e,m)};v.appendChild(a),v.appendChild(s),v.appendChild(n),r.appendChild(v),ii(n,m),requestAnimationFrame(()=>{e.focus({preventScroll:!0}),en(e,m);try{i.scrollLeft=0}catch{}});const C=T=>{const E=T.key,g=E&&E.length===1&&!T.ctrlKey&&!T.metaKey&&!T.altKey,x=document.activeElement,b=x&&(x.tagName==="BUTTON"||x.tagName==="INPUT"||x.tagName==="TEXTAREA"||x.hasAttribute("contenteditable"));g&&!b&&x!==e&&e&&e.isConnected&&(e.focus({preventScroll:!0}),en(e,m))};return e.addEventListener("input",l),e.addEventListener("paste",c),s.addEventListener("pointerdown",h),f.addEventListener("click",w),document.addEventListener("keydown",C,!0),function(){try{u()}catch{}e.removeEventListener("input",l),e.removeEventListener("paste",c),s.removeEventListener("pointerdown",h),f.removeEventListener("click",w),document.removeEventListener("keydown",C,!0)}},unmount:function(){}},_o=Object.freeze(Object.defineProperty({__proto__:null,default:Zo},Symbol.toStringTag,{value:"Module"})),er={id:"numbers",title:"Numbers",iconEmoji:"ðŸ”¢",sortOrder:35,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Numbers</div>
            <div class="wos-app-placeholder-text">Count and tap!</div>
        `)},unmount:function(){}},tr=Object.freeze(Object.defineProperty({__proto__:null,default:er},Symbol.toStringTag,{value:"Module"})),nr={id:"paint",title:"Paint",iconEmoji:"ðŸŽ¨",sortOrder:10,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Paint</div>
            <div class="wos-app-placeholder-text">A simple drawing app will live here.</div>
        `)},unmount:function(){}},ir=Object.freeze(Object.defineProperty({__proto__:null,default:nr},Symbol.toStringTag,{value:"Module"})),or={id:"piano",title:"Piano",iconEmoji:"ðŸŽ¹",sortOrder:50,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Piano</div>
            <div class="wos-app-placeholder-text">Tap keys to make music.</div>
        `)},unmount:function(){}},rr=Object.freeze(Object.defineProperty({__proto__:null,default:or},Symbol.toStringTag,{value:"Module"})),sr={id:"shapes",title:"Shapes",iconEmoji:"ðŸ”º",sortOrder:40,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Shapes</div>
            <div class="wos-app-placeholder-text">Match the shapes.</div>
        `)},unmount:function(){}},ar=Object.freeze(Object.defineProperty({__proto__:null,default:sr},Symbol.toStringTag,{value:"Module"})),lr={id:"story",title:"Story Time",iconEmoji:"ðŸ“–",sortOrder:20,mount:function(r){const p=r&&r.root;p&&(p.className="wos-app-placeholder",p.innerHTML=`
            <div class="wos-app-placeholder-title">Story Time</div>
            <div class="wos-app-placeholder-text">Soon weâ€™ll read and play through stories here.</div>
        `)},unmount:function(){}},cr=Object.freeze(Object.defineProperty({__proto__:null,default:lr},Symbol.toStringTag,{value:"Module"}));function ur(r){if(!r||typeof r!="object")return null;const p=typeof r.id=="string"&&r.id.trim()?r.id.trim():null,m=typeof r.title=="string"&&r.title.trim()?r.title.trim():null,v=typeof r.mount=="function"?r.mount:null,s=typeof r.unmount=="function"?r.unmount:null;return!p||!m||!v?null:{id:p,title:m,iconSrc:typeof r.iconSrc=="string"?r.iconSrc:null,iconEmoji:typeof r.iconEmoji=="string"?r.iconEmoji:null,sortOrder:Number.isFinite(r.sortOrder)?r.sortOrder:0,mount:v,unmount:s}}const oi=Object.assign({"./animals/app.js":Co,"./blocks/app.js":To,"./bubbles/app.js":Eo,"./colors/app.js":Lo,"./dance/app.js":ko,"./garden/app.js":Ro,"./letters/app.js":Go,"./memory/app.js":Ko,"./music/app.js":Yo,"./notepad/app.js":_o,"./numbers/app.js":tr,"./paint/app.js":ir,"./piano/app.js":rr,"./shapes/app.js":ar,"./story/app.js":cr}),Wt=new Map;Object.keys(oi).forEach(r=>{const p=oi[r],m=p&&(p.default||p.app)||null,v=ur(m);if(!v){console.warn(`WinnieOS.Apps: invalid app module at ${r}`);return}if(Wt.has(v.id)){console.warn(`WinnieOS.Apps: duplicate app id "${v.id}" (skipping ${r})`);return}Wt.set(v.id,v)});let We=null;async function ri(){if(We!==null)return We;try{const r=await Ze.load();if(r&&r.apps&&Array.isArray(r.apps.enabled)){const p=r.apps.enabled.map(m=>String(m).trim()).filter(Boolean);We=new Set(p)}else r===null?We=new Set(["colors"]):We=new Set(Wt.keys())}catch(r){console.warn("WinnieOS.Apps: failed to load config, defaulting to colors only",r),We=new Set(["colors"])}return We}function Rn(){return Array.from(Wt.values()).sort((r,p)=>r.sortOrder!==p.sortOrder?r.sortOrder-p.sortOrder:r.title.localeCompare(p.title))}function fr(r){return r?Rn().filter(p=>r.has(p.id)):Rn()}const Ci={list:function(){return We!==null?fr(We):(ri().catch(()=>{}),Rn())},get:function(r){const p=Wt.get(String(r||""))||null;return!p||We!==null&&!We.has(p.id)?null:p},refreshConfig:async function(){We=null,Ze.clearCache&&typeof Ze.clearCache=="function"&&Ze.clearCache(),await ri()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Apps=Ci);let Cn=!1,un={screen:"startup"};const an=new Set;function pr(r,p){return!r||!p||r.screen!==p.screen?!1:r.screen==="app"?r.appId===p.appId:!0}function Pi(){an.forEach(r=>{try{r(ft.getState())}catch{}})}function tn(r){const p=r&&typeof r=="object"?r:{screen:"desktop"},m=p.screen==="app"?{screen:"app",appId:String(p.appId||"")}:{screen:p.screen==="startup"?"startup":"desktop"};pr(un,m)||(un=m,Pi())}const ft={init:function(r){Cn||(Cn=!0,r&&r.initialState&&tn(r.initialState),Pi())},getState:function(){return{...un}},subscribe:function(r){return typeof r!="function"?function(){}:(an.add(r),function(){an.delete(r)})},start:function(){tn({screen:"startup"})},goHome:function(){tn({screen:"desktop"})},openApp:function(r){tn({screen:"app",appId:r})},_resetForTests:function(){Cn=!1,un={screen:"startup"},an.clear()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Navigation=ft);const dr="/assets/images/winnieOS_logo_temp.png",hr=(function(){let r=null,p=!1;const m=new Map;function v(){m.forEach((a,i)=>{try{clearTimeout(i)}catch{}try{a()}catch{}}),m.clear()}function s(a){return new Promise(i=>{const n=setTimeout(()=>{m.delete(n),i()},a);m.set(n,i)})}async function e(a){const i=r?r.querySelector("[data-wos-startup-status]"):null,n=o=>{i&&(i.textContent=o)},d=[{label:"Waking up WinnieOS",run:()=>s(450)},{label:"Checking apps",run:()=>s(450)},{label:"Almost ready",run:()=>s(450)}];for(const o of d){if(p)return;n(o.label);try{await o.run()}catch{}}if(!p)try{a.goHome()}catch{}}return{mount:function(a){const i=a&&a.root,n=a&&a.nav;i&&(p=!1,r=document.createElement("div"),r.className="wos-startup",r.innerHTML=`
                <div class="wos-startup-logo-layer">
                    <img class="wos-startup-logo" src="${dr}" alt="WinnieOS" />
                </div>
                <div class="wos-startup-text-layer">
                    <div class="wos-startup-status">
                        <span data-wos-startup-status>Starting up</span>
                        <span class="wos-startup-dots" aria-hidden="true">
                            <span>.</span><span>.</span><span>.</span>
                        </span>
                    </div>
                </div>
            `,i.replaceChildren(r),n&&e(n))},unmount:function(){if(p=!0,v(),r&&r.parentNode)try{r.parentNode.removeChild(r)}catch{}r=null}}})(),mr=(function(){let r=null,p=null;function m(s,e){const a=document.createElement("button");if(a.className="wos-app-tile",a.type="button",a.setAttribute("aria-label",s.title),a.addEventListener("click",()=>e.openApp(s.id)),s.iconSrc){const n=document.createElement("img");n.className="wos-app-icon",n.alt="",n.src=s.iconSrc,a.appendChild(n)}else{const n=document.createElement("div");n.className="wos-app-emoji",n.textContent=s.iconEmoji||"â­",a.appendChild(n)}const i=document.createElement("div");return i.className="wos-app-title",i.textContent=s.title,a.appendChild(i),a}function v(s,e,a){if(p)try{p()}catch{}const i=a.list();r=document.createElement("div"),r.className="wos-desktop";const n=document.createElement("div");n.className="wos-desktop-inner";const d=document.createElement("div");d.className="wos-app-grid",i.forEach(u=>{d.appendChild(m(u,e))}),n.appendChild(d),r.appendChild(n),s.replaceChildren(r);const o=()=>{if(!r)return;const u=getComputedStyle(r),t=parseFloat(u.paddingTop)||0,c=parseFloat(u.paddingBottom)||0,l=Math.max(0,r.clientHeight-t-c),h=d.getBoundingClientRect().height;h>0&&h<l?r.classList.add("wos-desktop--centered"):r.classList.remove("wos-desktop--centered")},f=requestAnimationFrame(o);window.addEventListener("resize",o),p=()=>{try{cancelAnimationFrame(f)}catch{}window.removeEventListener("resize",o)}}return{mount:async function(s){const e=s&&s.root,a=s&&s.nav,i=s&&s.apps;if(!(!e||!a||!i)){if(i.refreshConfig&&typeof i.refreshConfig=="function")try{await i.refreshConfig()}catch(n){console.warn("DesktopScreen: Failed to load config, using safe defaults",n)}v(e,a,i)}},unmount:function(){if(p)try{p()}catch{}if(p=null,r&&r.parentNode)try{r.parentNode.removeChild(r)}catch{}r=null}}})(),gr=(function(){let r=null,p=null,m=null,v=null;function s(){if(typeof v=="function")try{v()}catch{}if(m&&typeof m.unmount=="function")try{m.unmount()}catch{}v=null,m=null}return{mount:function(e){const a=e&&e.root,i=e&&e.nav,n=e&&e.apps,d=e&&e.appId;if(!a||!n)return;r=document.createElement("div"),r.className="wos-app-host",p=document.createElement("div"),p.className="wos-app-root",r.appendChild(p),a.replaceChildren(r);const o=n.get(d);if(!o){p.className="wos-app-placeholder",p.innerHTML=`
                    <div class="wos-app-placeholder-title">Oops!</div>
                    <div class="wos-app-placeholder-text">That app isnâ€™t here yet.</div>
                `;return}m=o;try{const f=o.mount({root:p,nav:i});v=typeof f=="function"?f:null}catch{p.className="wos-app-placeholder",p.innerHTML=`
                    <div class="wos-app-placeholder-title">Uh oh!</div>
                    <div class="wos-app-placeholder-text">This app had a little problem starting.</div>
                `,m=null,v=null}},unmount:function(){if(s(),r&&r.parentNode)try{r.parentNode.removeChild(r)}catch{}r=null,p=null}}})(),Fn={startup:hr,desktop:mr,app:gr};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Screens=Fn);let Pn=!1,nn=null,Fe=null,st=null,Xe=null,Dn=null;function vr(){return document.getElementById("winnieos-canvas")}function yr(){const r=vr();if(!r)return!1;const p=r.querySelector(".wos-html-fallback");if(p&&p.parentNode)try{p.parentNode.removeChild(p)}catch{}Fe=r.querySelector("#wos-shell"),Fe||(Fe=document.createElement("div"),Fe.id="wos-shell",r.appendChild(Fe));let m=Fe.querySelector("#wos-topbar");m||(m=document.createElement("div"),m.id="wos-topbar",Fe.appendChild(m));let v=Fe.querySelector("#wos-home-btn");return v||(v=document.createElement("button"),v.id="wos-home-btn",v.type="button",v.setAttribute("aria-label","Home"),v.innerHTML=`
            <svg class="wos-home-icon" aria-hidden="true" viewBox="0 0 24 24" focusable="false">
                <path fill="currentColor" d="M12 3.2 3 10.4v10.4h6.2v-6.2h5.6v6.2H21V10.4L12 3.2Zm7 15.6h-2.6v-6.2H7.6v6.2H5V11.4l7-5.6 7 5.6v7.4Z"/>
            </svg>
        `,v.addEventListener("click",()=>ft.goHome()),m.appendChild(v)),st=Fe.querySelector("#wos-content"),st||(st=document.createElement("div"),st.id="wos-content",Fe.appendChild(st)),!0}function Ti(){if(Xe&&typeof Xe.unmount=="function")try{Xe.unmount()}catch{}Xe=null}async function si(r){if(!st||!Fe)return;const p=r&&r.screen?r.screen:"desktop";Fe.dataset.screen=p;const m=Fn[p]||Fn.desktop,v=p==="app"?`app:${String(r&&r.appId||"")}`:p;if(!(Xe===m&&Dn===v)&&(Ti(),Xe=m,Dn=v,Xe&&typeof Xe.mount=="function"))try{const s=Xe.mount({root:st,nav:ft,apps:Ci,appId:r&&r.appId});s&&typeof s.then=="function"&&await s}catch(s){console.error("Shell: Error mounting screen",s)}}const ln={init:function(){Pn||yr()&&(Pn=!0,ft.init({initialState:{screen:"startup"}}),nn=ft.subscribe(si),si(ft.getState()))},_resetForTests:function(){if(nn)try{nn()}catch{}nn=null,Ti(),Pn=!1,Fe=null,st=null,Dn=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Shell=ln);function ai(){!ln||typeof ln.init!="function"||ln.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ai):ai();
