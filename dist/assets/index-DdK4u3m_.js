(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}})();const Y="winnieos.display.reference",se={width:1280,height:800};let u=null;function X(e){if(e==null)return null;const t=String(e).trim();if(!t)return null;const o=t.match(/^([0-9.]+)px$/i);if(!o)return null;const n=Number(o[1]);return Number.isFinite(n)?n:null}function z(e,t,o){const n=Math.round(Number(e));return Number.isFinite(n)?Math.min(o,Math.max(t,n)):null}function le(e){return!!e&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>=320&&e.height>=240&&e.width<=7680&&e.height<=4320}function ae(){const e=document.documentElement,t=window.getComputedStyle(e),o=X(t.getPropertyValue("--ref-width")),n=X(t.getPropertyValue("--ref-height"));return Number.isFinite(o)&&Number.isFinite(n)&&o>0&&n>0?{width:Math.round(o),height:Math.round(n)}:null}function ge(){try{const e=window.localStorage.getItem(Y);if(!e)return null;const t=JSON.parse(e);if(!t||typeof t!="object")return null;const o=z(t.width,320,7680),n=z(t.height,240,4320),i={width:o,height:n};return le(i)?i:null}catch{return null}}function ve(e){try{window.localStorage.setItem(Y,JSON.stringify(e))}catch{}}function ye(){try{window.localStorage.removeItem(Y)}catch{}}function B(e){const t=document.documentElement;t.style.setProperty("--ref-width",e.width+"px"),t.style.setProperty("--ref-height",e.height+"px"),t.style.setProperty("--ref-aspect-ratio",String(e.width/e.height)),t.dataset.refWidth=String(e.width),t.dataset.refHeight=String(e.height)}function D(e){try{const t=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:e.width,height:e.height}}});document.dispatchEvent(t)}catch{}}function I(){u||(u=ge()||ae()||se,B(u))}const v={init:function(){I(),D(u)},getReferenceSize:function(){return I(),{width:u.width,height:u.height}},setReferenceSize:function(e){I();const t=z(e&&e.width,320,7680),o=z(e&&e.height,240,4320),n={width:t,height:o};return le(n)?(u=n,B(u),(!e||e.persist!==!1)&&ve(u),D(u),!0):!1},resetReferenceSize:function(){u=ae()||se,ye(),B(u),D(u)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=v);let W=null,b=null,T=!1,S=null;function A(){return W||(W=document.getElementById("winnieos-canvas")),W}function V(){if(v&&typeof v.getReferenceSize=="function"){const n=v.getReferenceSize();if(n&&Number.isFinite(n.width)&&Number.isFinite(n.height)&&n.width>0&&n.height>0)return{width:n.width,height:n.height}}const e=window.getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--ref-width")),o=parseFloat(e.getPropertyValue("--ref-height"));return Number.isFinite(t)&&Number.isFinite(o)&&t>0&&o>0?{width:Math.round(t),height:Math.round(o)}:{width:1280,height:800}}function ce(){const e=window.visualViewport;return e&&typeof e.width=="number"&&typeof e.height=="number"?{width:e.width,height:e.height,offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function Se(){const e=A();if(!e)return;const t=V(),o=t.width,n=t.height,i=ce(),r=i.width,s=i.height,l=Math.min(r/o,s/n),a=o*l,p=n*l,c=Math.round(i.offsetLeft+(r-a)/2),w=Math.round(i.offsetTop+(s-p)/2);e.style.position="fixed",e.style.width=o+"px",e.style.height=n+"px",e.style.left=c+"px",e.style.top=w+"px",e.style.margin="0",e.style.padding="0",e.style.transformOrigin="top left";const h=String(ue(l));e.style.transform=`scale(${h})`,e.dataset.scale=h,e.dataset.vw=String(Math.round(r)),e.dataset.vh=String(Math.round(s)),e.dataset.left=String(c),e.dataset.top=String(w),document.documentElement.style.setProperty("--viewport-scale",h)}function m(){b||(b=window.requestAnimationFrame(function(){b=null,Se()}))}function ue(e){return Math.round(e*1e5)/1e5}const K={init:function(){T||A()&&(T=!0,m(),window.addEventListener("resize",m),document.addEventListener("winnieos:displaychange",m),window.visualViewport&&(S=window.visualViewport,S.addEventListener("resize",m),S.addEventListener("scroll",m)))},getScale:function(){const e=A();return e?parseFloat(e.dataset.scale||"1"):1},getReferenceSize:function(){return V()},getMetrics:function(){const e=V(),t=ce(),o=A(),n=o?parseFloat(o.dataset.scale||"1"):ue(Math.min(t.width/e.width,t.height/e.height));return{reference:{width:e.width,height:e.height},viewport:{width:t.width,height:t.height,offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0},scale:n}},refresh:function(){m()},_resetForTests:function(){if(T&&(window.removeEventListener("resize",m),document.removeEventListener("winnieos:displaychange",m),S&&(S.removeEventListener("resize",m),S.removeEventListener("scroll",m))),b&&typeof window.cancelAnimationFrame=="function")try{window.cancelAnimationFrame(b)}catch{}T=!1,b=null,W=null,S=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=K);let C=!1,E=null;function Q(e){return e.preventDefault(),!1}function ee(e){if(e.key==="F5"||e.ctrlKey&&(e.key==="r"||e.key==="R")||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")||e.key==="Backspace"&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&!e.target.isContentEditable||e.ctrlKey&&(e.key==="w"||e.key==="W"))return e.preventDefault(),!1}function te(e){if(e.button===1)return e.preventDefault(),!1}function _e(e){return e.preventDefault(),!1}const q={init:function(){C||(C=!0,document.addEventListener("contextmenu",Q),document.addEventListener("keydown",ee),document.addEventListener("mousedown",te),E=_e,document.addEventListener("dragstart",E))},_resetForTests:function(){C&&(document.removeEventListener("contextmenu",Q),document.removeEventListener("keydown",ee),document.removeEventListener("mousedown",te),E&&document.removeEventListener("dragstart",E)),C=!1,E=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=q);let L=null,j=null;async function be(e,t){const o=typeof AbortController<"u"?new AbortController:null,n=o?setTimeout(()=>o.abort(),t):null;try{const i=await fetch(e,{cache:"no-store",signal:o?o.signal:void 0});return i.ok?await i.json():null}catch{return null}finally{n&&clearTimeout(n)}}const N={load:async function(){return L||j||(j=(async()=>(L=await be("/winnieos-config.json",750)||null,j=null,L))(),j)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Config=N);const Oe="winnieos.display.reference";function Ee(){try{return!!window.localStorage.getItem(Oe)}catch{return!1}}function je(e){const t=e&&e.display&&e.display.reference;if(!t||!Number.isFinite(t.width)||!Number.isFinite(t.height)||t.width<=0||t.height<=0||Ee())return;if(v&&typeof v.setReferenceSize=="function"){v.setReferenceSize({width:t.width,height:t.height,persist:!1});return}const o=document.documentElement;o.style.setProperty("--ref-width",`${Math.round(t.width)}px`),o.style.setProperty("--ref-height",`${Math.round(t.height)}px`),o.style.setProperty("--ref-aspect-ratio",String(t.width/t.height))}function ne(){const e=N&&typeof N.load=="function"?N.load():Promise.resolve(null);v?v.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),K?K.init():console.error("WinnieOS: Viewport module failed to load"),q?q.init():console.error("WinnieOS: Kiosk module failed to load"),e.then(je).catch(()=>{})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ne):ne();const Ne={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=Ne);const Te={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=Te);const Ce={id:"animals",title:"Animals",iconEmoji:"ðŸ¦",sortOrder:25,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Animals</div>
            <div class="wos-app-placeholder-text">Animal sounds and matching will live here.</div>
        `)},unmount:function(){}},Le=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"})),Me={id:"blocks",title:"Blocks",iconEmoji:"ðŸ§±",sortOrder:15,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Blocks</div>
            <div class="wos-app-placeholder-text">A building blocks game will live here.</div>
        `)},unmount:function(){}},Pe=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"})),We={id:"bubbles",title:"Bubbles",iconEmoji:"ðŸ«§",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Bubbles</div>
            <div class="wos-app-placeholder-text">Pop pop pop!</div>
        `)},unmount:function(){}},Ae=Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"})),ke={id:"colors",title:"Colors",iconEmoji:"ðŸŒˆ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Colors</div>
            <div class="wos-app-placeholder-text">Tap colors and paint the world.</div>
        `)},unmount:function(){}},Fe=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"})),ze={id:"dance",title:"Dance",iconEmoji:"ðŸ’ƒ",sortOrder:55,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Dance</div>
            <div class="wos-app-placeholder-text">A dance party will live here.</div>
        `)},unmount:function(){}},He=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"})),De={id:"garden",title:"Garden",iconEmoji:"ðŸŒ»",sortOrder:60,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Garden</div>
            <div class="wos-app-placeholder-text">Plant and grow little flowers.</div>
        `)},unmount:function(){}},Ie=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"})),$e={id:"memory",title:"Memory",iconEmoji:"ðŸ§ ",sortOrder:45,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Memory</div>
            <div class="wos-app-placeholder-text">A simple matching game will live here.</div>
        `)},unmount:function(){}},Re=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"})),Be={id:"music",title:"Music",iconEmoji:"ðŸŽµ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Music</div>
            <div class="wos-app-placeholder-text">This will become a simple music player with big buttons.</div>
        `)},unmount:function(){}},Ve=Object.freeze(Object.defineProperty({__proto__:null,default:Be},Symbol.toStringTag,{value:"Module"})),Ke={id:"numbers",title:"Numbers",iconEmoji:"ðŸ”¢",sortOrder:35,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Numbers</div>
            <div class="wos-app-placeholder-text">Count and tap!</div>
        `)},unmount:function(){}},qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"})),Ge={id:"paint",title:"Paint",iconEmoji:"ðŸŽ¨",sortOrder:10,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Paint</div>
            <div class="wos-app-placeholder-text">A simple drawing app will live here.</div>
        `)},unmount:function(){}},xe=Object.freeze(Object.defineProperty({__proto__:null,default:Ge},Symbol.toStringTag,{value:"Module"})),Ue={id:"piano",title:"Piano",iconEmoji:"ðŸŽ¹",sortOrder:50,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Piano</div>
            <div class="wos-app-placeholder-text">Tap keys to make music.</div>
        `)},unmount:function(){}},Je=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"})),Ye={id:"shapes",title:"Shapes",iconEmoji:"ðŸ”º",sortOrder:40,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Shapes</div>
            <div class="wos-app-placeholder-text">Match the shapes.</div>
        `)},unmount:function(){}},Ze=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),Xe={id:"story",title:"Story Time",iconEmoji:"ðŸ“–",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Story Time</div>
            <div class="wos-app-placeholder-text">Soon weâ€™ll read and play through stories here.</div>
        `)},unmount:function(){}},Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));function et(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"&&e.id.trim()?e.id.trim():null,o=typeof e.title=="string"&&e.title.trim()?e.title.trim():null,n=typeof e.mount=="function"?e.mount:null,i=typeof e.unmount=="function"?e.unmount:null;return!t||!o||!n?null:{id:t,title:o,iconSrc:typeof e.iconSrc=="string"?e.iconSrc:null,iconEmoji:typeof e.iconEmoji=="string"?e.iconEmoji:null,sortOrder:Number.isFinite(e.sortOrder)?e.sortOrder:0,mount:n,unmount:i}}const oe=Object.assign({"./animals/app.js":Le,"./blocks/app.js":Pe,"./bubbles/app.js":Ae,"./colors/app.js":Fe,"./dance/app.js":He,"./garden/app.js":Ie,"./memory/app.js":Re,"./music/app.js":Ve,"./numbers/app.js":qe,"./paint/app.js":xe,"./piano/app.js":Je,"./shapes/app.js":Ze,"./story/app.js":Qe}),O=new Map;Object.keys(oe).forEach(e=>{const t=oe[e],o=t&&(t.default||t.app)||null,n=et(o);if(!n){console.warn(`WinnieOS.Apps: invalid app module at ${e}`);return}if(O.has(n.id)){console.warn(`WinnieOS.Apps: duplicate app id "${n.id}" (skipping ${e})`);return}O.set(n.id,n)});let f=null;async function G(){if(f!==null)return f;try{const e=await N.load();e&&e.apps&&Array.isArray(e.apps.enabled)?f=new Set(e.apps.enabled.map(t=>String(t).trim()).filter(Boolean)):f=new Set(O.keys())}catch(e){console.warn("WinnieOS.Apps: failed to load config, enabling all apps",e),f=new Set(O.keys())}return f}function x(){return Array.from(O.values()).sort((e,t)=>e.sortOrder!==t.sortOrder?e.sortOrder-t.sortOrder:e.title.localeCompare(t.title))}function tt(e){return e?x().filter(t=>e.has(t.id)):x()}typeof window<"u"&&G().catch(()=>{});const de={list:function(){return f!==null?tt(f):(G().catch(()=>{}),x())},get:function(e){const t=O.get(String(e||""))||null;return!t||f!==null&&!f.has(t.id)?null:t},refreshConfig:async function(){f=null,await G()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Apps=de);let $=!1,H={screen:"startup"};const k=new Set;function nt(e,t){return!e||!t||e.screen!==t.screen?!1:e.screen==="app"?e.appId===t.appId:!0}function pe(){k.forEach(e=>{try{e(_.getState())}catch{}})}function M(e){const t=e&&typeof e=="object"?e:{screen:"desktop"},o=t.screen==="app"?{screen:"app",appId:String(t.appId||"")}:{screen:t.screen==="startup"?"startup":"desktop"};nt(H,o)||(H=o,pe())}const _={init:function(e){$||($=!0,e&&e.initialState&&M(e.initialState),pe())},getState:function(){return{...H}},subscribe:function(e){return typeof e!="function"?function(){}:(k.add(e),function(){k.delete(e)})},start:function(){M({screen:"startup"})},goHome:function(){M({screen:"desktop"})},openApp:function(e){M({screen:"app",appId:e})},_resetForTests:function(){$=!1,H={screen:"startup"},k.clear()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Navigation=_);const ot="/assets/images/winnieOS_logo_temp.png",it=(function(){let e=null,t=!1;const o=new Map;function n(){o.forEach((s,l)=>{try{clearTimeout(l)}catch{}try{s()}catch{}}),o.clear()}function i(s){return new Promise(l=>{const a=setTimeout(()=>{o.delete(a),l()},s);o.set(a,l)})}async function r(s){const l=e?e.querySelector("[data-wos-startup-status]"):null,a=c=>{l&&(l.textContent=c)},p=[{label:"Waking up WinnieOS",run:()=>i(450)},{label:"Checking apps",run:()=>i(450)},{label:"Almost ready",run:()=>i(450)}];for(const c of p){if(t)return;a(c.label);try{await c.run()}catch{}}if(!t)try{s.goHome()}catch{}}return{mount:function(s){const l=s&&s.root,a=s&&s.nav;l&&(t=!1,e=document.createElement("div"),e.className="wos-startup",e.innerHTML=`
                <div class="wos-startup-logo-layer">
                    <img class="wos-startup-logo" src="${ot}" alt="WinnieOS" />
                </div>
                <div class="wos-startup-text-layer">
                    <div class="wos-startup-status">
                        <span data-wos-startup-status>Starting up</span>
                        <span class="wos-startup-dots" aria-hidden="true">
                            <span>.</span><span>.</span><span>.</span>
                        </span>
                    </div>
                </div>
            `,l.replaceChildren(e),a&&r(a))},unmount:function(){if(t=!0,n(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),rt=(function(){let e=null,t=null;function o(i,r){const s=document.createElement("button");if(s.className="wos-app-tile",s.type="button",s.setAttribute("aria-label",i.title),s.addEventListener("click",()=>r.openApp(i.id)),i.iconSrc){const a=document.createElement("img");a.className="wos-app-icon",a.alt="",a.src=i.iconSrc,s.appendChild(a)}else{const a=document.createElement("div");a.className="wos-app-emoji",a.textContent=i.iconEmoji||"â­",s.appendChild(a)}const l=document.createElement("div");return l.className="wos-app-title",l.textContent=i.title,s.appendChild(l),s}function n(i,r,s){if(t)try{t()}catch{}const l=s.list();e=document.createElement("div"),e.className="wos-desktop";const a=document.createElement("div");a.className="wos-desktop-inner";const p=document.createElement("div");p.className="wos-app-grid",l.forEach(h=>{p.appendChild(o(h,r))}),a.appendChild(p),e.appendChild(a),i.replaceChildren(e);const c=()=>{if(!e)return;const h=getComputedStyle(e),he=parseFloat(h.paddingTop)||0,me=parseFloat(h.paddingBottom)||0,we=Math.max(0,e.clientHeight-he-me),Z=p.getBoundingClientRect().height;Z>0&&Z<we?e.classList.add("wos-desktop--centered"):e.classList.remove("wos-desktop--centered")},w=requestAnimationFrame(c);window.addEventListener("resize",c),t=()=>{try{cancelAnimationFrame(w)}catch{}window.removeEventListener("resize",c)}}return{mount:function(i){const r=i&&i.root,s=i&&i.nav,l=i&&i.apps;if(!r||!s||!l)return;n(r,s,l);const a=l.list().length;l.refreshConfig&&typeof l.refreshConfig=="function"&&l.refreshConfig().then(()=>{e&&e.parentNode===r&&l.list().length!==a&&n(r,s,l)}).catch(()=>{})},unmount:function(){if(t)try{t()}catch{}if(t=null,e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),st=(function(){let e=null,t=null,o=null,n=null;function i(){if(typeof n=="function")try{n()}catch{}if(o&&typeof o.unmount=="function")try{o.unmount()}catch{}n=null,o=null}return{mount:function(r){const s=r&&r.root,l=r&&r.nav,a=r&&r.apps,p=r&&r.appId;if(!s||!a)return;e=document.createElement("div"),e.className="wos-app-host",t=document.createElement("div"),t.className="wos-app-root",e.appendChild(t),s.replaceChildren(e);const c=a.get(p);if(!c){t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Oops!</div>
                    <div class="wos-app-placeholder-text">That app isnâ€™t here yet.</div>
                `;return}o=c;try{const w=c.mount({root:t,nav:l});n=typeof w=="function"?w:null}catch{t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Uh oh!</div>
                    <div class="wos-app-placeholder-text">This app had a little problem starting.</div>
                `,o=null,n=null}},unmount:function(){if(i(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null,t=null}}})(),U={startup:it,desktop:rt,app:st};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Screens=U);let R=!1,P=null,d=null,y=null,g=null,J=null;function lt(){return document.getElementById("winnieos-canvas")}function at(){const e=lt();if(!e)return!1;const t=e.querySelector(".wos-html-fallback");if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch{}d=e.querySelector("#wos-shell"),d||(d=document.createElement("div"),d.id="wos-shell",e.appendChild(d));let o=d.querySelector("#wos-topbar");o||(o=document.createElement("div"),o.id="wos-topbar",d.appendChild(o));let n=d.querySelector("#wos-home-btn");return n||(n=document.createElement("button"),n.id="wos-home-btn",n.type="button",n.setAttribute("aria-label","Home"),n.innerHTML=`
            <svg class="wos-home-icon" aria-hidden="true" viewBox="0 0 24 24" focusable="false">
                <path fill="currentColor" d="M12 3.2 3 10.4v10.4h6.2v-6.2h5.6v6.2H21V10.4L12 3.2Zm7 15.6h-2.6v-6.2H7.6v6.2H5V11.4l7-5.6 7 5.6v7.4Z"/>
            </svg>
        `,n.addEventListener("click",()=>_.goHome()),o.appendChild(n)),y=d.querySelector("#wos-content"),y||(y=document.createElement("div"),y.id="wos-content",d.appendChild(y)),!0}function fe(){if(g&&typeof g.unmount=="function")try{g.unmount()}catch{}g=null}function ie(e){if(!y||!d)return;const t=e&&e.screen?e.screen:"desktop";d.dataset.screen=t;const o=U[t]||U.desktop,n=t==="app"?`app:${String(e&&e.appId||"")}`:t;g===o&&J===n||(fe(),g=o,J=n,g&&typeof g.mount=="function"&&g.mount({root:y,nav:_,apps:de,appId:e&&e.appId}))}const F={init:function(){R||at()&&(R=!0,_.init({initialState:{screen:"startup"}}),P=_.subscribe(ie),ie(_.getState()))},_resetForTests:function(){if(P)try{P()}catch{}P=null,fe(),R=!1,d=null,y=null,J=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Shell=F);function re(){!F||typeof F.init!="function"||F.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",re):re();
