(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Q="winnieos.";function U(){try{if(typeof window>"u"||!window.localStorage)return!1;const e="__storage_test__";return window.localStorage.setItem(e,"test"),window.localStorage.removeItem(e),!0}catch{return!1}}function ne(e){if(!e||typeof e!="string")throw new Error("Storage key must be a non-empty string");return e.startsWith(Q)?e:Q+e}const B={get:function(e,t=null){if(!U())return t;try{const n=ne(e),o=window.localStorage.getItem(n);if(o===null)return t;try{return JSON.parse(o)}catch{return o}}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return t}},set:function(e,t){if(!U())return!1;try{const n=ne(e),o=JSON.stringify(t);return window.localStorage.setItem(n,o),!0}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return!1}},remove:function(e){if(!U())return!1;try{const t=ne(e);return window.localStorage.removeItem(t),!0}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},has:function(e){if(!U())return!1;try{const t=ne(e);return window.localStorage.getItem(t)!==null}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},clear:function(){if(!U())return!1;try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(Q)&&e.push(n)}return e.forEach(t=>window.localStorage.removeItem(t)),!0}catch{return!1}},keys:function(){if(!U())return[];try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(Q)&&e.push(n.substring(Q.length))}return e}catch{return[]}}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Storage=B);const Te="display.reference",xe={width:1280,height:800};let M=null;function Ae(e){if(e==null)return null;const t=String(e).trim();if(!t)return null;const n=t.match(/^([0-9.]+)px$/i);if(!n)return null;const o=Number(n[1]);return Number.isFinite(o)?o:null}function de(e,t,n){const o=Math.round(Number(e));return Number.isFinite(o)?Math.min(n,Math.max(t,o)):null}function Be(e){return!!e&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>=320&&e.height>=240&&e.width<=7680&&e.height<=4320}function Ke(){const e=document.documentElement,t=window.getComputedStyle(e),n=Ae(t.getPropertyValue("--ref-width")),o=Ae(t.getPropertyValue("--ref-height"));return Number.isFinite(n)&&Number.isFinite(o)&&n>0&&o>0?{width:Math.round(n),height:Math.round(o)}:null}function it(){const e=B.get(Te);if(!e||typeof e!="object")return null;const t=de(e.width,320,7680),n=de(e.height,240,4320),o={width:t,height:n};return Be(o)?o:null}function rt(e){B.set(Te,e)}function st(){B.remove(Te)}function ye(e){const t=document.documentElement;t.style.setProperty("--ref-width",e.width+"px"),t.style.setProperty("--ref-height",e.height+"px"),t.style.setProperty("--ref-aspect-ratio",String(e.width/e.height)),t.dataset.refWidth=String(e.width),t.dataset.refHeight=String(e.height)}function he(e){try{const t=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:e.width,height:e.height}}});document.dispatchEvent(t)}catch{}}function me(){M||(M=it()||Ke()||xe,ye(M))}const F={init:function(){me(),he(M)},getReferenceSize:function(){return me(),{width:M.width,height:M.height}},setReferenceSize:function(e){me();const t=de(e&&e.width,320,7680),n=de(e&&e.height,240,4320),o={width:t,height:n};return Be(o)?(M=o,ye(M),(!e||e.persist!==!1)&&rt(M),he(M),!0):!1},resetReferenceSize:function(){M=Ke()||xe,st(),ye(M),he(M)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=F);let ae=null,q=null,oe=!1,$=null;function le(){return ae||(ae=document.getElementById("winnieos-canvas")),ae}function ve(){if(F&&typeof F.getReferenceSize=="function"){const o=F.getReferenceSize();if(o&&Number.isFinite(o.width)&&Number.isFinite(o.height)&&o.width>0&&o.height>0)return{width:o.width,height:o.height}}const e=window.getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--ref-width")),n=parseFloat(e.getPropertyValue("--ref-height"));return Number.isFinite(t)&&Number.isFinite(n)&&t>0&&n>0?{width:Math.round(t),height:Math.round(n)}:{width:1280,height:800}}function Ue(){const e=window.visualViewport;return e&&typeof e.width=="number"&&typeof e.height=="number"?{width:e.width,height:e.height,offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function at(){const e=le();if(!e)return;const t=ve(),n=t.width,o=t.height,i=Ue(),s=i.width,l=i.height,c=Math.min(s/n,l/o),a=n*c,_=o*c,g=Math.round(i.offsetLeft+(s-a)/2),y=Math.round(i.offsetTop+(l-_)/2);e.style.position="fixed",e.style.width=n+"px",e.style.height=o+"px",e.style.left=g+"px",e.style.top=y+"px",e.style.margin="0",e.style.padding="0",e.style.transformOrigin="top left";const b=String(Ve(c));e.style.transform=`scale(${b})`,e.dataset.scale=b,e.dataset.vw=String(Math.round(s)),e.dataset.vh=String(Math.round(l)),e.dataset.left=String(g),e.dataset.top=String(y),document.documentElement.style.setProperty("--viewport-scale",b)}function W(){q||(q=window.requestAnimationFrame(function(){q=null,at()}))}function Ve(e){return Math.round(e*1e5)/1e5}const Se={init:function(){oe||le()&&(oe=!0,W(),window.addEventListener("resize",W),document.addEventListener("winnieos:displaychange",W),window.visualViewport&&($=window.visualViewport,$.addEventListener("resize",W),$.addEventListener("scroll",W)))},getScale:function(){const e=le();return e?parseFloat(e.dataset.scale||"1"):1},getReferenceSize:function(){return ve()},getMetrics:function(){const e=ve(),t=Ue(),n=le(),o=n?parseFloat(n.dataset.scale||"1"):Ve(Math.min(t.width/e.width,t.height/e.height));return{reference:{width:e.width,height:e.height},viewport:{width:t.width,height:t.height,offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0},scale:o}},refresh:function(){W()},_resetForTests:function(){if(oe&&(window.removeEventListener("resize",W),document.removeEventListener("winnieos:displaychange",W),$&&($.removeEventListener("resize",W),$.removeEventListener("scroll",W))),q&&typeof window.cancelAnimationFrame=="function")try{window.cancelAnimationFrame(q)}catch{}oe=!1,q=null,ae=null,$=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=Se);let ie=!1,J=null;function Pe(e){return e.preventDefault(),!1}function Fe(e){if(e.key==="F5"||e.ctrlKey&&(e.key==="r"||e.key==="R")||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")||e.key==="Backspace"&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&!e.target.isContentEditable||e.ctrlKey&&(e.key==="w"||e.key==="W"))return e.preventDefault(),!1}function Ie(e){if(e.button===1)return e.preventDefault(),!1}function lt(e){return e.preventDefault(),!1}const be={init:function(){ie||(ie=!0,document.addEventListener("contextmenu",Pe),document.addEventListener("keydown",Fe),document.addEventListener("mousedown",Ie),J=lt,document.addEventListener("dragstart",J))},_resetForTests:function(){ie&&(document.removeEventListener("contextmenu",Pe),document.removeEventListener("keydown",Fe),document.removeEventListener("mousedown",Ie),J&&document.removeEventListener("dragstart",J)),ie=!1,J=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=be);let Z=null,V=null;function ct(e){return new Promise(t=>setTimeout(t,e))}async function ut(e,t){const n=typeof AbortController<"u"?new AbortController:null,o=n?setTimeout(()=>n.abort(),t):null;try{const i=await fetch(e,{cache:"no-store",signal:n?n.signal:void 0});return i.ok?await i.json():null}catch{return null}finally{o&&clearTimeout(o)}}const R={load:async function(){return Z||V||(V=(async()=>{const e=[{timeoutMs:1500,sleepMs:250},{timeoutMs:1500,sleepMs:250},{timeoutMs:2e3,sleepMs:500},{timeoutMs:2500,sleepMs:750}];let t=null;for(let n=0;n<e.length;n++){const o=e[n];if(t=await ut("/winnieos-config.json",o.timeoutMs),t&&typeof t=="object")break;o.sleepMs&&await ct(o.sleepMs)}return Z=t&&typeof t=="object"?t:null,V=null,Z})(),V)},clearCache:function(){Z=null,V=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Config=R);const qe="preferences.backgroundColor",dt="#667eea",pt="#764ba2";function Ge(e,t,n){const o=i=>{const s=Math.round(Math.max(0,Math.min(255,i))).toString(16);return s.length===1?"0"+s:s};return`#${o(e)}${o(t)}${o(n)}`}function Ye(e){if(!e||typeof e!="string")return{r:0,g:0,b:0};let t=e.replace("#","").trim();if(t.length===3&&(t=t.split("").map(s=>s+s).join("")),t.length!==6||!/^[0-9a-fA-F]{6}$/.test(t))return{r:0,g:0,b:0};const n=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16);return!Number.isFinite(n)||!Number.isFinite(o)||!Number.isFinite(i)?{r:0,g:0,b:0}:{r:n,g:o,b:i}}function Xe(e){const t=Ye(e),n=t.r/255,o=t.g/255,i=t.b/255,s=Math.max(n,o,i),l=Math.min(n,o,i),c=s-l;let a=0;c!==0&&(s===n?a=(o-i)/c%6:s===o?a=(i-n)/c+2:a=(n-o)/c+4),a=Math.round(a*60),a<0&&(a+=360),a=(a+30)%360;const _=(s+l)/2,g=c===0?0:c/(1-Math.abs(2*_-1)),y=(1-Math.abs(2*_-1))*g,b=y*(1-Math.abs(a/60%2-1)),D=_-y/2;let T=0,v=0,E=0;return a<60?(T=y,v=b,E=0):a<120?(T=b,v=y,E=0):a<180?(T=0,v=y,E=b):a<240?(T=0,v=b,E=y):a<300?(T=b,v=0,E=y):(T=y,v=0,E=b),Ge(Math.round((T+D)*255),Math.round((v+D)*255),Math.round((E+D)*255))}function _e(e,t=null){if(!e||typeof e!="string")return;const n=t||Xe(e),o=document.body,i=document.getElementById("winnieos-canvas");o&&o.style.setProperty("background",e),i&&i.style.setProperty("background",`linear-gradient(135deg, ${e} 0%, ${n} 100%)`)}function Je(){return B.get(qe,null)}function ft(e){return!e||typeof e!="string"?!1:B.set(qe,e)}function ht(){const e=Je();e?_e(e):_e(dt,pt)}const A={apply:_e,getSaved:Je,save:ft,load:ht,rgbToHex:Ge,hexToRgb:Ye,generateSecondary:Xe};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Background=A);const mt="display.reference";function wt(){return B.has(mt)}function gt(e){const t=e&&e.display&&e.display.reference;if(!t||!Number.isFinite(t.width)||!Number.isFinite(t.height)||t.width<=0||t.height<=0||wt())return;if(F&&typeof F.setReferenceSize=="function"){F.setReferenceSize({width:t.width,height:t.height,persist:!1});return}const n=document.documentElement;n.style.setProperty("--ref-width",`${Math.round(t.width)}px`),n.style.setProperty("--ref-height",`${Math.round(t.height)}px`),n.style.setProperty("--ref-aspect-ratio",String(t.width/t.height))}function Re(){const e=R&&typeof R.load=="function"?R.load():Promise.resolve(null);F?F.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),Se?Se.init():console.error("WinnieOS: Viewport module failed to load"),be?be.init():console.error("WinnieOS: Kiosk module failed to load"),A&&typeof A.load=="function"&&A.load(),e.then(gt).catch(()=>{})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Re):Re();const yt={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=yt);const vt={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=vt);const St={id:"animals",title:"Animals",iconEmoji:"ðŸ¦",sortOrder:25,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Animals</div>
            <div class="wos-app-placeholder-text">Animal sounds and matching will live here.</div>
        `)},unmount:function(){}},bt=Object.freeze(Object.defineProperty({__proto__:null,default:St},Symbol.toStringTag,{value:"Module"})),_t={id:"blocks",title:"Blocks",iconEmoji:"ðŸ§±",sortOrder:15,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Blocks</div>
            <div class="wos-app-placeholder-text">A building blocks game will live here.</div>
        `)},unmount:function(){}},Mt=Object.freeze(Object.defineProperty({__proto__:null,default:_t},Symbol.toStringTag,{value:"Module"})),Ot={id:"bubbles",title:"Bubbles",iconEmoji:"ðŸ«§",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Bubbles</div>
            <div class="wos-app-placeholder-text">Pop pop pop!</div>
        `)},unmount:function(){}},Et=Object.freeze(Object.defineProperty({__proto__:null,default:Ot},Symbol.toStringTag,{value:"Module"})),Tt={id:"colors",title:"Colors",iconEmoji:"ðŸŒˆ",sortOrder:30,mount:function({root:e}){if(!e)return;e.className="wos-colors-app",e.innerHTML="";const t=document.createElement("div");t.className="wos-colors-container";const n=document.createElement("div");n.className="wos-colors-picker",n.setAttribute("role","application"),n.setAttribute("aria-label","Color picker");const o=document.createElement("canvas");o.className="wos-colors-canvas";const i=.35,s=.95;let l=0;const c=r=>Math.max(0,Math.min(1,r)),a=(r,p,f)=>{r=r%360,r<0&&(r+=360);const u=f*p,h=u*(1-Math.abs(r/60%2-1)),m=f-u;let d=0,w=0,S=0;return r<60?(d=u,w=h,S=0):r<120?(d=h,w=u,S=0):r<180?(d=0,w=u,S=h):r<240?(d=0,w=h,S=u):r<300?(d=h,w=0,S=u):(d=u,w=0,S=h),{r:Math.round((d+m)*255),g:Math.round((w+m)*255),b:Math.round((S+m)*255)}},_=(r,p,f)=>{r=r/255,p=p/255,f=f/255;const u=Math.max(r,p,f),h=Math.min(r,p,f),m=u-h;let d=0;m!==0&&(u===r?d=(p-f)/m%6:u===p?d=(f-r)/m+2:d=(r-p)/m+4),d=Math.round(d*60),d<0&&(d+=360);const w=u===0?0:m/u;return{h:d,s:w,v:u}},g=()=>{const r=n.getBoundingClientRect(),p=Math.max(1,r.width),f=Math.max(1,r.height),u=p/2,h=f/2,m=Math.min(u,h);return{rect:r,width:p,height:f,cx:u,cy:h,radius:m}},y=r=>i+(1-i)*c(r),b=r=>c((r-i)/(1-i)),D=(r,p)=>{const{rect:f,width:u,height:h,cx:m,cy:d,radius:w}=g(),S=r-f.left,z=p-f.top,L=S-m,N=z-d,j=Math.sqrt(L*L+N*N),H=Math.min(w,j),K=Math.atan2(N,L),Y=j<1?l:(K*180/Math.PI+360)%360,te=w<=0?0:H/w;return{width:u,height:h,cx:m,cy:d,radius:w,dx:L,dy:N,distance:j,distClamped:H,angle:K,hue:Y,t:te}},T=({hue:r,t:p})=>{const f=y(p),u=a(r,f,s);return A.rgbToHex(u.r,u.g,u.b)},v=document.createElement("div");v.className="wos-colors-indicator",v.setAttribute("aria-hidden","true");const E=({cx:r,cy:p,radius:f,angle:u,distClamped:h,width:m,height:d})=>{const w=r+Math.cos(u)*h,S=p+Math.sin(u)*h;v.style.left=`${w/m*100}%`,v.style.top=`${S/d*100}%`},Ce=()=>{const r=A.getSaved(),{width:p,height:f,cx:u,cy:h,radius:m}=g();if(!r||m<=0){v.style.left="50%",v.style.top="50%";return}const d=A.hexToRgb(r),w=_(d.r,d.g,d.b);l=w.h;const S=b(w.s),z=w.h*Math.PI/180,L=S*m,N=u+Math.cos(z)*L,j=h+Math.sin(z)*L;v.style.left=`${N/p*100}%`,v.style.top=`${j/f*100}%`},Le=()=>{const r=n.getBoundingClientRect(),p=window.devicePixelRatio||1,f=Math.max(1,Math.floor(r.width)),u=Math.max(1,Math.floor(r.height)),h=Math.max(1,Math.floor(f*p)),m=Math.max(1,Math.floor(u*p));o.width=h,o.height=m;const d=o.getContext("2d");if(!d)return;const w=d.createImageData(h,m),S=w.data,z=h/2,L=m/2,N=Math.min(z,L);for(let j=0;j<m;j++)for(let H=0;H<h;H++){const K=H-z,Y=j-L,te=Math.sqrt(K*K+Y*Y),X=(j*h+H)*4;if(te>N){S[X+3]=0;continue}const tt=(Math.atan2(Y,K)*180/Math.PI+360)%360,nt=N<=0?0:te/N,ot=y(nt),fe=a(tt,ot,s);S[X]=fe.r,S[X+1]=fe.g,S[X+2]=fe.b,S[X+3]=255}d.putImageData(w,0,0)};n.appendChild(o),n.appendChild(v),t.appendChild(n),e.appendChild(t),requestAnimationFrame(()=>{Le(),Ce()});const Ne=new ResizeObserver(()=>{Le(),Ce()});Ne.observe(n);let k=null;const je=(r,p)=>{const f=D(r,p);l=f.hue,E(f);const u=T(f);v.classList.add("wos-colors-indicator-active"),setTimeout(()=>{v.classList.remove("wos-colors-indicator-active")},180),A.apply(u),A.save(u)},We=r=>{if(k===null){k=r.pointerId;try{n.setPointerCapture(k)}catch{}r.preventDefault(),je(r.clientX,r.clientY)}},ke=r=>{k===null||r.pointerId!==k||(r.preventDefault(),je(r.clientX,r.clientY))},ee=r=>{if(!(k===null||r.pointerId!==k)){r.preventDefault();try{n.releasePointerCapture(k)}catch{}k=null}};return n.addEventListener("pointerdown",We),n.addEventListener("pointermove",ke),n.addEventListener("pointerup",ee),n.addEventListener("pointercancel",ee),function(){try{Ne.disconnect()}catch{}n.removeEventListener("pointerdown",We),n.removeEventListener("pointermove",ke),n.removeEventListener("pointerup",ee),n.removeEventListener("pointercancel",ee)}},unmount:function(){}},Ct=Object.freeze(Object.defineProperty({__proto__:null,default:Tt},Symbol.toStringTag,{value:"Module"})),Lt={id:"dance",title:"Dance",iconEmoji:"ðŸ’ƒ",sortOrder:55,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Dance</div>
            <div class="wos-app-placeholder-text">A dance party will live here.</div>
        `)},unmount:function(){}},Nt=Object.freeze(Object.defineProperty({__proto__:null,default:Lt},Symbol.toStringTag,{value:"Module"})),jt={id:"garden",title:"Garden",iconEmoji:"ðŸŒ»",sortOrder:60,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Garden</div>
            <div class="wos-app-placeholder-text">Plant and grow little flowers.</div>
        `)},unmount:function(){}},Wt=Object.freeze(Object.defineProperty({__proto__:null,default:jt},Symbol.toStringTag,{value:"Module"})),kt={id:"memory",title:"Memory",iconEmoji:"ðŸ§ ",sortOrder:45,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Memory</div>
            <div class="wos-app-placeholder-text">A simple matching game will live here.</div>
        `)},unmount:function(){}},At=Object.freeze(Object.defineProperty({__proto__:null,default:kt},Symbol.toStringTag,{value:"Module"})),Pt={id:"music",title:"Music",iconEmoji:"ðŸŽµ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Music</div>
            <div class="wos-app-placeholder-text">This will become a simple music player with big buttons.</div>
        `)},unmount:function(){}},Ft=Object.freeze(Object.defineProperty({__proto__:null,default:Pt},Symbol.toStringTag,{value:"Module"})),It={id:"numbers",title:"Numbers",iconEmoji:"ðŸ”¢",sortOrder:35,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Numbers</div>
            <div class="wos-app-placeholder-text">Count and tap!</div>
        `)},unmount:function(){}},Rt=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"})),Dt={id:"paint",title:"Paint",iconEmoji:"ðŸŽ¨",sortOrder:10,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Paint</div>
            <div class="wos-app-placeholder-text">A simple drawing app will live here.</div>
        `)},unmount:function(){}},zt=Object.freeze(Object.defineProperty({__proto__:null,default:Dt},Symbol.toStringTag,{value:"Module"})),Ht={id:"piano",title:"Piano",iconEmoji:"ðŸŽ¹",sortOrder:50,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Piano</div>
            <div class="wos-app-placeholder-text">Tap keys to make music.</div>
        `)},unmount:function(){}},$t=Object.freeze(Object.defineProperty({__proto__:null,default:Ht},Symbol.toStringTag,{value:"Module"})),xt={id:"shapes",title:"Shapes",iconEmoji:"ðŸ”º",sortOrder:40,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Shapes</div>
            <div class="wos-app-placeholder-text">Match the shapes.</div>
        `)},unmount:function(){}},Bt=Object.freeze(Object.defineProperty({__proto__:null,default:xt},Symbol.toStringTag,{value:"Module"})),Kt={id:"story",title:"Story Time",iconEmoji:"ðŸ“–",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Story Time</div>
            <div class="wos-app-placeholder-text">Soon weâ€™ll read and play through stories here.</div>
        `)},unmount:function(){}},Ut=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"}));function Vt(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"&&e.id.trim()?e.id.trim():null,n=typeof e.title=="string"&&e.title.trim()?e.title.trim():null,o=typeof e.mount=="function"?e.mount:null,i=typeof e.unmount=="function"?e.unmount:null;return!t||!n||!o?null:{id:t,title:n,iconSrc:typeof e.iconSrc=="string"?e.iconSrc:null,iconEmoji:typeof e.iconEmoji=="string"?e.iconEmoji:null,sortOrder:Number.isFinite(e.sortOrder)?e.sortOrder:0,mount:o,unmount:i}}const De=Object.assign({"./animals/app.js":bt,"./blocks/app.js":Mt,"./bubbles/app.js":Et,"./colors/app.js":Ct,"./dance/app.js":Nt,"./garden/app.js":Wt,"./memory/app.js":At,"./music/app.js":Ft,"./numbers/app.js":Rt,"./paint/app.js":zt,"./piano/app.js":$t,"./shapes/app.js":Bt,"./story/app.js":Ut}),G=new Map;Object.keys(De).forEach(e=>{const t=De[e],n=t&&(t.default||t.app)||null,o=Vt(n);if(!o){console.warn(`WinnieOS.Apps: invalid app module at ${e}`);return}if(G.has(o.id)){console.warn(`WinnieOS.Apps: duplicate app id "${o.id}" (skipping ${e})`);return}G.set(o.id,o)});let C=null;async function ze(){if(C!==null)return C;try{const e=await R.load();if(e&&e.apps&&Array.isArray(e.apps.enabled)){const t=e.apps.enabled.map(n=>String(n).trim()).filter(Boolean);C=new Set(t)}else C=new Set(G.keys())}catch(e){console.warn("WinnieOS.Apps: failed to load config, enabling all apps",e),C=new Set(G.keys())}return C}function Me(){return Array.from(G.values()).sort((e,t)=>e.sortOrder!==t.sortOrder?e.sortOrder-t.sortOrder:e.title.localeCompare(t.title))}function qt(e){return e?Me().filter(t=>e.has(t.id)):Me()}const Ze={list:function(){return C!==null?qt(C):(ze().catch(()=>{}),Me())},get:function(e){const t=G.get(String(e||""))||null;return!t||C!==null&&!C.has(t.id)?null:t},refreshConfig:async function(){C=null,R.clearCache&&typeof R.clearCache=="function"&&R.clearCache(),await ze()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Apps=Ze);let we=!1,pe={screen:"startup"};const ce=new Set;function Gt(e,t){return!e||!t||e.screen!==t.screen?!1:e.screen==="app"?e.appId===t.appId:!0}function Qe(){ce.forEach(e=>{try{e(x.getState())}catch{}})}function re(e){const t=e&&typeof e=="object"?e:{screen:"desktop"},n=t.screen==="app"?{screen:"app",appId:String(t.appId||"")}:{screen:t.screen==="startup"?"startup":"desktop"};Gt(pe,n)||(pe=n,Qe())}const x={init:function(e){we||(we=!0,e&&e.initialState&&re(e.initialState),Qe())},getState:function(){return{...pe}},subscribe:function(e){return typeof e!="function"?function(){}:(ce.add(e),function(){ce.delete(e)})},start:function(){re({screen:"startup"})},goHome:function(){re({screen:"desktop"})},openApp:function(e){re({screen:"app",appId:e})},_resetForTests:function(){we=!1,pe={screen:"startup"},ce.clear()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Navigation=x);const Yt="/assets/images/winnieOS_logo_temp.png",Xt=(function(){let e=null,t=!1;const n=new Map;function o(){n.forEach((l,c)=>{try{clearTimeout(c)}catch{}try{l()}catch{}}),n.clear()}function i(l){return new Promise(c=>{const a=setTimeout(()=>{n.delete(a),c()},l);n.set(a,c)})}async function s(l){const c=e?e.querySelector("[data-wos-startup-status]"):null,a=g=>{c&&(c.textContent=g)},_=[{label:"Waking up WinnieOS",run:()=>i(450)},{label:"Checking apps",run:()=>i(450)},{label:"Almost ready",run:()=>i(450)}];for(const g of _){if(t)return;a(g.label);try{await g.run()}catch{}}if(!t)try{l.goHome()}catch{}}return{mount:function(l){const c=l&&l.root,a=l&&l.nav;c&&(t=!1,e=document.createElement("div"),e.className="wos-startup",e.innerHTML=`
                <div class="wos-startup-logo-layer">
                    <img class="wos-startup-logo" src="${Yt}" alt="WinnieOS" />
                </div>
                <div class="wos-startup-text-layer">
                    <div class="wos-startup-status">
                        <span data-wos-startup-status>Starting up</span>
                        <span class="wos-startup-dots" aria-hidden="true">
                            <span>.</span><span>.</span><span>.</span>
                        </span>
                    </div>
                </div>
            `,c.replaceChildren(e),a&&s(a))},unmount:function(){if(t=!0,o(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),Jt=(function(){let e=null,t=null;function n(i,s){const l=document.createElement("button");if(l.className="wos-app-tile",l.type="button",l.setAttribute("aria-label",i.title),l.addEventListener("click",()=>s.openApp(i.id)),i.iconSrc){const a=document.createElement("img");a.className="wos-app-icon",a.alt="",a.src=i.iconSrc,l.appendChild(a)}else{const a=document.createElement("div");a.className="wos-app-emoji",a.textContent=i.iconEmoji||"â­",l.appendChild(a)}const c=document.createElement("div");return c.className="wos-app-title",c.textContent=i.title,l.appendChild(c),l}function o(i,s,l){if(t)try{t()}catch{}const c=l.list();e=document.createElement("div"),e.className="wos-desktop";const a=document.createElement("div");a.className="wos-desktop-inner";const _=document.createElement("div");_.className="wos-app-grid",c.forEach(b=>{_.appendChild(n(b,s))}),a.appendChild(_),e.appendChild(a),i.replaceChildren(e);const g=()=>{if(!e)return;const b=getComputedStyle(e),D=parseFloat(b.paddingTop)||0,T=parseFloat(b.paddingBottom)||0,v=Math.max(0,e.clientHeight-D-T),E=_.getBoundingClientRect().height;E>0&&E<v?e.classList.add("wos-desktop--centered"):e.classList.remove("wos-desktop--centered")},y=requestAnimationFrame(g);window.addEventListener("resize",g),t=()=>{try{cancelAnimationFrame(y)}catch{}window.removeEventListener("resize",g)}}return{mount:async function(i){const s=i&&i.root,l=i&&i.nav,c=i&&i.apps;if(!(!s||!l||!c)){if(c.refreshConfig&&typeof c.refreshConfig=="function")try{await c.refreshConfig()}catch(a){console.warn("DesktopScreen: Failed to load config, showing all apps",a)}o(s,l,c)}},unmount:function(){if(t)try{t()}catch{}if(t=null,e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),Zt=(function(){let e=null,t=null,n=null,o=null;function i(){if(typeof o=="function")try{o()}catch{}if(n&&typeof n.unmount=="function")try{n.unmount()}catch{}o=null,n=null}return{mount:function(s){const l=s&&s.root,c=s&&s.nav,a=s&&s.apps,_=s&&s.appId;if(!l||!a)return;e=document.createElement("div"),e.className="wos-app-host",t=document.createElement("div"),t.className="wos-app-root",e.appendChild(t),l.replaceChildren(e);const g=a.get(_);if(!g){t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Oops!</div>
                    <div class="wos-app-placeholder-text">That app isnâ€™t here yet.</div>
                `;return}n=g;try{const y=g.mount({root:t,nav:c});o=typeof y=="function"?y:null}catch{t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Uh oh!</div>
                    <div class="wos-app-placeholder-text">This app had a little problem starting.</div>
                `,n=null,o=null}},unmount:function(){if(i(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null,t=null}}})(),Oe={startup:Xt,desktop:Jt,app:Zt};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Screens=Oe);let ge=!1,se=null,O=null,I=null,P=null,Ee=null;function Qt(){return document.getElementById("winnieos-canvas")}function en(){const e=Qt();if(!e)return!1;const t=e.querySelector(".wos-html-fallback");if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch{}O=e.querySelector("#wos-shell"),O||(O=document.createElement("div"),O.id="wos-shell",e.appendChild(O));let n=O.querySelector("#wos-topbar");n||(n=document.createElement("div"),n.id="wos-topbar",O.appendChild(n));let o=O.querySelector("#wos-home-btn");return o||(o=document.createElement("button"),o.id="wos-home-btn",o.type="button",o.setAttribute("aria-label","Home"),o.innerHTML=`
            <svg class="wos-home-icon" aria-hidden="true" viewBox="0 0 24 24" focusable="false">
                <path fill="currentColor" d="M12 3.2 3 10.4v10.4h6.2v-6.2h5.6v6.2H21V10.4L12 3.2Zm7 15.6h-2.6v-6.2H7.6v6.2H5V11.4l7-5.6 7 5.6v7.4Z"/>
            </svg>
        `,o.addEventListener("click",()=>x.goHome()),n.appendChild(o)),I=O.querySelector("#wos-content"),I||(I=document.createElement("div"),I.id="wos-content",O.appendChild(I)),!0}function et(){if(P&&typeof P.unmount=="function")try{P.unmount()}catch{}P=null}async function He(e){if(!I||!O)return;const t=e&&e.screen?e.screen:"desktop";O.dataset.screen=t;const n=Oe[t]||Oe.desktop,o=t==="app"?`app:${String(e&&e.appId||"")}`:t;if(!(P===n&&Ee===o)&&(et(),P=n,Ee=o,P&&typeof P.mount=="function"))try{const i=P.mount({root:I,nav:x,apps:Ze,appId:e&&e.appId});i&&typeof i.then=="function"&&await i}catch(i){console.error("Shell: Error mounting screen",i)}}const ue={init:function(){ge||en()&&(ge=!0,x.init({initialState:{screen:"startup"}}),se=x.subscribe(He),He(x.getState()))},_resetForTests:function(){if(se)try{se()}catch{}se=null,et(),ge=!1,O=null,I=null,Ee=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Shell=ue);function $e(){!ue||typeof ue.init!="function"||ue.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",$e):$e();
