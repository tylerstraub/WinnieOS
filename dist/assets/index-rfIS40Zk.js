(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const te="winnieos.";function V(){try{if(typeof window>"u"||!window.localStorage)return!1;const e="__storage_test__";return window.localStorage.setItem(e,"test"),window.localStorage.removeItem(e),!0}catch{return!1}}function re(e){if(!e||typeof e!="string")throw new Error("Storage key must be a non-empty string");return e.startsWith(te)?e:te+e}const R={get:function(e,t=null){if(!V())return t;try{const n=re(e),o=window.localStorage.getItem(n);if(o===null)return t;try{return JSON.parse(o)}catch{return o}}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return t}},set:function(e,t){if(!V())return!1;try{const n=re(e),o=JSON.stringify(t);return window.localStorage.setItem(n,o),!0}catch(n){if(n.message&&n.message.includes("Storage key must be"))throw n;return!1}},remove:function(e){if(!V())return!1;try{const t=re(e);return window.localStorage.removeItem(t),!0}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},has:function(e){if(!V())return!1;try{const t=re(e);return window.localStorage.getItem(t)!==null}catch(t){if(t.message&&t.message.includes("Storage key must be"))throw t;return!1}},clear:function(){if(!V())return!1;try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(te)&&e.push(n)}return e.forEach(t=>window.localStorage.removeItem(t)),!0}catch{return!1}},keys:function(){if(!V())return[];try{const e=[];for(let t=0;t<window.localStorage.length;t++){const n=window.localStorage.key(t);n&&n.startsWith(te)&&e.push(n.substring(te.length))}return e}catch{return[]}}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Storage=R);const je="display.reference",Ve={width:1280,height:800};let T=null;function Pe(e){if(e==null)return null;const t=String(e).trim();if(!t)return null;const n=t.match(/^([0-9.]+)px$/i);if(!n)return null;const o=Number(n[1]);return Number.isFinite(o)?o:null}function me(e,t,n){const o=Math.round(Number(e));return Number.isFinite(o)?Math.min(n,Math.max(t,o)):null}function Ge(e){return!!e&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>=320&&e.height>=240&&e.width<=7680&&e.height<=4320}function Ye(){const e=document.documentElement,t=window.getComputedStyle(e),n=Pe(t.getPropertyValue("--ref-width")),o=Pe(t.getPropertyValue("--ref-height"));return Number.isFinite(n)&&Number.isFinite(o)&&n>0&&o>0?{width:Math.round(n),height:Math.round(o)}:null}function pt(){const e=R.get(je);if(!e||typeof e!="object")return null;const t=me(e.width,320,7680),n=me(e.height,240,4320),o={width:t,height:n};return Ge(o)?o:null}function ft(e){R.set(je,e)}function mt(){R.remove(je)}function _e(e){const t=document.documentElement;t.style.setProperty("--ref-width",e.width+"px"),t.style.setProperty("--ref-height",e.height+"px"),t.style.setProperty("--ref-aspect-ratio",String(e.width/e.height)),t.dataset.refWidth=String(e.width),t.dataset.refHeight=String(e.height)}function ge(e){try{const t=new CustomEvent("winnieos:displaychange",{detail:{reference:{width:e.width,height:e.height}}});document.dispatchEvent(t)}catch{}}function ve(){T||(T=pt()||Ye()||Ve,_e(T))}const D={init:function(){ve(),ge(T)},getReferenceSize:function(){return ve(),{width:T.width,height:T.height}},setReferenceSize:function(e){ve();const t=me(e&&e.width,320,7680),n=me(e&&e.height,240,4320),o={width:t,height:n};return Ge(o)?(T=o,_e(T),(!e||e.persist!==!1)&&ft(T),ge(T),!0):!1},resetReferenceSize:function(){T=Ye()||Ve,mt(),_e(T),ge(T)}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Display=D);let ue=null,Y=null,se=!1,K=null;function de(){return ue||(ue=document.getElementById("winnieos-canvas")),ue}function Ee(){if(D&&typeof D.getReferenceSize=="function"){const o=D.getReferenceSize();if(o&&Number.isFinite(o.width)&&Number.isFinite(o.height)&&o.width>0&&o.height>0)return{width:o.width,height:o.height}}const e=window.getComputedStyle(document.documentElement),t=parseFloat(e.getPropertyValue("--ref-width")),n=parseFloat(e.getPropertyValue("--ref-height"));return Number.isFinite(t)&&Number.isFinite(n)&&t>0&&n>0?{width:Math.round(t),height:Math.round(n)}:{width:1280,height:800}}function Xe(){const e=window.visualViewport;return e&&typeof e.width=="number"&&typeof e.height=="number"?{width:e.width,height:e.height,offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}:{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0}}function ht(){const e=de();if(!e)return;const t=Ee(),n=t.width,o=t.height,r=Xe(),i=r.width,l=r.height,c=Math.min(i/n,l/o),s=n*c,y=o*c,h=Math.round(r.offsetLeft+(i-s)/2),d=Math.round(r.offsetTop+(l-y)/2);e.style.position="fixed",e.style.width=n+"px",e.style.height=o+"px",e.style.left=h+"px",e.style.top=d+"px",e.style.margin="0",e.style.padding="0",e.style.transformOrigin="top left";const b=String(Je(c));e.style.transform=`scale(${b})`,e.dataset.scale=b,e.dataset.vw=String(Math.round(i)),e.dataset.vh=String(Math.round(l)),e.dataset.left=String(h),e.dataset.top=String(d),document.documentElement.style.setProperty("--viewport-scale",b)}function x(){Y||(Y=window.requestAnimationFrame(function(){Y=null,ht()}))}function Je(e){return Math.round(e*1e5)/1e5}const Me={init:function(){se||de()&&(se=!0,x(),window.addEventListener("resize",x),document.addEventListener("winnieos:displaychange",x),window.visualViewport&&(K=window.visualViewport,K.addEventListener("resize",x),K.addEventListener("scroll",x)))},getScale:function(){const e=de();return e?parseFloat(e.dataset.scale||"1"):1},getReferenceSize:function(){return Ee()},getMetrics:function(){const e=Ee(),t=Xe(),n=de(),o=n?parseFloat(n.dataset.scale||"1"):Je(Math.min(t.width/e.width,t.height/e.height));return{reference:{width:e.width,height:e.height},viewport:{width:t.width,height:t.height,offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0},scale:o}},refresh:function(){x()},_resetForTests:function(){if(se&&(window.removeEventListener("resize",x),document.removeEventListener("winnieos:displaychange",x),K&&(K.removeEventListener("resize",x),K.removeEventListener("scroll",x))),Y&&typeof window.cancelAnimationFrame=="function")try{window.cancelAnimationFrame(Y)}catch{}se=!1,Y=null,ue=null,K=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Viewport=Me);let ae=!1,Q=null;function Fe(e){return e.preventDefault(),!1}function Ie(e){if(e.key==="F5"||e.ctrlKey&&(e.key==="r"||e.key==="R")||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")||e.key==="Backspace"&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&!e.target.isContentEditable||e.ctrlKey&&(e.key==="w"||e.key==="W"))return e.preventDefault(),!1}function De(e){if(e.button===1)return e.preventDefault(),!1}function wt(e){return e.preventDefault(),!1}const Oe={init:function(){ae||(ae=!0,document.addEventListener("contextmenu",Fe),document.addEventListener("keydown",Ie),document.addEventListener("mousedown",De),Q=wt,document.addEventListener("dragstart",Q))},_resetForTests:function(){ae&&(document.removeEventListener("contextmenu",Fe),document.removeEventListener("keydown",Ie),document.removeEventListener("mousedown",De),Q&&document.removeEventListener("dragstart",Q)),ae=!1,Q=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Kiosk=Oe);let ee=null,G=null;function gt(e){return new Promise(t=>setTimeout(t,e))}async function vt(e,t){const n=typeof AbortController<"u"?new AbortController:null,o=n?setTimeout(()=>n.abort(),t):null;try{const r=await fetch(e,{cache:"no-store",signal:n?n.signal:void 0});return r.ok?await r.json():null}catch{return null}finally{o&&clearTimeout(o)}}const $={load:async function(){return ee||G||(G=(async()=>{const e=[{timeoutMs:1500,sleepMs:250},{timeoutMs:1500,sleepMs:250},{timeoutMs:2e3,sleepMs:500},{timeoutMs:2500,sleepMs:750}];let t=null;for(let n=0;n<e.length;n++){const o=e[n];if(t=await vt("/winnieos-config.json",o.timeoutMs),t&&typeof t=="object")break;o.sleepMs&&await gt(o.sleepMs)}return ee=t&&typeof t=="object"?t:null,G=null,ee})(),G)},clearCache:function(){ee=null,G=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Config=$);const Ze="preferences.backgroundColor",yt="#667eea",bt="#764ba2";function Qe(e,t,n){const o=r=>{const i=Math.round(Math.max(0,Math.min(255,r))).toString(16);return i.length===1?"0"+i:i};return`#${o(e)}${o(t)}${o(n)}`}function et(e){if(!e||typeof e!="string")return{r:0,g:0,b:0};let t=e.replace("#","").trim();if(t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6||!/^[0-9a-fA-F]{6}$/.test(t))return{r:0,g:0,b:0};const n=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),r=parseInt(t.substring(4,6),16);return!Number.isFinite(n)||!Number.isFinite(o)||!Number.isFinite(r)?{r:0,g:0,b:0}:{r:n,g:o,b:r}}function tt(e){const t=et(e),n=t.r/255,o=t.g/255,r=t.b/255,i=Math.max(n,o,r),l=Math.min(n,o,r),c=i-l;let s=0;c!==0&&(i===n?s=(o-r)/c%6:i===o?s=(r-n)/c+2:s=(n-o)/c+4),s=Math.round(s*60),s<0&&(s+=360),s=(s+30)%360;const y=(i+l)/2,h=c===0?0:c/(1-Math.abs(2*y-1)),d=(1-Math.abs(2*y-1))*h,b=d*(1-Math.abs(s/60%2-1)),A=y-d/2;let C=0,w=0,O=0;return s<60?(C=d,w=b,O=0):s<120?(C=b,w=d,O=0):s<180?(C=0,w=d,O=b):s<240?(C=0,w=b,O=d):s<300?(C=b,w=0,O=d):(C=d,w=0,O=b),Qe(Math.round((C+A)*255),Math.round((w+A)*255),Math.round((O+A)*255))}function Ce(e,t=null){if(!e||typeof e!="string")return;const n=t||tt(e),o=document.body,r=document.getElementById("winnieos-canvas");o&&o.style.setProperty("background",e),r&&r.style.setProperty("background",`linear-gradient(135deg, ${e} 0%, ${n} 100%)`)}function nt(){return R.get(Ze,null)}function St(e){return!e||typeof e!="string"?!1:R.set(Ze,e)}function _t(){const e=nt();e?Ce(e):Ce(yt,bt)}const F={apply:Ce,getSaved:nt,save:St,load:_t,rgbToHex:Qe,hexToRgb:et,generateSecondary:tt};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=window.WinnieOS.Utils||{},window.WinnieOS.Utils.Background=F);const Et="display.reference";function Mt(){return R.has(Et)}function Ot(e){const t=e&&e.display&&e.display.reference;if(!t||!Number.isFinite(t.width)||!Number.isFinite(t.height)||t.width<=0||t.height<=0||Mt())return;if(D&&typeof D.setReferenceSize=="function"){D.setReferenceSize({width:t.width,height:t.height,persist:!1});return}const n=document.documentElement;n.style.setProperty("--ref-width",`${Math.round(t.width)}px`),n.style.setProperty("--ref-height",`${Math.round(t.height)}px`),n.style.setProperty("--ref-aspect-ratio",String(t.width/t.height))}function Re(){const e=$&&typeof $.load=="function"?$.load():Promise.resolve(null);D?D.init():console.warn("WinnieOS: Display module failed to load; falling back to CSS reference tokens"),Me?Me.init():console.error("WinnieOS: Viewport module failed to load"),Oe?Oe.init():console.error("WinnieOS: Kiosk module failed to load"),F&&typeof F.load=="function"&&F.load(),e.then(Ot).catch(()=>{})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Re):Re();const Ct={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Utils=Ct);const Tt={};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Components=Tt);const Nt={id:"animals",title:"Animals",iconEmoji:"ðŸ¦",sortOrder:25,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Animals</div>
            <div class="wos-app-placeholder-text">Animal sounds and matching will live here.</div>
        `)},unmount:function(){}},Lt=Object.freeze(Object.defineProperty({__proto__:null,default:Nt},Symbol.toStringTag,{value:"Module"})),At={id:"blocks",title:"Blocks",iconEmoji:"ðŸ§±",sortOrder:15,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Blocks</div>
            <div class="wos-app-placeholder-text">A building blocks game will live here.</div>
        `)},unmount:function(){}},jt=Object.freeze(Object.defineProperty({__proto__:null,default:At},Symbol.toStringTag,{value:"Module"})),kt={id:"bubbles",title:"Bubbles",iconEmoji:"ðŸ«§",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Bubbles</div>
            <div class="wos-app-placeholder-text">Pop pop pop!</div>
        `)},unmount:function(){}},Wt=Object.freeze(Object.defineProperty({__proto__:null,default:kt},Symbol.toStringTag,{value:"Module"})),xt={id:"colors",title:"Colors",iconEmoji:"ðŸŒˆ",sortOrder:30,mount:function({root:e}){if(!e)return;e.className="wos-colors-app",e.innerHTML="";const t=document.createElement("div");t.className="wos-colors-container";const n=document.createElement("div");n.className="wos-colors-picker",n.setAttribute("role","application"),n.setAttribute("aria-label","Color picker");const o=document.createElement("canvas");o.className="wos-colors-canvas";const r=.35,i=.95;let l=0;const c=a=>Math.max(0,Math.min(1,a)),s=(a,f,m)=>{a=a%360,a<0&&(a+=360);const u=m*f,g=u*(1-Math.abs(a/60%2-1)),v=m-u;let p=0,S=0,E=0;return a<60?(p=u,S=g,E=0):a<120?(p=g,S=u,E=0):a<180?(p=0,S=u,E=g):a<240?(p=0,S=g,E=u):a<300?(p=g,S=0,E=u):(p=u,S=0,E=g),{r:Math.round((p+v)*255),g:Math.round((S+v)*255),b:Math.round((E+v)*255)}},y=(a,f,m)=>{a=a/255,f=f/255,m=m/255;const u=Math.max(a,f,m),g=Math.min(a,f,m),v=u-g;let p=0;v!==0&&(u===a?p=(f-m)/v%6:u===f?p=(m-a)/v+2:p=(a-f)/v+4),p=Math.round(p*60),p<0&&(p+=360);const S=u===0?0:v/u;return{h:p,s:S,v:u}},h=()=>{const a=n.getBoundingClientRect(),f=Math.max(1,a.width),m=Math.max(1,a.height),u=f/2,g=m/2,v=Math.min(u,g);return{rect:a,width:f,height:m,cx:u,cy:g,radius:v}},d=a=>r+(1-r)*c(a),b=a=>c((a-r)/(1-r)),A=(a,f)=>{const{rect:m,width:u,height:g,cx:v,cy:p,radius:S}=h(),E=a-m.left,z=f-m.top,j=E-v,k=z-p,W=Math.sqrt(j*j+k*k),B=Math.min(S,W),U=Math.atan2(k,j),J=W<1?l:(U*180/Math.PI+360)%360,ie=S<=0?0:B/S;return{width:u,height:g,cx:v,cy:p,radius:S,dx:j,dy:k,distance:W,distClamped:B,angle:U,hue:J,t:ie}},C=({hue:a,t:f})=>{const m=d(f),u=s(a,m,i);return F.rgbToHex(u.r,u.g,u.b)},w=document.createElement("div");w.className="wos-colors-indicator",w.setAttribute("aria-hidden","true");const O=({cx:a,cy:f,radius:m,angle:u,distClamped:g,width:v,height:p})=>{const S=a+Math.cos(u)*g,E=f+Math.sin(u)*g;w.style.left=`${S/v*100}%`,w.style.top=`${E/p*100}%`},X=()=>{const a=F.getSaved(),{width:f,height:m,cx:u,cy:g,radius:v}=h();if(!a||v<=0){w.style.left="50%",w.style.top="50%";return}const p=F.hexToRgb(a),S=y(p.r,p.g,p.b);l=S.h;const E=b(S.s),z=S.h*Math.PI/180,j=E*v,k=u+Math.cos(z)*j,W=g+Math.sin(z)*j;w.style.left=`${k/f*100}%`,w.style.top=`${W/m*100}%`},M=()=>{const a=n.getBoundingClientRect(),f=window.devicePixelRatio||1,m=Math.max(1,Math.floor(a.width)),u=Math.max(1,Math.floor(a.height)),g=Math.max(1,Math.floor(m*f)),v=Math.max(1,Math.floor(u*f));o.width=g,o.height=v;const p=o.getContext("2d");if(!p)return;const S=p.createImageData(g,v),E=S.data,z=g/2,j=v/2,k=Math.min(z,j);for(let W=0;W<v;W++)for(let B=0;B<g;B++){const U=B-z,J=W-j,ie=Math.sqrt(U*U+J*J),Z=(W*g+B)*4;if(ie>k){E[Z+3]=0;continue}const ct=(Math.atan2(J,U)*180/Math.PI+360)%360,ut=k<=0?0:ie/k,dt=d(ut),we=s(ct,dt,i);E[Z]=we.r,E[Z+1]=we.g,E[Z+2]=we.b,E[Z+3]=255}p.putImageData(S,0,0)};n.appendChild(o),n.appendChild(w),t.appendChild(n),e.appendChild(t),requestAnimationFrame(()=>{M(),X()});const _=new ResizeObserver(()=>{M(),X()});_.observe(n);let P=null;const ke=(a,f)=>{const m=A(a,f);l=m.hue,O(m);const u=C(m);w.classList.add("wos-colors-indicator-active"),setTimeout(()=>{w.classList.remove("wos-colors-indicator-active")},180),F.apply(u),F.save(u)},We=a=>{if(P===null){P=a.pointerId;try{n.setPointerCapture(P)}catch{}a.preventDefault(),ke(a.clientX,a.clientY)}},xe=a=>{P===null||a.pointerId!==P||(a.preventDefault(),ke(a.clientX,a.clientY))},oe=a=>{if(!(P===null||a.pointerId!==P)){a.preventDefault();try{n.releasePointerCapture(P)}catch{}P=null}};return n.addEventListener("pointerdown",We),n.addEventListener("pointermove",xe),n.addEventListener("pointerup",oe),n.addEventListener("pointercancel",oe),function(){try{_.disconnect()}catch{}n.removeEventListener("pointerdown",We),n.removeEventListener("pointermove",xe),n.removeEventListener("pointerup",oe),n.removeEventListener("pointercancel",oe)}},unmount:function(){}},Pt=Object.freeze(Object.defineProperty({__proto__:null,default:xt},Symbol.toStringTag,{value:"Module"})),Ft={id:"dance",title:"Dance",iconEmoji:"ðŸ’ƒ",sortOrder:55,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Dance</div>
            <div class="wos-app-placeholder-text">A dance party will live here.</div>
        `)},unmount:function(){}},It=Object.freeze(Object.defineProperty({__proto__:null,default:Ft},Symbol.toStringTag,{value:"Module"})),Dt={id:"garden",title:"Garden",iconEmoji:"ðŸŒ»",sortOrder:60,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Garden</div>
            <div class="wos-app-placeholder-text">Plant and grow little flowers.</div>
        `)},unmount:function(){}},Rt=Object.freeze(Object.defineProperty({__proto__:null,default:Dt},Symbol.toStringTag,{value:"Module"})),Ht={id:"memory",title:"Memory",iconEmoji:"ðŸ§ ",sortOrder:45,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Memory</div>
            <div class="wos-app-placeholder-text">A simple matching game will live here.</div>
        `)},unmount:function(){}},$t=Object.freeze(Object.defineProperty({__proto__:null,default:Ht},Symbol.toStringTag,{value:"Module"})),zt={id:"music",title:"Music",iconEmoji:"ðŸŽµ",sortOrder:30,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Music</div>
            <div class="wos-app-placeholder-text">This will become a simple music player with big buttons.</div>
        `)},unmount:function(){}},Bt=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"})),ot="apps.notepad.v1",Te=[{id:"black",hex:"#111111"},{id:"red",hex:"#E11D48"},{id:"orange",hex:"#F97316"},{id:"yellow",hex:"#F59E0B"},{id:"green",hex:"#16A34A"},{id:"blue",hex:"#2563EB"},{id:"purple",hex:"#7C3AED"},{id:"pink",hex:"#EC4899"}],Kt=["ðŸ˜€","ðŸ˜","ðŸ˜„","ðŸ˜†","ðŸ˜Š","ðŸ˜","ðŸ¥³","ðŸ˜œ","ðŸµ","ðŸ™ˆ","ðŸ™‰","ðŸ™Š","ðŸ¶","ðŸ±","ðŸ­","ðŸ°","ðŸ¦","ðŸ·","ðŸ½","ðŸ®","ðŸ¸","ðŸ»","ðŸ¼","ðŸ¨","ðŸ¦Š","ðŸ¯","ðŸ™","ðŸ¦„","ðŸž","ðŸ¦‹","ðŸ","ðŸ¢","ðŸ“","ðŸŒ","ðŸŽ","ðŸ‡","ðŸ‰","ðŸ’","ðŸª","ðŸ¦","â­","ðŸŒˆ","â˜€ï¸","ðŸŒ™","â¤ï¸","ðŸ’›","ðŸ’š","ðŸ’™","ðŸ’œ","âœ¨","ðŸŽˆ","ðŸŽ‰","ðŸŽµ"];function qt(e,t){let n=null;return function(...o){n&&clearTimeout(n),n=setTimeout(()=>e(...o),t)}}function it(e){const t=String(e||"").trim();return t?/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(t)?t.toLowerCase():/^rgba?\(\s*\d+\s*,\s*\d+\s*,\s*\d+(?:\s*,\s*(0|1|0?\.\d+))?\s*\)$/i.test(t)?t:null:null}function He(e){const t=document.createElement("template");t.innerHTML=String(e||"");const n=o=>{const r=Array.from(o.childNodes||[]);for(const i of r)if(i.nodeType===Node.ELEMENT_NODE){const l=i.tagName.toLowerCase();if(l!=="br")if(l==="div"||l==="span"){const c=Array.from(i.attributes||[]);for(const s of c)i.removeAttribute(s.name);if(l==="span"){const s=i.style&&i.style.color?i.style.color:"",y=it(s);y&&i.setAttribute("style",`color:${y}`)}n(i)}else{const c=i.textContent||"";i.replaceWith(document.createTextNode(c))}}else i.nodeType===Node.COMMENT_NODE&&i.remove()};try{n(t.content)}catch{}return t.innerHTML}function rt(e,t){try{if(e==="foreColor")try{document.execCommand("styleWithCSS",!1,!0)}catch{}return document.execCommand(e,!1,t)}catch{return!1}}function ye(e,t){const n=it(t)||t,o=rt("foreColor",n);return!o&&e&&e.style&&(e.style.color=n),o}function $e(e){if(rt("insertText",e))return!0;const t=window.getSelection&&window.getSelection();if(!t||t.rangeCount===0)return!1;const n=t.getRangeAt(0);n.deleteContents();const o=document.createTextNode(e);return n.insertNode(o),n.setStartAfter(o),n.setEndAfter(o),t.removeAllRanges(),t.addRange(n),!0}function Ut(){const e=R.get(ot,null);return!e||typeof e!="object"?null:{html:typeof e.html=="string"?e.html:"",color:typeof e.color=="string"?e.color:Te[0].hex}}function ze(e,t){if(!e||typeof e.querySelectorAll!="function")return;e.querySelectorAll("[data-wos-notepad-swatch]").forEach(o=>{(o.getAttribute("data-wos-notepad-swatch")||"").toLowerCase()===String(t||"").toLowerCase()?o.classList.add("wos-notepad-swatch--active"):o.classList.remove("wos-notepad-swatch--active")})}const Vt={id:"notepad",title:"Notepad",iconEmoji:"ðŸ“",sortOrder:5,mount:function({root:e}){if(!e)return;e.className="wos-notepad-app",e.innerHTML="";const t=Ut();let n=t&&t.color||Te[0].hex;const o=document.createElement("div");o.className="wos-notepad-wrap";const r=document.createElement("div");r.className="wos-notepad-paper";const i=document.createElement("div");i.className="wos-notepad-editor",i.setAttribute("contenteditable","true"),i.setAttribute("role","textbox"),i.setAttribute("aria-multiline","true"),i.setAttribute("aria-label","Notepad"),i.spellcheck=!1,i.innerHTML=t&&t.html?He(t.html):"",r.appendChild(i);const l=document.createElement("div");l.className="wos-notepad-emoji-strip",l.setAttribute("aria-label","Emojis");const c=document.createElement("div");c.className="wos-notepad-emoji-strip-inner",Kt.forEach(M=>{const _=document.createElement("button");_.type="button",_.className="wos-notepad-emoji",_.setAttribute("aria-label","Emoji"),_.textContent=M,_.addEventListener("click",()=>{i.focus({preventScroll:!0}),$e(M),A()}),c.appendChild(_)}),l.appendChild(c);const s=document.createElement("div");s.className="wos-notepad-controls";const y=document.createElement("div");y.className="wos-notepad-swatches wos-notepad-card",Te.forEach(M=>{const _=document.createElement("button");_.type="button",_.className="wos-notepad-swatch",_.setAttribute("aria-label",`Text color ${M.id}`),_.setAttribute("data-wos-notepad-swatch",M.hex),_.style.background=M.hex,_.addEventListener("click",()=>{n=M.hex,ze(s,n),i.focus({preventScroll:!0}),ye(i,n)}),y.appendChild(_)});const h=document.createElement("div");h.className="wos-notepad-trash wos-notepad-card";const d=document.createElement("button");d.type="button",d.className="wos-notepad-action",d.setAttribute("aria-label","Clear page"),d.textContent="ðŸ—‘ï¸",h.appendChild(d),s.appendChild(y),s.appendChild(h);const b=()=>{R.set(ot,{html:He(i.innerHTML),color:n})},A=qt(b,450),C=M=>{try{M.preventDefault();const _=M.clipboardData&&M.clipboardData.getData("text/plain")||"";if(!_)return;i.focus({preventScroll:!0}),$e(_),A()}catch{}},w=()=>{A()},O=()=>{},X=()=>{i.innerHTML="",b(),i.focus({preventScroll:!0}),ye(i,n)};return o.appendChild(l),o.appendChild(r),o.appendChild(s),e.appendChild(o),ze(s,n),requestAnimationFrame(()=>{i.focus({preventScroll:!0}),ye(i,n);try{c.scrollLeft=0}catch{}}),i.addEventListener("input",w),i.addEventListener("paste",C),r.addEventListener("pointerdown",O),d.addEventListener("click",X),function(){try{b()}catch{}i.removeEventListener("input",w),i.removeEventListener("paste",C),r.removeEventListener("pointerdown",O),d.removeEventListener("click",X)}},unmount:function(){}},Gt=Object.freeze(Object.defineProperty({__proto__:null,default:Vt},Symbol.toStringTag,{value:"Module"})),Yt={id:"numbers",title:"Numbers",iconEmoji:"ðŸ”¢",sortOrder:35,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Numbers</div>
            <div class="wos-app-placeholder-text">Count and tap!</div>
        `)},unmount:function(){}},Xt=Object.freeze(Object.defineProperty({__proto__:null,default:Yt},Symbol.toStringTag,{value:"Module"})),Jt={id:"paint",title:"Paint",iconEmoji:"ðŸŽ¨",sortOrder:10,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Paint</div>
            <div class="wos-app-placeholder-text">A simple drawing app will live here.</div>
        `)},unmount:function(){}},Zt=Object.freeze(Object.defineProperty({__proto__:null,default:Jt},Symbol.toStringTag,{value:"Module"})),Qt={id:"piano",title:"Piano",iconEmoji:"ðŸŽ¹",sortOrder:50,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Piano</div>
            <div class="wos-app-placeholder-text">Tap keys to make music.</div>
        `)},unmount:function(){}},en=Object.freeze(Object.defineProperty({__proto__:null,default:Qt},Symbol.toStringTag,{value:"Module"})),tn={id:"shapes",title:"Shapes",iconEmoji:"ðŸ”º",sortOrder:40,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Shapes</div>
            <div class="wos-app-placeholder-text">Match the shapes.</div>
        `)},unmount:function(){}},nn=Object.freeze(Object.defineProperty({__proto__:null,default:tn},Symbol.toStringTag,{value:"Module"})),on={id:"story",title:"Story Time",iconEmoji:"ðŸ“–",sortOrder:20,mount:function(e){const t=e&&e.root;t&&(t.className="wos-app-placeholder",t.innerHTML=`
            <div class="wos-app-placeholder-title">Story Time</div>
            <div class="wos-app-placeholder-text">Soon weâ€™ll read and play through stories here.</div>
        `)},unmount:function(){}},rn=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"}));function sn(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"&&e.id.trim()?e.id.trim():null,n=typeof e.title=="string"&&e.title.trim()?e.title.trim():null,o=typeof e.mount=="function"?e.mount:null,r=typeof e.unmount=="function"?e.unmount:null;return!t||!n||!o?null:{id:t,title:n,iconSrc:typeof e.iconSrc=="string"?e.iconSrc:null,iconEmoji:typeof e.iconEmoji=="string"?e.iconEmoji:null,sortOrder:Number.isFinite(e.sortOrder)?e.sortOrder:0,mount:o,unmount:r}}const Be=Object.assign({"./animals/app.js":Lt,"./blocks/app.js":jt,"./bubbles/app.js":Wt,"./colors/app.js":Pt,"./dance/app.js":It,"./garden/app.js":Rt,"./memory/app.js":$t,"./music/app.js":Bt,"./notepad/app.js":Gt,"./numbers/app.js":Xt,"./paint/app.js":Zt,"./piano/app.js":en,"./shapes/app.js":nn,"./story/app.js":rn}),ne=new Map;Object.keys(Be).forEach(e=>{const t=Be[e],n=t&&(t.default||t.app)||null,o=sn(n);if(!o){console.warn(`WinnieOS.Apps: invalid app module at ${e}`);return}if(ne.has(o.id)){console.warn(`WinnieOS.Apps: duplicate app id "${o.id}" (skipping ${e})`);return}ne.set(o.id,o)});let L=null;async function Ke(){if(L!==null)return L;try{const e=await $.load();if(e&&e.apps&&Array.isArray(e.apps.enabled)){const t=e.apps.enabled.map(n=>String(n).trim()).filter(Boolean);L=new Set(t)}else e===null?L=new Set(["colors"]):L=new Set(ne.keys())}catch(e){console.warn("WinnieOS.Apps: failed to load config, defaulting to colors only",e),L=new Set(["colors"])}return L}function Ne(){return Array.from(ne.values()).sort((e,t)=>e.sortOrder!==t.sortOrder?e.sortOrder-t.sortOrder:e.title.localeCompare(t.title))}function an(e){return e?Ne().filter(t=>e.has(t.id)):Ne()}const st={list:function(){return L!==null?an(L):(Ke().catch(()=>{}),Ne())},get:function(e){const t=ne.get(String(e||""))||null;return!t||L!==null&&!L.has(t.id)?null:t},refreshConfig:async function(){L=null,$.clearCache&&typeof $.clearCache=="function"&&$.clearCache(),await Ke()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Apps=st);let be=!1,he={screen:"startup"};const pe=new Set;function ln(e,t){return!e||!t||e.screen!==t.screen?!1:e.screen==="app"?e.appId===t.appId:!0}function at(){pe.forEach(e=>{try{e(q.getState())}catch{}})}function le(e){const t=e&&typeof e=="object"?e:{screen:"desktop"},n=t.screen==="app"?{screen:"app",appId:String(t.appId||"")}:{screen:t.screen==="startup"?"startup":"desktop"};ln(he,n)||(he=n,at())}const q={init:function(e){be||(be=!0,e&&e.initialState&&le(e.initialState),at())},getState:function(){return{...he}},subscribe:function(e){return typeof e!="function"?function(){}:(pe.add(e),function(){pe.delete(e)})},start:function(){le({screen:"startup"})},goHome:function(){le({screen:"desktop"})},openApp:function(e){le({screen:"app",appId:e})},_resetForTests:function(){be=!1,he={screen:"startup"},pe.clear()}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Navigation=q);const cn="/assets/images/winnieOS_logo_temp.png",un=(function(){let e=null,t=!1;const n=new Map;function o(){n.forEach((l,c)=>{try{clearTimeout(c)}catch{}try{l()}catch{}}),n.clear()}function r(l){return new Promise(c=>{const s=setTimeout(()=>{n.delete(s),c()},l);n.set(s,c)})}async function i(l){const c=e?e.querySelector("[data-wos-startup-status]"):null,s=h=>{c&&(c.textContent=h)},y=[{label:"Waking up WinnieOS",run:()=>r(450)},{label:"Checking apps",run:()=>r(450)},{label:"Almost ready",run:()=>r(450)}];for(const h of y){if(t)return;s(h.label);try{await h.run()}catch{}}if(!t)try{l.goHome()}catch{}}return{mount:function(l){const c=l&&l.root,s=l&&l.nav;c&&(t=!1,e=document.createElement("div"),e.className="wos-startup",e.innerHTML=`
                <div class="wos-startup-logo-layer">
                    <img class="wos-startup-logo" src="${cn}" alt="WinnieOS" />
                </div>
                <div class="wos-startup-text-layer">
                    <div class="wos-startup-status">
                        <span data-wos-startup-status>Starting up</span>
                        <span class="wos-startup-dots" aria-hidden="true">
                            <span>.</span><span>.</span><span>.</span>
                        </span>
                    </div>
                </div>
            `,c.replaceChildren(e),s&&i(s))},unmount:function(){if(t=!0,o(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),dn=(function(){let e=null,t=null;function n(r,i){const l=document.createElement("button");if(l.className="wos-app-tile",l.type="button",l.setAttribute("aria-label",r.title),l.addEventListener("click",()=>i.openApp(r.id)),r.iconSrc){const s=document.createElement("img");s.className="wos-app-icon",s.alt="",s.src=r.iconSrc,l.appendChild(s)}else{const s=document.createElement("div");s.className="wos-app-emoji",s.textContent=r.iconEmoji||"â­",l.appendChild(s)}const c=document.createElement("div");return c.className="wos-app-title",c.textContent=r.title,l.appendChild(c),l}function o(r,i,l){if(t)try{t()}catch{}const c=l.list();e=document.createElement("div"),e.className="wos-desktop";const s=document.createElement("div");s.className="wos-desktop-inner";const y=document.createElement("div");y.className="wos-app-grid",c.forEach(b=>{y.appendChild(n(b,i))}),s.appendChild(y),e.appendChild(s),r.replaceChildren(e);const h=()=>{if(!e)return;const b=getComputedStyle(e),A=parseFloat(b.paddingTop)||0,C=parseFloat(b.paddingBottom)||0,w=Math.max(0,e.clientHeight-A-C),O=y.getBoundingClientRect().height;O>0&&O<w?e.classList.add("wos-desktop--centered"):e.classList.remove("wos-desktop--centered")},d=requestAnimationFrame(h);window.addEventListener("resize",h),t=()=>{try{cancelAnimationFrame(d)}catch{}window.removeEventListener("resize",h)}}return{mount:async function(r){const i=r&&r.root,l=r&&r.nav,c=r&&r.apps;if(!(!i||!l||!c)){if(c.refreshConfig&&typeof c.refreshConfig=="function")try{await c.refreshConfig()}catch(s){console.warn("DesktopScreen: Failed to load config, using safe defaults",s)}o(i,l,c)}},unmount:function(){if(t)try{t()}catch{}if(t=null,e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null}}})(),pn=(function(){let e=null,t=null,n=null,o=null;function r(){if(typeof o=="function")try{o()}catch{}if(n&&typeof n.unmount=="function")try{n.unmount()}catch{}o=null,n=null}return{mount:function(i){const l=i&&i.root,c=i&&i.nav,s=i&&i.apps,y=i&&i.appId;if(!l||!s)return;e=document.createElement("div"),e.className="wos-app-host",t=document.createElement("div"),t.className="wos-app-root",e.appendChild(t),l.replaceChildren(e);const h=s.get(y);if(!h){t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Oops!</div>
                    <div class="wos-app-placeholder-text">That app isnâ€™t here yet.</div>
                `;return}n=h;try{const d=h.mount({root:t,nav:c});o=typeof d=="function"?d:null}catch{t.className="wos-app-placeholder",t.innerHTML=`
                    <div class="wos-app-placeholder-title">Uh oh!</div>
                    <div class="wos-app-placeholder-text">This app had a little problem starting.</div>
                `,n=null,o=null}},unmount:function(){if(r(),e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}e=null,t=null}}})(),Le={startup:un,desktop:dn,app:pn};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Screens=Le);let Se=!1,ce=null,N=null,H=null,I=null,Ae=null;function fn(){return document.getElementById("winnieos-canvas")}function mn(){const e=fn();if(!e)return!1;const t=e.querySelector(".wos-html-fallback");if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch{}N=e.querySelector("#wos-shell"),N||(N=document.createElement("div"),N.id="wos-shell",e.appendChild(N));let n=N.querySelector("#wos-topbar");n||(n=document.createElement("div"),n.id="wos-topbar",N.appendChild(n));let o=N.querySelector("#wos-home-btn");return o||(o=document.createElement("button"),o.id="wos-home-btn",o.type="button",o.setAttribute("aria-label","Home"),o.innerHTML=`
            <svg class="wos-home-icon" aria-hidden="true" viewBox="0 0 24 24" focusable="false">
                <path fill="currentColor" d="M12 3.2 3 10.4v10.4h6.2v-6.2h5.6v6.2H21V10.4L12 3.2Zm7 15.6h-2.6v-6.2H7.6v6.2H5V11.4l7-5.6 7 5.6v7.4Z"/>
            </svg>
        `,o.addEventListener("click",()=>q.goHome()),n.appendChild(o)),H=N.querySelector("#wos-content"),H||(H=document.createElement("div"),H.id="wos-content",N.appendChild(H)),!0}function lt(){if(I&&typeof I.unmount=="function")try{I.unmount()}catch{}I=null}async function qe(e){if(!H||!N)return;const t=e&&e.screen?e.screen:"desktop";N.dataset.screen=t;const n=Le[t]||Le.desktop,o=t==="app"?`app:${String(e&&e.appId||"")}`:t;if(!(I===n&&Ae===o)&&(lt(),I=n,Ae=o,I&&typeof I.mount=="function"))try{const r=I.mount({root:H,nav:q,apps:st,appId:e&&e.appId});r&&typeof r.then=="function"&&await r}catch(r){console.error("Shell: Error mounting screen",r)}}const fe={init:function(){Se||mn()&&(Se=!0,q.init({initialState:{screen:"startup"}}),ce=q.subscribe(qe),qe(q.getState()))},_resetForTests:function(){if(ce)try{ce()}catch{}ce=null,lt(),Se=!1,N=null,H=null,Ae=null}};typeof window<"u"&&(window.WinnieOS=window.WinnieOS||{},window.WinnieOS.Shell=fe);function Ue(){!fe||typeof fe.init!="function"||fe.init()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ue):Ue();
